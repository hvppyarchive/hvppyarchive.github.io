<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.1 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>파이썬 로그 시스템 - ARCHIVE</title>
<meta name="description" content="">


  <meta name="author" content="hvppyarchive">
  
  <meta property="article:author" content="hvppyarchive">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="ARCHIVE">
<meta property="og:title" content="파이썬 로그 시스템">
<meta property="og:url" content="https://hvppyarchive.github.io/python/python-logging/">


  <meta property="og:description" content="">







  <meta property="article:published_time" content="2025-07-21T23:06:43+09:00">





  

  


<link rel="canonical" href="https://hvppyarchive.github.io/python/python-logging/">












<!-- end _includes/seo.html -->


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->
<!-- hvppyarchive: add fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@200..900&display=swap" rel="stylesheet">

<!-- insert favicons. use https://realfavicongenerator.net/ -->
 <!-- hvppyarchive: add favicons -->
<link rel="icon" type="image/png" href="/assets/favicon/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/assets/favicon/favicon.svg" />
<link rel="shortcut icon" href="/assets/favicon/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png" />
<link rel="manifest" href="/assets/favicon/site.webmanifest" />

<!-- end custom head snippets -->

  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          ARCHIVE
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/year-archive/"
                
                
              >Posts</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="파이썬 로그 시스템">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="2025-07-21T23:06:43+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://hvppyarchive.github.io/python/python-logging/" itemprop="url">파이썬 로그 시스템
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <!-- hvppyarchive: remove date icon
        <i class="far fa-calendar-alt" aria-hidden="true"></i> 
        -->
        
        <time datetime="2025-07-21T23:06:43+09:00">2025-07-21</time>
      </span>
    

    

    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="chat--user">

파이썬 패키지를 개발 중이야. 프로젝트가 좀 커져서 로그 시스템을 좀 넣어야할 것 같아. 지금까지는 print문으로 했어. console
스크립트들도 포함되어 있어 참고로. 어떻게 하는게 일반적이고 좋은 방법인지 알려줘.

</p>

<p>좋은 질문입니다. 프로젝트가 커지면 <code class="language-plaintext highlighter-rouge">print()</code>로는 로그 관리가 점점 힘들어지고, 유지보수나 디버깅에 비효율적이 됩니다. 파이썬에서는
일반적으로 <code class="language-plaintext highlighter-rouge">logging</code> 모듈을 사용하는 것이 표준이며, 다음과 같은 기준으로 설계하는 것이 좋습니다:</p>

<hr />

<h2 id="-1-logging-모듈을-사용하는-이유">✅ 1. <code class="language-plaintext highlighter-rouge">logging</code> 모듈을 사용하는 이유</h2>

<ul>
  <li>
    <p>로그 수준(Level)을 나눌 수 있음: <code class="language-plaintext highlighter-rouge">DEBUG</code>, <code class="language-plaintext highlighter-rouge">INFO</code>, <code class="language-plaintext highlighter-rouge">WARNING</code>, <code class="language-plaintext highlighter-rouge">ERROR</code>, <code class="language-plaintext highlighter-rouge">CRITICAL</code></p>
  </li>
  <li>
    <p>콘솔 출력과 파일 저장을 동시에 할 수 있음</p>
  </li>
  <li>
    <p>서드파티 툴과 연동하기 쉬움 (예: Sentry, Logstash 등)</p>
  </li>
  <li>
    <p>스레드/프로세스 환경에서도 안정적</p>
  </li>
</ul>

<hr />

<h2 id="-2-기본적인-설정-예시">✅ 2. 기본적인 설정 예시</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">sys</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">DEBUG</span><span class="p">)</span>  <span class="c1"># 개발 중엔 DEBUG, 배포 시엔 INFO 이상
</span>
<span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">Formatter</span><span class="p">(</span>
    <span class="sh">'</span><span class="s">[%(asctime)s] %(levelname)s - %(name)s - %(message)s</span><span class="sh">'</span>
<span class="p">)</span>

<span class="n">console_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">)</span>
<span class="n">console_handler</span><span class="p">.</span><span class="nf">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>

<span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">FileHandler</span><span class="p">(</span><span class="sh">'</span><span class="s">your_package.log</span><span class="sh">'</span><span class="p">)</span>
<span class="n">file_handler</span><span class="p">.</span><span class="nf">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>

<span class="n">logger</span><span class="p">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="n">console_handler</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
</code></pre></div></div>

<blockquote>
  <p>위 코드는 모든 로그를 콘솔과 파일로 동시에 출력하며, 추후 모듈 내에서 <code class="language-plaintext highlighter-rouge">logger.debug()</code>, <code class="language-plaintext highlighter-rouge">logger.info()</code>
등으로 사용 가능하게 됩니다.</p>
</blockquote>

<hr />

<h2 id="-3-콘솔-스크립트와-연동할-때">✅ 3. 콘솔 스크립트와 연동할 때</h2>

<p>스크립트 진입점(예: <code class="language-plaintext highlighter-rouge">main()</code> 함수)에서 로그 초기화를 수행하세요:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="kn">import</span> <span class="n">your_package.logging_setup</span>  <span class="c1"># 로그 초기화
</span>    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Script started.</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p>혹은 <code class="language-plaintext highlighter-rouge">entry_points</code>에서 사용하는 CLI 툴이 있다면, CLI 진입점에서도 로그 초기화를 포함시키면 됩니다.</p>

<hr />

<h2 id="-4-모듈-간-로그-분리">✅ 4. 모듈 간 로그 분리</h2>

<p>각 모듈 파일에서 다음처럼 작성하세요:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># your_package/some_module.py
</span><span class="kn">import</span> <span class="n">logging</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
</code></pre></div></div>

<blockquote>
  <p>이러면 로그 이름이 <code class="language-plaintext highlighter-rouge">your_package.some_module</code> 식으로 명시되므로, 어떤 파일에서 찍은 로그인지 명확하게 추적
가능합니다.</p>
</blockquote>

<hr />

<h2 id="-5-설정을-모듈로-분리하면-더-좋음">✅ 5. 설정을 모듈로 분리하면 더 좋음</h2>

<p><code class="language-plaintext highlighter-rouge">your_package/logging_setup.py</code> 같은 파일에 설정 코드를 몰아두고, 패키지 초기화 시점에 호출하도록 구성하는 것이
유지보수에 유리합니다.</p>

<hr />

<h2 id="-요약">🔁 요약</h2>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">logging</code> 모듈 사용은 사실상 필수</p>
  </li>
  <li>
    <p>로그 포맷, 핸들러(Console/File), 레벨 설정을 분리</p>
  </li>
  <li>
    <p>각 모듈마다 <code class="language-plaintext highlighter-rouge">logger = getLogger(__name__)</code> 사용</p>
  </li>
  <li>
    <p>진입점에서 설정 호출</p>
  </li>
  <li>
    <p>환경에 따라 로깅 설정을 바꾸려면 <code class="language-plaintext highlighter-rouge">logging.config.dictConfig</code> 도 고려할 수 있음</p>
  </li>
</ul>

<hr />

<p>추가적으로 콘솔 스크립트가 많다면, CLI 도구로 <code class="language-plaintext highlighter-rouge">click</code>이나 <code class="language-plaintext highlighter-rouge">argparse</code>를 쓰고, 로그 레벨을 인자로 조절할 수 있게 해두는
것도 일반적인 패턴입니다.</p>

<p>원하시면 예제 CLI 스크립트도 보여드릴 수 있습니다.</p>

<p class="chat--user">

logging_setup은 어디어디 해야하지?

</p>

<p>좋은 질문입니다. <code class="language-plaintext highlighter-rouge">logging_setup</code>을 어디서, 어떻게 호출할지가 사실상 핵심인데, 아래 경우들을 나눠서 보겠습니다.</p>

<hr />

<h2 id="-1-패키지-내부-코드-import-돼서-사용되는-모듈들">✅ 1. <strong>패키지 내부 코드 (import 돼서 사용되는 모듈들)</strong></h2>

<p>이 경우는 <strong>로깅 초기화를 직접 하지 않습니다.</strong> 그냥 각 모듈에서 <code class="language-plaintext highlighter-rouge">logger =
logging.getLogger(__name__)</code>만 해놓습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># your_package/module_a.py
</span><span class="kn">import</span> <span class="n">logging</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">do_something</span><span class="p">():</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sh">"</span><span class="s">doing something</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<blockquote>
  <p>로깅 설정은 다른 데서 한 번만 하면 됩니다. 모듈에서는 설정을 "사용"만 하는 구조로 가야 합니다.</p>
</blockquote>

<hr />

<h2 id="-2-스크립트-진입점-예mainpy-cli-스크립트">✅ 2. <strong>스크립트 진입점 (예:<code class="language-plaintext highlighter-rouge">main.py</code>, CLI 스크립트)</strong></h2>

<p>여기서 <strong>한 번만</strong> <code class="language-plaintext highlighter-rouge">logging_setup.setup_logging()</code> 같은 걸 호출하면 됩니다. 예:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># your_package/__main__.py
</span><span class="kn">from</span> <span class="n">your_package.logging_setup</span> <span class="kn">import</span> <span class="n">setup_logging</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nf">setup_logging</span><span class="p">()</span>
    <span class="c1"># 그 다음부터는 로거 쓰면 됨
</span>    <span class="kn">import</span> <span class="n">logging</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Script started.</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p>이 구조를 쓰면,</p>

<ul>
  <li>
    <p>모듈 안에서는 로깅 설정 몰라도 됨</p>
  </li>
  <li>
    <p>여러 CLI 진입점이 있어도 공통 <code class="language-plaintext highlighter-rouge">setup_logging()</code>만 호출하면 일관성 유지 가능</p>
  </li>
</ul>

<hr />

<h2 id="-3-패키지-초기화-시점에-넣을-수-있나-__init__py">✅ 3. <strong>패키지 초기화 시점에 넣을 수 있나? (<code class="language-plaintext highlighter-rouge">__init__.py</code>)</strong></h2>

<p>이건 <strong>비추</strong> 입니다. 이유는 다음과 같습니다:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">import</code>할 때마다 로그 설정이 바뀌면 예측 불가</p>
  </li>
  <li>
    <p>사용자 프로젝트에서 로그 설정을 다르게 하고 싶을 수도 있음</p>
  </li>
  <li>
    <p>로깅 설정은 사이드이펙트 크기 때문에 명시적으로 제어하는 게 좋음</p>
  </li>
</ul>

<hr />

<h2 id="-4-구조-예시">✅ 4. 구조 예시</h2>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code>your_package/
├── __init__.py
├── logging_setup.py  ← 여기서 setup_logging 정의
├── cli.py            ← CLI 진입점
└── module_a.py       ← 내부 로직
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># logging_setup.py
</span><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">sys</span>

<span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">):</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">logger</span><span class="p">.</span><span class="n">handlers</span><span class="p">:</span>
        <span class="k">return</span>  <span class="c1"># 중복 설정 방지
</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">Formatter</span><span class="p">(</span><span class="sh">'</span><span class="s">[%(asctime)s] %(levelname)s - %(name)s - %(message)s</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">handler</span><span class="p">.</span><span class="nf">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># cli.py
</span><span class="kn">from</span> <span class="n">your_package.logging_setup</span> <span class="kn">import</span> <span class="n">setup_logging</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nf">setup_logging</span><span class="p">()</span>
    <span class="c1"># ...
</span></code></pre></div></div>

<hr />

<h2 id="-정리">🔁 정리</h2>

<table>
  <thead>
    <tr>
      <th>위치</th>
      <th>해야 할 일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>일반 모듈 (<code class="language-plaintext highlighter-rouge">module_x.py</code>)</td>
      <td><code class="language-plaintext highlighter-rouge">getLogger(__name__)</code>만 써라</td>
    </tr>
    <tr>
      <td>CLI 진입점, 스크립트</td>
      <td><code class="language-plaintext highlighter-rouge">setup_logging()</code> 딱 한 번 호출</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">__init__.py</code></td>
      <td>로깅 설정하지 말 것</td>
    </tr>
    <tr>
      <td>여러 스크립트가 있다면</td>
      <td>공통 <code class="language-plaintext highlighter-rouge">logging_setup.py</code>를 만들어 다 같이 사용</td>
    </tr>
  </tbody>
</table>

<hr />

<p>필요하시면 setuptools <code class="language-plaintext highlighter-rouge">entry_points</code> 구조에서도 어떻게 설정하는지 예시로 보여드릴 수 있습니다.</p>

<p class="chat--user">

사용자 옵션에 따라 로그 수준을 조절할 수 있어? entry에서

</p>

<p>예, <strong>사용자 옵션에 따라 로그 레벨 조절은 충분히 가능하고</strong> , 실제로 많은 CLI 도구들이 그렇게 합니다. 일반적으로는
<code class="language-plaintext highlighter-rouge">--verbose</code> 또는 <code class="language-plaintext highlighter-rouge">--log-level</code> 옵션을 사용합니다.</p>

<p>아래에 예시를 드리겠습니다.</p>

<hr />

<h2 id="-1-argparse로-로그-레벨-설정-받기">✅ 1. <code class="language-plaintext highlighter-rouge">argparse</code>로 로그 레벨 설정 받기</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># cli.py
</span><span class="kn">import</span> <span class="n">argparse</span>
<span class="kn">from</span> <span class="n">your_package.logging_setup</span> <span class="kn">import</span> <span class="n">setup_logging</span>
<span class="kn">import</span> <span class="n">logging</span>

<span class="k">def</span> <span class="nf">parse_args</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="nc">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="p">.</span><span class="nf">add_argument</span><span class="p">(</span>
        <span class="sh">"</span><span class="s">--log-level</span><span class="sh">"</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="sh">"</span><span class="s">INFO</span><span class="sh">"</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">DEBUG</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">INFO</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">WARNING</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">ERROR</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">CRITICAL</span><span class="sh">"</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="sh">"</span><span class="s">Set the logging level</span><span class="sh">"</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span><span class="p">.</span><span class="nf">parse_args</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">args</span> <span class="o">=</span> <span class="nf">parse_args</span><span class="p">()</span>
    <span class="nf">setup_logging</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="nf">getattr</span><span class="p">(</span><span class="n">logging</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">log_level</span><span class="p">.</span><span class="nf">upper</span><span class="p">()))</span>
    
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Started with log level %s</span><span class="sh">"</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">log_level</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="실행-예시">실행 예시</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python <span class="nt">-m</span> your_package.cli <span class="nt">--log-level</span> DEBUG
</code></pre></div></div>

<hr />

<h2 id="-2-click으로-하는-경우-더-직관적인-cli">✅ 2. <code class="language-plaintext highlighter-rouge">click</code>으로 하는 경우 (더 직관적인 CLI)</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># cli.py
</span><span class="kn">import</span> <span class="n">click</span>
<span class="kn">import</span> <span class="n">logging</span>
<span class="kn">from</span> <span class="n">your_package.logging_setup</span> <span class="kn">import</span> <span class="n">setup_logging</span>

<span class="nd">@click.command</span><span class="p">()</span>
<span class="nd">@click.option</span><span class="p">(</span>
    <span class="sh">"</span><span class="s">--log-level</span><span class="sh">"</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="n">click</span><span class="p">.</span><span class="nc">Choice</span><span class="p">([</span><span class="sh">"</span><span class="s">DEBUG</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">INFO</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">WARNING</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">ERROR</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">CRITICAL</span><span class="sh">"</span><span class="p">]),</span>
    <span class="n">default</span><span class="o">=</span><span class="sh">"</span><span class="s">INFO</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="sh">"</span><span class="s">Set logging level.</span><span class="sh">"</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">log_level</span><span class="p">):</span>
    <span class="nf">setup_logging</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="nf">getattr</span><span class="p">(</span><span class="n">logging</span><span class="p">,</span> <span class="n">log_level</span><span class="p">.</span><span class="nf">upper</span><span class="p">()))</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sh">"</span><span class="s">This is a debug message</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">This is an info message</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="-3-setup_logging-함수에서-level-인자를-받게-설계">✅ 3. <code class="language-plaintext highlighter-rouge">setup_logging</code> 함수에서 level 인자를 받게 설계</h2>

<p>이미 앞에서 정의한 함수 구조가 여기에 맞게 되어 있어야 합니다:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># logging_setup.py
</span><span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">):</span>
    <span class="n">root_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">root_logger</span><span class="p">.</span><span class="n">handlers</span><span class="p">:</span>
        <span class="k">return</span>  <span class="c1"># 중복 설정 방지
</span>
    <span class="n">root_logger</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">Formatter</span><span class="p">(</span><span class="sh">'</span><span class="s">[%(asctime)s] %(levelname)s - %(name)s - %(message)s</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">handler</span><span class="p">.</span><span class="nf">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
    <span class="n">root_logger</span><span class="p">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="-4-entry_points로-연결-시에도-적용됨">✅ 4. entry_points로 연결 시에도 적용됨</h2>

<p><code class="language-plaintext highlighter-rouge">setup.py</code> 또는 <code class="language-plaintext highlighter-rouge">pyproject.toml</code>에 다음처럼 등록되어 있다면:</p>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[project.scripts]</span>
<span class="py">mytool</span> <span class="p">=</span> <span class="s">"your_package.cli:main"</span>
</code></pre></div></div>

<p>유저는 그냥 CLI로 다음과 같이 쓸 수 있습니다:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mytool <span class="nt">--log-level</span> DEBUG
</code></pre></div></div>

<hr />

<h2 id="-결론">🔁 결론</h2>

<ul>
  <li>
    <p>가능할 뿐 아니라 <strong>표준적인 사용 방식</strong></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">argparse</code>나 <code class="language-plaintext highlighter-rouge">click</code>을 통해 CLI 옵션으로 로그 레벨 입력받기</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setup_logging(level=...)</code> 식으로 전달</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">entry_points</code>에서도 동작 잘함</p>
  </li>
</ul>

<p>필요하시면 <code class="language-plaintext highlighter-rouge">click</code> 기반 CLI 템플릿도 만들어 드릴 수 있습니다.</p>

<p class="chat--user">

pytest 같은데서 돌릴 땐 어떻게 되지?

</p>

<p>아주 중요한 포인트를 짚으셨습니다. <code class="language-plaintext highlighter-rouge">pytest</code>처럼 <strong>테스트 환경에서 로깅이 어떻게 동작하느냐</strong> 는 생각보다 까다롭고, 잘못 구성하면
로그가 안 보이거나 테스트 로직과 충돌합니다. 아래 정리해드리겠습니다.</p>

<hr />

<h2 id="-기본적으로-pytest는-로깅을-캡처함">✅ 기본적으로 <code class="language-plaintext highlighter-rouge">pytest</code>는 로깅을 캡처함</h2>

<p><code class="language-plaintext highlighter-rouge">pytest</code>는 테스트 실행 중에 <code class="language-plaintext highlighter-rouge">stdout</code>, <code class="language-plaintext highlighter-rouge">stderr</code>, <code class="language-plaintext highlighter-rouge">logging</code> 모두를 <strong>캡처</strong> 해서 테스트 실패 시에만
보여주도록 되어 있습니다. 그래서 일반적으로는 <code class="language-plaintext highlighter-rouge">logger.info()</code> 등을 써도 콘솔에 바로 안 나옵니다.</p>

<hr />

<h2 id="-해결-방법-요약">✅ 해결 방법 요약</h2>

<table>
  <thead>
    <tr>
      <th>목표</th>
      <th>방법</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>로그를 테스트 중 항상 출력</td>
      <td><code class="language-plaintext highlighter-rouge">pytest -s</code> 또는 <code class="language-plaintext highlighter-rouge">pytest --capture=no</code></td>
    </tr>
    <tr>
      <td>로그 레벨을 조절하고 싶다</td>
      <td><code class="language-plaintext highlighter-rouge">--log-cli-level=DEBUG</code> 등 사용</td>
    </tr>
    <tr>
      <td>로그 설정 충돌 피하고 싶다</td>
      <td>테스트용 로깅 설정 따로 구성하거나 <code class="language-plaintext highlighter-rouge">caplog</code> fixture 사용</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-방법-1-테스트-실행-시-로그를-콘솔에-출력">✅ 방법 1: 테스트 실행 시 로그를 콘솔에 출력</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pytest <span class="nt">-s</span>
</code></pre></div></div>

<p>또는</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pytest <span class="nt">--capture</span><span class="o">=</span>no <span class="nt">--log-cli-level</span><span class="o">=</span>DEBUG
</code></pre></div></div>

<hr />

<h2 id="-방법-2-caplog을-이용한-테스트-내-로그-확인">✅ 방법 2: <code class="language-plaintext highlighter-rouge">caplog</code>을 이용한 테스트 내 로그 확인</h2>

<p><code class="language-plaintext highlighter-rouge">caplog</code>은 pytest의 built-in fixture로, 테스트 중 발생한 로그를 수집합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># test_something.py
</span><span class="kn">import</span> <span class="n">logging</span>

<span class="k">def</span> <span class="nf">test_log_output</span><span class="p">(</span><span class="n">caplog</span><span class="p">):</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="sh">"</span><span class="s">your_package.module_x</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">caplog</span><span class="p">.</span><span class="nf">at_level</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">):</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Hello from test</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">assert</span> <span class="sh">"</span><span class="s">Hello from test</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">caplog</span><span class="p">.</span><span class="n">text</span>
</code></pre></div></div>

<hr />

<h2 id="-방법-3-테스트-실행-시-setup_logging-실행">✅ 방법 3: 테스트 실행 시 <code class="language-plaintext highlighter-rouge">setup_logging()</code> 실행?</h2>

<blockquote>
  <p>기본적으로는 하지 않는 게 낫습니다.</p>
</blockquote>

<ul>
  <li>
    <p>이유: 테스트 실행 전에 로깅 설정하면 <code class="language-plaintext highlighter-rouge">pytest</code>의 내부 로그 캡처 방식과 충돌 가능</p>
  </li>
  <li>
    <p>하지만 <strong>특정 모듈을 직접 테스트할 때 로그가 필요하다면</strong> , <code class="language-plaintext highlighter-rouge">setup_logging()</code>을 명시적으로 불러도 됩니다</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># test_setup.py
</span><span class="kn">from</span> <span class="n">your_package.logging_setup</span> <span class="kn">import</span> <span class="n">setup_logging</span>

<span class="nf">setup_logging</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">DEBUG</span><span class="p">)</span>
</code></pre></div></div>

<p>단, 이 설정은 전역 영향을 주므로 주의해야 합니다. <code class="language-plaintext highlighter-rouge">pytest.ini</code> 또는 <code class="language-plaintext highlighter-rouge">conftest.py</code>에서 공통 설정을 하거나,
<code class="language-plaintext highlighter-rouge">caplog</code>처럼 테스트 스코프 안에서 제어하는 것이 더 안정적입니다.</p>

<hr />

<h2 id="-옵션-pytestini-설정에-로그-옵션-추가">✅ 옵션: <code class="language-plaintext highlighter-rouge">pytest.ini</code> 설정에 로그 옵션 추가</h2>

<p><code class="language-plaintext highlighter-rouge">pytest.ini</code>를 프로젝트 루트에 두고 다음처럼 설정할 수 있습니다:</p>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># pytest.ini
</span><span class="nn">[pytest]</span>
<span class="py">log_cli</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">log_cli_level</span> <span class="p">=</span> <span class="s">INFO</span>
<span class="py">log_format</span> <span class="p">=</span> <span class="s">[%(asctime)s] %(levelname)s - %(message)s</span>
<span class="py">log_date_format</span> <span class="p">=</span> <span class="s">%Y-%m-%d %H:%M:%S</span>
</code></pre></div></div>

<p>이렇게 하면 별도로 <code class="language-plaintext highlighter-rouge">setup_logging()</code> 호출 없이도, pytest가 실행될 때 로그를 출력하게 됩니다.</p>

<hr />

<h2 id="-정리-1">🔁 정리</h2>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">pytest</code>는 기본적으로 로그를 캡처하므로 바로 출력되진 않음</p>
  </li>
  <li>
    <p>콘솔에 로그를 보려면 <code class="language-plaintext highlighter-rouge">-s</code>, <code class="language-plaintext highlighter-rouge">--capture=no</code>, <code class="language-plaintext highlighter-rouge">--log-cli-level</code> 등을 써야 함</p>
  </li>
  <li>
    <p>테스트 중 로그 확인은 <code class="language-plaintext highlighter-rouge">caplog</code>를 쓰는 게 가장 깔끔함</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setup_logging()</code>은 테스트용 별도로 구성하거나 최소한으로 사용하는 게 좋음</p>
  </li>
  <li>
    <p>공통 설정은 <code class="language-plaintext highlighter-rouge">pytest.ini</code>에서 컨트롤 가능</p>
  </li>
</ul>

<hr />

<p>테스트 환경용 <code class="language-plaintext highlighter-rouge">setup_test_logging()</code> 함수를 따로 만드는 것도 하나의 방법입니다. 원하시면 그런 형태도 예시로 드릴 수
있습니다.</p>

<p class="chat--user">

setup을 안하면 그냥 stdout으로 나오나?

</p>

<p>아니요, <strong><code class="language-plaintext highlighter-rouge">setup_logging()</code> 같은 설정을 명시적으로 하지 않으면</strong> 로그는 대부분의 경우 <em>“아무 데도 안 나옵니다.”</em>
(즉, stdout에도 안 나옵니다).</p>

<p>이유는 다음과 같습니다:</p>

<hr />

<h2 id="-기본-logging-동작-설정-안-했을-때">✅ 기본 <code class="language-plaintext highlighter-rouge">logging</code> 동작 (설정 안 했을 때)</h2>

<p>파이썬의 <code class="language-plaintext highlighter-rouge">logging</code> 모듈은 내부적으로 다음 조건에서만 로그를 출력합니다:</p>

<ol>
  <li>
    <p><strong>루트 로거에 핸들러가 연결되어 있어야 함</strong></p>
  </li>
  <li>
    <p><strong>로거의 로그 레벨보다 낮지 않은 메시지만 출력</strong></p>
  </li>
  <li>
    <p><strong>기본적으로는 아무 핸들러도 없음 → 출력 안 됨</strong></p>
  </li>
</ol>

<p>예를 들어, 아래 코드는 <code class="language-plaintext highlighter-rouge">print()</code>는 출력되지만 <code class="language-plaintext highlighter-rouge">logger.debug()</code>는 콘솔에 안 나옵니다:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sh">"</span><span class="s">this won</span><span class="sh">'</span><span class="s">t show</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># 출력 안 됨
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">this will show</span><span class="sh">"</span><span class="p">)</span>          <span class="c1"># 출력됨
</span></code></pre></div></div>

<hr />

<h2 id="-예외-loggingbasicconfig를-어디선가-호출한-경우">✅ 예외: <code class="language-plaintext highlighter-rouge">logging.basicConfig()</code>를 어디선가 호출한 경우</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logging</span><span class="p">.</span><span class="nf">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
</code></pre></div></div>

<p>이걸 어딘가에서 한 번이라도 호출했다면, stdout으로 출력됩니다. 하지만:</p>

<ul>
  <li>
    <p>모듈 import 순서에 따라 불안정하게 동작함</p>
  </li>
  <li>
    <p>중복 호출하면 무시됨 (<code class="language-plaintext highlighter-rouge">basicConfig()</code>는 한 번만 적용됨)</p>
  </li>
</ul>

<p>그래서 <strong><code class="language-plaintext highlighter-rouge">basicConfig()</code>는 복잡한 프로젝트에서는 피해야 하는 방식</strong>입니다. 대신, 아예 <code class="language-plaintext highlighter-rouge">StreamHandler</code>와
<code class="language-plaintext highlighter-rouge">Formatter</code>를 명시적으로 지정하는 구조로 가는 게 낫습니다 (지금까지 설명드린 방식처럼요).</p>

<hr />

<h2 id="-그럼-테스트에서-setup_logging-안-하면">✅ 그럼 테스트에서 <code class="language-plaintext highlighter-rouge">setup_logging()</code> 안 하면?</h2>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">caplog</code> 같은 pytest fixture로는 내부 로그는 잡히지만, <strong>콘솔 출력은 없음</strong></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setup_logging()</code>을 하지 않으면, 모듈 내 <code class="language-plaintext highlighter-rouge">logger.info()</code>는 그냥 사라진다고 보면 됩니다</p>
  </li>
</ul>

<hr />

<h2 id="-요약-1">🔁 요약</h2>

<table>
  <thead>
    <tr>
      <th>상태</th>
      <th>결과</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>아무 설정도 안 한 경우</td>
      <td>로그 출력 안 됨</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">basicConfig()</code>만 호출한 경우</td>
      <td>단순한 로그 출력 가능 (stdout)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">setup_logging()</code> 명시적으로 구성</td>
      <td>원하는 방식으로 핸들러/포맷 등 제어 가능</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pytest</code> 실행 중</td>
      <td>캡처됨 (콘솔에 바로 출력 안 됨)</td>
    </tr>
  </tbody>
</table>

<hr />

<p>그래서 현실적으로는:</p>

<ul>
  <li>
    <p>테스트 외부에서는 <code class="language-plaintext highlighter-rouge">setup_logging()</code>이 필요</p>
  </li>
  <li>
    <p>테스트 내부에서는 <code class="language-plaintext highlighter-rouge">caplog</code>나 <code class="language-plaintext highlighter-rouge">pytest.ini</code> 사용</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">basicConfig()</code>는 임시 스크립트 말고는 피하는 게 좋음</p>
  </li>
</ul>

<p>필요하시면 테스트용 minimal logging 구성도 예시로 드릴 수 있습니다.</p>

<p class="chat--user">

테스트할 때도 로그 메시지를 보고 싶을 것 같은데 나는

</p>

<p>네, 그 말씀이 맞습니다. <strong>테스트 중에도 로그 메시지를 보고 싶은 경우가 많고</strong> , 디버깅/문제 재현/원인 추적에 굉장히 유용합니다.
다만 pytest의 기본 설정이 로그를 캡처해서 감추기 때문에, <strong>명확하게 설정</strong> 을 해줘야 합니다.</p>

<p>아래에 현실적으로 가장 안정적인 설정 방법 3가지를 정리해 드리겠습니다:</p>

<hr />

<h2 id="-방법-1-pytestini-또는-pyprojecttoml에-로깅-출력-설정">✅ 방법 1: <code class="language-plaintext highlighter-rouge">pytest.ini</code> 또는 <code class="language-plaintext highlighter-rouge">pyproject.toml</code>에 로깅 출력 설정</h2>

<p><strong>가장 추천하는 방식</strong> 입니다. 프로젝트 전체 테스트에서 항상 로그를 출력해줍니다.</p>

<h3 id="pytestini-예시"><code class="language-plaintext highlighter-rouge">pytest.ini</code> 예시:</h3>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[pytest]</span>
<span class="py">log_cli</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">log_cli_level</span> <span class="p">=</span> <span class="s">INFO</span>
<span class="py">log_format</span> <span class="p">=</span> <span class="s">[%(asctime)s] %(levelname)s - %(name)s - %(message)s</span>
<span class="py">log_date_format</span> <span class="p">=</span> <span class="s">%Y-%m-%d %H:%M:%S</span>
</code></pre></div></div>

<h3 id="이-설정의-효과">이 설정의 효과:</h3>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">logger.info()</code> 등 로그 메시지가 <strong>테스트 실행 중 콘솔에 출력됨</strong></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setup_logging()</code>을 호출하지 않아도 됨 (pytest가 root logger를 설정함)</p>
  </li>
</ul>

<blockquote>
  <p>레벨을 DEBUG로 설정하면 너무 많을 수 있으니, INFO 정도로 시작하는 것이 좋습니다.</p>
</blockquote>

<hr />

<h2 id="-방법-2-pytest-실행-시-cli-옵션으로-지정">✅ 방법 2: <code class="language-plaintext highlighter-rouge">pytest</code> 실행 시 CLI 옵션으로 지정</h2>

<p>테스트 실행 시 직접 로그 설정을 넘길 수 있습니다:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pytest <span class="nt">--log-cli-level</span><span class="o">=</span>DEBUG
</code></pre></div></div>

<p>또는 로그 캡처도 끄고 싶다면:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pytest <span class="nt">--capture</span><span class="o">=</span>no <span class="nt">--log-cli-level</span><span class="o">=</span>DEBUG
</code></pre></div></div>

<blockquote>
  <p>이 방법은 <strong>테스트를 수동으로 실행할 때 유용</strong> 하지만, 자동화된 CI 환경에는 반영되지 않으니 <code class="language-plaintext highlighter-rouge">pytest.ini</code>가 더
낫습니다.</p>
</blockquote>

<hr />

<h2 id="-방법-3-setup_logging을-테스트-코드에서-직접-호출">✅ 방법 3: <code class="language-plaintext highlighter-rouge">setup_logging()</code>을 테스트 코드에서 직접 호출</h2>

<p>테스트 전용의 간단한 로그 설정을 만들어 직접 불러줄 수도 있습니다:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># conftest.py
</span><span class="kn">import</span> <span class="n">pytest</span>
<span class="kn">from</span> <span class="n">your_package.logging_setup</span> <span class="kn">import</span> <span class="n">setup_logging</span>

<span class="nd">@pytest.fixture</span><span class="p">(</span><span class="n">autouse</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="sh">"</span><span class="s">session</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">configure_logging</span><span class="p">():</span>
    <span class="nf">setup_logging</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="sh">"</span><span class="s">INFO</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<blockquote>
  <p>이렇게 하면 테스트를 실행할 때 한 번만 <code class="language-plaintext highlighter-rouge">setup_logging()</code>이 호출됩니다.</p>
</blockquote>

<p>⚠️ 단점:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">pytest.ini</code>와 충돌 가능</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">caplog</code>를 쓸 때 간섭할 수 있음</p>
  </li>
</ul>

<hr />

<h2 id="-번외-테스트-내에서-특정-로그만-보고-싶을-때-caplog">✅ 번외: 테스트 내에서 특정 로그만 보고 싶을 때 (<code class="language-plaintext highlighter-rouge">caplog</code>)</h2>

<p>테스트 내에서 로그 출력 여부를 검증하고 싶다면 <code class="language-plaintext highlighter-rouge">caplog</code> fixture를 쓰면 됩니다:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_logging_behavior</span><span class="p">(</span><span class="n">caplog</span><span class="p">):</span>
    <span class="kn">from</span> <span class="n">your_package</span> <span class="kn">import</span> <span class="n">something</span>
    <span class="k">with</span> <span class="n">caplog</span><span class="p">.</span><span class="nf">at_level</span><span class="p">(</span><span class="sh">"</span><span class="s">INFO</span><span class="sh">"</span><span class="p">):</span>
        <span class="n">something</span><span class="p">.</span><span class="nf">do_work</span><span class="p">()</span>
    <span class="k">assert</span> <span class="sh">"</span><span class="s">expected log message</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">caplog</span><span class="p">.</span><span class="n">text</span>
</code></pre></div></div>

<hr />

<h2 id="-결론-당신-같은-경우엔">🔁 결론: 당신 같은 경우엔?</h2>

<p><strong>프로젝트 전체에 로그 출력이 필요한 경우라면</strong> → <code class="language-plaintext highlighter-rouge">pytest.ini</code>에 설정하는 방법이 가장 깔끔하고 안전합니다.</p>

<p><strong>즉시 해결하려면 아래처럼 하세요:</strong></p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">pytest.ini</code> 생성 (없으면)</p>
  </li>
  <li>
    <p>아래 내용 추가:</p>
  </li>
</ol>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[pytest]</span>
<span class="py">log_cli</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">log_cli_level</span> <span class="p">=</span> <span class="s">INFO</span>
</code></pre></div></div>

<ol>
  <li>이제 그냥 <code class="language-plaintext highlighter-rouge">pytest</code>만 쳐도 로그 출력됩니다.</li>
</ol>

<hr />

<p>원하시면 <code class="language-plaintext highlighter-rouge">pytest.ini</code> 외에도 CI 환경에서 이 설정을 반영하는 방법도 알려드릴 수 있습니다.</p>

<p class="chat--user">

저거는 그러면 pytest가 logging 패키지 설정을 덮어쓰는거야?

</p>

<p>예, <strong>맞습니다.<code class="language-plaintext highlighter-rouge">pytest</code>는 내부적으로 <code class="language-plaintext highlighter-rouge">logging</code> 설정을 “덮어씁니다.”</strong></p>

<p>좀 더 정확히 말하면:</p>

<hr />

<h2 id="-pytest의-로깅-동작-핵심-요약">✅ <code class="language-plaintext highlighter-rouge">pytest</code>의 로깅 동작 핵심 요약</h2>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">log_cli = true</code>를 설정하거나 <code class="language-plaintext highlighter-rouge">--log-cli-level</code> 같은 옵션을 사용하면</p>
  </li>
  <li>
    <p><strong>pytest가 root logger에<code class="language-plaintext highlighter-rouge">StreamHandler(sys.stderr)</code>를 등록하고 포맷/레벨을 설정</strong>합니다</p>
  </li>
  <li>
    <p>당신이 <code class="language-plaintext highlighter-rouge">setup_logging()</code> 같은 걸 미리 호출했다면?<br />
👉 대부분의 경우 <strong>pytest 설정이 그것을 덮어씁니다</strong> (특히 handler를 추가하는 부분에서)</p>
  </li>
</ol>

<hr />

<h2 id="-실제-내부-동작-간단화된-형태">🔬 실제 내부 동작 (간단화된 형태)</h2>

<p>pytest 내부적으로는 다음과 같은 방식으로 작동합니다:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">()</span>
<span class="n">root_logger</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">log_cli_level</span><span class="p">)</span>
<span class="n">handler</span> <span class="o">=</span> <span class="nc">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">)</span>
<span class="n">handler</span><span class="p">.</span><span class="nf">setFormatter</span><span class="p">(</span><span class="n">user_configured_formatter</span><span class="p">)</span>
<span class="n">root_logger</span><span class="p">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
</code></pre></div></div>

<p>즉,</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">root_logger.setLevel(...)</code>도 바꿔버림</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">handler</code>를 추가함</p>
  </li>
  <li>
    <p>이미 존재하는 핸들러가 있을 경우 충돌 가능</p>
  </li>
</ul>

<hr />

<h2 id="-그러면-어떻게-해야-안전할까">🧠 그러면 어떻게 해야 안전할까?</h2>

<h3 id="상황-a-pytest에서만-로그-설정하고-싶다">상황 A. <strong>pytest에서만 로그 설정하고 싶다</strong></h3>

<p>→ <code class="language-plaintext highlighter-rouge">pytest.ini</code> + <code class="language-plaintext highlighter-rouge">log_cli=true</code>로 끝. <code class="language-plaintext highlighter-rouge">setup_logging()</code> 안 써도 됨.</p>

<h3 id="상황-b-setup_logging도-쓰고-싶다-예-cli-실행-시">상황 B. <strong><code class="language-plaintext highlighter-rouge">setup_logging()</code>도 쓰고 싶다 (예: CLI 실행 시)</strong></h3>

<p>→ <code class="language-plaintext highlighter-rouge">setup_logging()</code>에서 <strong>pytest 실행 시는 건너뛰는 로직</strong> 을 넣는 게 안전합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">os</span>

<span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">):</span>
    <span class="k">if</span> <span class="nf">any</span><span class="p">(</span><span class="sh">"</span><span class="s">PYTEST_CURRENT_TEST</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">):</span>
        <span class="c1"># pytest 실행 중이면 설정 안 함
</span>        <span class="k">return</span>

    <span class="n">root_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">root_logger</span><span class="p">.</span><span class="n">handlers</span><span class="p">:</span>
        <span class="k">return</span>  <span class="c1"># 이미 설정된 경우 생략
</span>
    <span class="n">root_logger</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">Formatter</span><span class="p">(</span><span class="sh">'</span><span class="s">[%(asctime)s] %(levelname)s - %(name)s - %(message)s</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">handler</span><span class="p">.</span><span class="nf">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
    <span class="n">root_logger</span><span class="p">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="-결론-1">🔁 결론</h2>

<ul>
  <li>
    <p>네, <code class="language-plaintext highlighter-rouge">pytest</code>는 기본적으로 <code class="language-plaintext highlighter-rouge">logging</code> 설정을 덮어씁니다</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">log_cli</code> 관련 옵션이 있으면 확실히 root logger 설정을 바꿉니다</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setup_logging()</code>이 있는 경우, <strong>pytest 실행 환경에서는 생략하거나 안전하게 조절해야 충돌 방지</strong> 됩니다</p>
  </li>
</ul>

<hr />

<p>필요하시면 <code class="language-plaintext highlighter-rouge">setup_logging()</code>과 <code class="language-plaintext highlighter-rouge">pytest.ini</code>가 잘 공존하는 구조를 템플릿으로 만들어 드릴 수도 있습니다.</p>

<p class="chat--user">

종합 요구 사항: 1. 로그는 파일 + 표준 출력 모두한다. 표준 출력 시에는 수준별로 색깔을 다르게 한다. 파일에는 색깔 포매팅을 넣지
않는다. 2. pytest 시에도 로그 표준 출력을 한다. 단 (-s) 옵션 줬을 때만

</p>

<p>좋습니다. 말씀하신 요구사항은 실무에서도 꽤 자주 등장하는 고급 로깅 설정입니다. 말씀하신 두 가지 요구사항을 충족시키는 전체 구조를 아래와
같이 설계할 수 있습니다:</p>

<hr />

<h2 id="-요구사항-정리">✅ 요구사항 정리</h2>

<ol>
  <li>
    <p><strong>로그는 파일 + 콘솔 모두 출력</strong></p>
  </li>
  <li>
    <p><strong>콘솔 출력에는 색상 적용 (레벨별로 다르게)</strong></p>
  </li>
  <li>
    <p><strong>파일에는 색상 없이 저장</strong></p>
  </li>
  <li>
    <p><strong>pytest 실행 시에는<code class="language-plaintext highlighter-rouge">-s</code> 옵션을 줬을 때만 콘솔 로그 출력 (기본은 출력 안 함)</strong></p>
  </li>
</ol>

<hr />

<h2 id="-setup_loggingpy-로깅-설정-모듈">✅ <code class="language-plaintext highlighter-rouge">setup_logging.py</code>: 로깅 설정 모듈</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># your_package/logging_setup.py
</span>
<span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">os</span>

<span class="k">class</span> <span class="nc">ColorFormatter</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">Formatter</span><span class="p">):</span>
    <span class="n">COLORS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">DEBUG</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="se">\033</span><span class="s">[94m</span><span class="sh">'</span><span class="p">,</span>     <span class="c1"># 파랑
</span>        <span class="sh">'</span><span class="s">INFO</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="se">\033</span><span class="s">[92m</span><span class="sh">'</span><span class="p">,</span>      <span class="c1"># 초록
</span>        <span class="sh">'</span><span class="s">WARNING</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="se">\033</span><span class="s">[93m</span><span class="sh">'</span><span class="p">,</span>   <span class="c1"># 노랑
</span>        <span class="sh">'</span><span class="s">ERROR</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="se">\033</span><span class="s">[91m</span><span class="sh">'</span><span class="p">,</span>     <span class="c1"># 빨강
</span>        <span class="sh">'</span><span class="s">CRITICAL</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="se">\033</span><span class="s">[95m</span><span class="sh">'</span><span class="p">,</span>  <span class="c1"># 마젠타
</span>    <span class="p">}</span>
    <span class="n">RESET</span> <span class="o">=</span> <span class="sh">'</span><span class="se">\033</span><span class="s">[0m</span><span class="sh">'</span>

    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="n">levelname</span> <span class="o">=</span> <span class="n">record</span><span class="p">.</span><span class="n">levelname</span>
        <span class="k">if</span> <span class="n">levelname</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">COLORS</span><span class="p">:</span>
            <span class="n">record</span><span class="p">.</span><span class="n">levelname</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">COLORS</span><span class="p">[</span><span class="n">levelname</span><span class="p">]</span><span class="si">}{</span><span class="n">levelname</span><span class="si">}{</span><span class="n">self</span><span class="p">.</span><span class="n">RESET</span><span class="si">}</span><span class="sh">"</span>
        <span class="k">return</span> <span class="nf">super</span><span class="p">().</span><span class="nf">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">log_file</span><span class="o">=</span><span class="sh">"</span><span class="s">your_package.log</span><span class="sh">"</span><span class="p">):</span>
    <span class="n">root_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">root_logger</span><span class="p">.</span><span class="n">handlers</span><span class="p">:</span>
        <span class="k">return</span>  <span class="c1"># 중복 방지
</span>
    <span class="n">root_logger</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>

    <span class="c1"># 공통 포맷
</span>    <span class="n">fmt</span> <span class="o">=</span> <span class="sh">'</span><span class="s">[%(asctime)s] %(levelname)s - %(name)s - %(message)s</span><span class="sh">'</span>
    <span class="n">datefmt</span> <span class="o">=</span> <span class="sh">'</span><span class="s">%Y-%m-%d %H:%M:%S</span><span class="sh">'</span>

    <span class="c1"># 파일 핸들러 (색 없음)
</span>    <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">FileHandler</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
    <span class="n">file_handler</span><span class="p">.</span><span class="nf">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="nc">Formatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">datefmt</span><span class="p">))</span>
    <span class="n">root_logger</span><span class="p">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>

    <span class="c1"># pytest 실행 중이면 표준 출력 핸들러 추가 조건 확인
</span>    <span class="n">is_pytest</span> <span class="o">=</span> <span class="sh">"</span><span class="s">PYTEST_CURRENT_TEST</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_pytest</span> <span class="ow">or</span> <span class="p">(</span><span class="n">is_pytest</span> <span class="ow">and</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">isatty</span><span class="p">()):</span>
        <span class="n">stream_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">)</span>
        <span class="n">stream_handler</span><span class="p">.</span><span class="nf">setFormatter</span><span class="p">(</span><span class="nc">ColorFormatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">datefmt</span><span class="p">))</span>
        <span class="n">root_logger</span><span class="p">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="n">stream_handler</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="-설명">✅ 설명</h2>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">ColorFormatter</code>: 콘솔 출력용. ANSI 색코드로 수준별 색상 처리</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">FileHandler</code>: 로그 파일 저장, 색상 없음</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">sys.stdout.isatty()</code>: <code class="language-plaintext highlighter-rouge">pytest -s</code>로 실행했을 때만 <code class="language-plaintext highlighter-rouge">True</code>가 됩니다. 따라서 <code class="language-plaintext highlighter-rouge">-s</code> 옵션이 있을 때만 콘솔 출력하도록 제어 가능</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">PYTEST_CURRENT_TEST</code> 환경변수: pytest 실행 여부를 판단할 수 있는 표준적이고 안전한 방법</p>
  </li>
</ul>

<hr />

<h2 id="-사용-예시">✅ 사용 예시</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># your_package/__main__.py or cli.py
</span><span class="kn">from</span> <span class="n">your_package.logging_setup</span> <span class="kn">import</span> <span class="n">setup_logging</span>
<span class="kn">import</span> <span class="n">logging</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nf">setup_logging</span><span class="p">()</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Started something</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="-pytest에서-사용-시">✅ <code class="language-plaintext highlighter-rouge">pytest</code>에서 사용 시</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 콘솔 로그 안 나옴 (파일에만 저장됨)</span>
pytest

<span class="c"># 콘솔 로그 출력됨 (isatty가 True)</span>
pytest <span class="nt">-s</span>
</code></pre></div></div>

<p>이 구조는 <strong>CLI 사용</strong> 과 <strong>테스트 환경</strong> 을 모두 안정적으로 커버합니다.</p>

<hr />

<h2 id="-보너스-로그-파일-경로를-디폴트-외로-바꾸고-싶다면">✅ 보너스: 로그 파일 경로를 디폴트 외로 바꾸고 싶다면?</h2>

<p><code class="language-plaintext highlighter-rouge">setup_logging(log_file="logs/output.log")</code> 식으로 인자를 받아 처리하면 됩니다.<br />
또는 <code class="language-plaintext highlighter-rouge">ENV</code> 값으로 파일 위치를 바꿀 수도 있습니다.</p>

<hr />

<p>필요하시면 이 구조를 패키지 전체에 반영하는 디렉터리 템플릿까지 만들어 드릴 수 있습니다.</p>

<p class="chat--user">

pytest에서 setup_logging을 해줘야해?

</p>

<p>결론부터 말씀드리면:<br />
<strong>❌<code class="language-plaintext highlighter-rouge">pytest</code>에서는 별도로 <code class="language-plaintext highlighter-rouge">setup_logging()</code>을 호출할 필요가 없습니다.</strong><br />
(단, <strong>테스트 중 로그를 “파일로 저장”하고 싶다면 호출해야</strong> 합니다.)</p>

<hr />

<h2 id="-왜-기본적으로-호출할-필요가-없나">🔍 왜 기본적으로 호출할 필요가 없나?</h2>

<p>당신이 설정한 <code class="language-plaintext highlighter-rouge">setup_logging()</code> 함수는 다음 조건을 체크합니다:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">is_pytest</span> <span class="o">=</span> <span class="sh">"</span><span class="s">PYTEST_CURRENT_TEST</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">is_pytest</span> <span class="ow">or</span> <span class="p">(</span><span class="n">is_pytest</span> <span class="ow">and</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">isatty</span><span class="p">()):</span>
    <span class="c1"># 콘솔 핸들러 추가
</span></code></pre></div></div>

<p>즉, <code class="language-plaintext highlighter-rouge">pytest -s</code>로 실행하면 콘솔 핸들러를 추가하고,<br />
그 외의 경우엔 콘솔 핸들러를 추가하지 않습니다.</p>

<p>하지만 이 코드는 <strong>자동으로 호출되지 않습니다.</strong><br />
따라서 <code class="language-plaintext highlighter-rouge">pytest</code>가 알아서 <code class="language-plaintext highlighter-rouge">setup_logging()</code>을 실행해주지는 않기 때문에 <strong>“파일로도 남기고 싶다”거나, 특정
포맷/수준으로 통일하려면</strong> 명시적으로 설정을 불러야 합니다.</p>

<hr />

<h2 id="-정리-호출-여부-기준">✅ 정리: 호출 여부 기준</h2>

<table>
  <thead>
    <tr>
      <th>상황</th>
      <th><code class="language-plaintext highlighter-rouge">setup_logging()</code> 호출 여부</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pytest -s</code>에서 콘솔 로그만 보고 싶다</td>
      <td>❌ 호출 안 해도 됨 (pytest 자체 로그 출력 기능 사용)</td>
    </tr>
    <tr>
      <td>로그를 파일에도 저장하고 싶다</td>
      <td>✅ 호출해야 함 (pytest는 파일로 저장 안 함)</td>
    </tr>
    <tr>
      <td>콘솔 출력 포맷/색상 커스터마이징이 필요하다</td>
      <td>✅ 직접 설정 필요</td>
    </tr>
    <tr>
      <td>로그 메시지를 테스트에서 검증하고 싶다 (<code class="language-plaintext highlighter-rouge">caplog</code>)</td>
      <td>❌ pytest 내부 캡처만으로 충분</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-추천-테스트-시-자동으로-설정하려면-conftestpy">🧪 추천: 테스트 시 자동으로 설정하려면 <code class="language-plaintext highlighter-rouge">conftest.py</code></h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># conftest.py (테스트 루트 디렉토리)
</span><span class="kn">import</span> <span class="n">pytest</span>
<span class="kn">from</span> <span class="n">your_package.logging_setup</span> <span class="kn">import</span> <span class="n">setup_logging</span>

<span class="nd">@pytest.fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="sh">"</span><span class="s">session</span><span class="sh">"</span><span class="p">,</span> <span class="n">autouse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_init_logging</span><span class="p">():</span>
    <span class="nf">setup_logging</span><span class="p">()</span>
</code></pre></div></div>

<p>단, 이 방식은 항상 로깅이 파일로 기록되므로, 테스트 격리성을 중요시하는 환경에선 조심해야 합니다.</p>

<hr />

<h2 id="️-결론">✍️ 결론</h2>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">pytest</code>에서 <strong>콘솔 출력만 원한다면</strong> : <code class="language-plaintext highlighter-rouge">-s</code> 옵션 + <code class="language-plaintext highlighter-rouge">setup_logging()</code>은 호출하지 않아도 된다</p>
  </li>
  <li>
    <p><strong>파일 로그까지 남기고 싶거나</strong> 포맷을 통일하고 싶다면: <code class="language-plaintext highlighter-rouge">setup_logging()</code> 명시 호출 필요</p>
  </li>
  <li>
    <p>자동화를 원한다면 <code class="language-plaintext highlighter-rouge">conftest.py</code>에서 초기화 가능</p>
  </li>
</ul>

<p>추가로 <code class="language-plaintext highlighter-rouge">caplog</code>와 <code class="language-plaintext highlighter-rouge">setup_logging()</code>을 병행할 때 생기는 문제도 다룰 수 있습니다. 원하시면 말씀 주세요.</p>

<p class="chat--user">

이해가 잘 안되네. pytest에서는 setup_logging 호출을 아얘 안할건데 # pytest 실행 중이면 표준 출력 핸들러 추가 조건
확인 is_pytest = "PYTEST_CURRENT_TEST" in os.environ if not is_pytest or
(is_pytest and sys.stdout.isatty()): stream_handler =
logging.StreamHandler(sys.stdout)
stream_handler.setFormatter(ColorFormatter(fmt, datefmt))
root_logger.addHandler(stream_handler) 이 코드는 왜 있는거야? 그리고 toml 파일 설정해야한다고 했지
않아? 설정법도 한번에 다 정리해줘

</p>

<p>좋습니다. 아주 핵심적인 질문이십니다. 지금 정확히 짚고 넘어가야 할 부분이 두 가지입니다:</p>

<hr />

<h2 id="-질문-1-setup_logging-안-쓸-거면-거기-있는-is_pytest-조건문은-왜-있나">✅ 질문 1: <code class="language-plaintext highlighter-rouge">setup_logging()</code> 안 쓸 거면, 거기 있는 <code class="language-plaintext highlighter-rouge">is_pytest</code> 조건문은 왜 있나?</h2>

<p>정확히 보셨습니다.<br />
<strong><code class="language-plaintext highlighter-rouge">setup_logging()</code> 자체를 <code class="language-plaintext highlighter-rouge">pytest</code>에서 호출하지 않는다면</strong>, 거기에 있는 <code class="language-plaintext highlighter-rouge">is_pytest</code> 분기:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">is_pytest</span> <span class="o">=</span> <span class="sh">"</span><span class="s">PYTEST_CURRENT_TEST</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">is_pytest</span> <span class="ow">or</span> <span class="p">(</span><span class="n">is_pytest</span> <span class="ow">and</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">isatty</span><span class="p">()):</span>
    <span class="bp">...</span>
</code></pre></div></div>

<p>→ <strong>전혀 실행되지 않습니다.</strong><br />
즉, <strong>pytest 실행 여부를 고려한 분기는<code class="language-plaintext highlighter-rouge">setup_logging()</code>을 테스트 환경에서 실행할 경우에만 의미가 있습니다.</strong></p>

<p>그러므로 다음과 같은 결론이 납니다:</p>

<blockquote>
  <p><strong>당신이 테스트에서는<code class="language-plaintext highlighter-rouge">setup_logging()</code>을 호출하지 않기로 했다면</strong>, 저 <code class="language-plaintext highlighter-rouge">is_pytest</code> 체크 로직은 필요 없습니다.</p>
</blockquote>

<hr />

<h2 id="-질문-2-그럼-로그-설정은-어디서-해야-하냐-pytest-실행-시엔">✅ 질문 2: 그럼 로그 설정은 어디서 해야 하냐? <code class="language-plaintext highlighter-rouge">pytest</code> 실행 시엔?</h2>

<p><code class="language-plaintext highlighter-rouge">setup_logging()</code> 없이도 pytest에서 로그를 출력하고 싶다면, <strong><code class="language-plaintext highlighter-rouge">pyproject.toml</code>이나
<code class="language-plaintext highlighter-rouge">pytest.ini</code></strong>에 로깅 설정을 넣으면 됩니다.</p>

<hr />

<h2 id="-추천-방식-당신-요구사항-기준">✅ 추천 방식 (당신 요구사항 기준)</h2>

<h3 id="-pyprojecttoml-또는-pytestini에-아래-설정을-추가">🧾 <code class="language-plaintext highlighter-rouge">pyproject.toml</code> 또는 <code class="language-plaintext highlighter-rouge">pytest.ini</code>에 아래 설정을 추가</h3>

<h4 id="-예시-pyprojecttoml">📌 예시: <code class="language-plaintext highlighter-rouge">pyproject.toml</code></h4>

<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[tool.pytest.ini_options]</span>
<span class="py">log_cli</span> <span class="p">=</span> <span class="kc">true</span>
<span class="py">log_cli_level</span> <span class="p">=</span> <span class="s">"INFO"</span>
<span class="py">log_cli_format</span> <span class="p">=</span> <span class="s">"[%(asctime)s] %(levelname)s - %(name)s - %(message)s"</span>
<span class="py">log_cli_date_format</span> <span class="p">=</span> <span class="s">"%Y-%m-%d %H:%M:%S"</span>
</code></pre></div></div>

<h4 id="-또는-pytestini-버전">📌 또는 <code class="language-plaintext highlighter-rouge">pytest.ini</code> 버전</h4>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[pytest]</span>
<span class="py">log_cli</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">log_cli_level</span> <span class="p">=</span> <span class="s">INFO</span>
<span class="py">log_cli_format</span> <span class="p">=</span> <span class="s">[%(asctime)s] %(levelname)s - %(name)s - %(message)s</span>
<span class="py">log_cli_date_format</span> <span class="p">=</span> <span class="s">%Y-%m-%d %H:%M:%S</span>
</code></pre></div></div>

<hr />

<h2 id="-위-설정의-의미">✅ 위 설정의 의미</h2>

<table>
  <thead>
    <tr>
      <th>옵션</th>
      <th>역할</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">log_cli</code></td>
      <td>표준 출력으로 로그를 출력함 (<code class="language-plaintext highlighter-rouge">-s</code> 없이도 가능)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">log_cli_level</code></td>
      <td>출력할 최소 로그 수준</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">log_cli_format</code></td>
      <td>로그 포맷 지정</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">log_cli_date_format</code></td>
      <td>날짜 포맷 지정</td>
    </tr>
  </tbody>
</table>

<p>즉, 이 설정만 있으면:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">pytest</code> 실행 시, <code class="language-plaintext highlighter-rouge">setup_logging()</code> 없이도 로그가 콘솔에 출력됨</p>
  </li>
  <li>
    <p>별도 코드 불필요</p>
  </li>
  <li>
    <p>로그 파일 기록은 없음 (이건 <code class="language-plaintext highlighter-rouge">setup_logging()</code>을 써야 함)</p>
  </li>
</ul>

<hr />

<h2 id="-최종-정리">🔁 최종 정리</h2>

<table>
  <thead>
    <tr>
      <th>목적</th>
      <th>해야 할 일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>테스트 시 콘솔 출력만 하고 싶다</strong></td>
      <td><code class="language-plaintext highlighter-rouge">pyproject.toml</code> 또는 <code class="language-plaintext highlighter-rouge">pytest.ini</code>에 설정 추가 (<code class="language-plaintext highlighter-rouge">log_cli = true</code>)</td>
    </tr>
    <tr>
      <td><strong>테스트 시 로그를 파일로 저장하고 싶다</strong></td>
      <td><code class="language-plaintext highlighter-rouge">setup_logging()</code>을 <code class="language-plaintext highlighter-rouge">conftest.py</code>에서 호출 (예: <code class="language-plaintext highlighter-rouge">autouse fixture</code>)</td>
    </tr>
    <tr>
      <td><strong>테스트 시에도 색상 있는 출력 원한다</strong></td>
      <td><code class="language-plaintext highlighter-rouge">setup_logging()</code>을 직접 호출해야 가능 (ANSI 색은 <code class="language-plaintext highlighter-rouge">pytest</code> 설정에선 불가)</td>
    </tr>
    <tr>
      <td><strong>CLI 실행 시에는<code class="language-plaintext highlighter-rouge">setup_logging()</code> 필수</strong></td>
      <td>콘솔 + 파일 로그 모두 설정됨</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-결론-2">🧠 결론</h2>

<p>당신이 설정한 <code class="language-plaintext highlighter-rouge">setup_logging()</code> 안의 <code class="language-plaintext highlighter-rouge">is_pytest</code> 조건문은,<br />
<strong>"pytest에서<code class="language-plaintext highlighter-rouge">setup_logging()</code>을 호출할 경우에만 의미 있음"</strong>.<br />
그런데 <strong>당신은 pytest에서<code class="language-plaintext highlighter-rouge">setup_logging()</code>을 호출 안 하기로 했으므로</strong>,<br />
→ 그 코드는 <strong>의미 없음</strong><br />
→ <strong>지워도 됨</strong> , 더 깔끔해짐</p>

<hr />

<p>필요하시면 <code class="language-plaintext highlighter-rouge">pyproject.toml</code>, <code class="language-plaintext highlighter-rouge">conftest.py</code>, <code class="language-plaintext highlighter-rouge">setup_logging.py</code> 전체 파일 구조 예시도 만들어드릴 수
있습니다.</p>

<p class="chat--user">

이렇게 하면 pytest -s 했을 때만 출력돼?

</p>

<p><strong>아니요.</strong><br />
<code class="language-plaintext highlighter-rouge">pytest.ini</code>나 <code class="language-plaintext highlighter-rouge">pyproject.toml</code>에 <code class="language-plaintext highlighter-rouge">log_cli = true</code>를 설정하면,<br />
<strong><code class="language-plaintext highlighter-rouge">pytest -s</code> 없이도 항상 로그가 출력됩니다.</strong></p>

<hr />

<h2 id="-다시-말해">✅ 다시 말해:</h2>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[pytest]</span>
<span class="py">log_cli</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">log_cli_level</span> <span class="p">=</span> <span class="s">INFO</span>
</code></pre></div></div>

<p>이 설정은 다음과 같이 작동합니다:</p>

<table>
  <thead>
    <tr>
      <th>명령어</th>
      <th>로그 출력됨?</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pytest</code></td>
      <td>✅ 출력됨</td>
      <td>로그 캡처를 끄고 콘솔에 직접 출력</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pytest -s</code></td>
      <td>✅ 출력됨</td>
      <td><code class="language-plaintext highlighter-rouge">-s</code>는 <code class="language-plaintext highlighter-rouge">stdout</code> 캡처도 해제함</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pytest --capture=no</code></td>
      <td>✅ 출력됨</td>
      <td><code class="language-plaintext highlighter-rouge">-s</code>와 유사</td>
    </tr>
  </tbody>
</table>

<p>즉, <strong><code class="language-plaintext highlighter-rouge">log_cli = true</code></strong>는 pytest가 자체적으로 stdout/stderr를 로그 전용 핸들러로 대체하여 <strong>콘솔 로그
출력</strong> 을 <strong>항상 활성화</strong> 시키는 설정입니다. <code class="language-plaintext highlighter-rouge">-s</code> 여부와 무관합니다.</p>

<hr />

<h2 id="-당신의-요구사항-다시-보면">❗ 당신의 요구사항 다시 보면</h2>

<blockquote>
  <p>"pytest 시에도 로그 표준 출력을 한다. 단 (-s) 옵션 줬을 때만"</p>
</blockquote>

<p>이걸 만족하려면:</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">log_cli = true</code>를 쓰면 안 됩니다.</strong> (항상 출력되니까)</p>
  </li>
  <li>
    <p>대신, <code class="language-plaintext highlighter-rouge">setup_logging()</code>에서 <strong><code class="language-plaintext highlighter-rouge">sys.stdout.isatty()</code>가 True일 때만 핸들러를 붙이는 방식</strong>을 <strong>직접 호출</strong> 해야 합니다.</p>
  </li>
</ul>

<hr />

<h2 id="-진짜로--s일-때만-로그-출력하는-방식-정리">✅ 진짜로 <code class="language-plaintext highlighter-rouge">-s</code>일 때만 로그 출력하는 방식 정리</h2>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">pytest.ini</code>/<code class="language-plaintext highlighter-rouge">toml</code>은 <strong>아예 설정 안 함</strong> (<code class="language-plaintext highlighter-rouge">log_cli = false</code> or 생략)</p>
  </li>
  <li>
    <p>로그 출력은 오직 <code class="language-plaintext highlighter-rouge">setup_logging()</code>을 통해 하되, 조건을 이렇게 둠:</p>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">sys</span>

<span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(...):</span>
    <span class="k">if</span> <span class="sh">"</span><span class="s">PYTEST_CURRENT_TEST</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">isatty</span><span class="p">():</span>
            <span class="k">return</span>  <span class="c1"># pytest + -s 아님 → 출력 X
</span>
    <span class="c1"># 그 외엔 일반 로그 설정
</span></code></pre></div></div>

<ol>
  <li><strong><code class="language-plaintext highlighter-rouge">conftest.py</code></strong> 또는 테스트에서 이걸 직접 호출</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># conftest.py
</span><span class="kn">import</span> <span class="n">pytest</span>
<span class="kn">from</span> <span class="n">your_package.logging_setup</span> <span class="kn">import</span> <span class="n">setup_logging</span>

<span class="nd">@pytest.fixture</span><span class="p">(</span><span class="n">autouse</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="sh">"</span><span class="s">session</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_init_logging</span><span class="p">():</span>
    <span class="nf">setup_logging</span><span class="p">()</span>
</code></pre></div></div>

<hr />

<h2 id="-요약-2">🔁 요약</h2>

<table>
  <thead>
    <tr>
      <th>방법</th>
      <th><code class="language-plaintext highlighter-rouge">-s</code>일 때만 출력?</th>
      <th>비고</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pytest.ini</code> + <code class="language-plaintext highlighter-rouge">log_cli=true</code></td>
      <td>❌ 항상 출력됨</td>
      <td>편하긴 하지만 요구사항 불일치</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">setup_logging()</code> + <code class="language-plaintext highlighter-rouge">isatty()</code> 조건</td>
      <td>✅ 만족</td>
      <td>직접 호출 필요</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-최종-결론">✅ 최종 결론</h2>

<blockquote>
  <p><strong>당신이 원한 정확한 동작 (오직 -s일 때만 출력)</strong> 을 구현하려면,<br />
 <strong><code class="language-plaintext highlighter-rouge">pytest.ini</code> 설정은 쓰지 말고</strong>, <code class="language-plaintext highlighter-rouge">setup_logging()</code> 내부에 <code class="language-plaintext highlighter-rouge">isatty()</code> 조건을 사용해야 합니다.</p>
</blockquote>

<p>필요하시면 그 조건 포함한 확정 코드 템플릿 드릴 수 있습니다.</p>

<p class="chat--user">

보통은 어떻게 하지

</p>

<p>좋습니다. 이 질문은 본질적입니다.<br />
<strong>"현실적인 Python 프로젝트에서 테스트 시 로그를 어떻게 다루느냐"</strong>는<br />
실제 팀/오픈소스/라이브러리들이 어떤 트레이드오프를 택했는지를 봐야 이해가 됩니다.</p>

<hr />

<h2 id="-실무오픈소스에서-보통-하는-방식-요약">✅ 실무/오픈소스에서 보통 하는 방식 요약</h2>

<table>
  <thead>
    <tr>
      <th>방식</th>
      <th>선택 이유</th>
      <th>단점</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>pytest 설정(<code class="language-plaintext highlighter-rouge">log_cli = true</code>)으로 항상 출력</strong></td>
      <td>간단함, 설정 한 줄이면 끝</td>
      <td>로그가 너무 많아질 수 있음. 테스트 결과 보기 힘듦</td>
    </tr>
    <tr>
      <td><strong>테스트에서는 로그 숨기고 실패 시만 출력 (기본)</strong></td>
      <td>테스트 결과 깔끔, CI에 적합</td>
      <td>실패 전까지 로그 확인 어려움</td>
    </tr>
    <tr>
      <td><strong>조건부 출력 (<code class="language-plaintext highlighter-rouge">-s</code>일 때만 출력)</strong></td>
      <td>필요한 상황에만 출력 가능</td>
      <td>구현 복잡도 증가, pytest와 충돌 주의</td>
    </tr>
    <tr>
      <td><strong>로그 파일로만 기록, 콘솔 출력 없음</strong></td>
      <td>CI에서 아카이브 가능</td>
      <td>개발 중 디버깅 불편</td>
    </tr>
    <tr>
      <td><strong>caplog fixture 사용으로 개별 테스트에서 로그 확인</strong></td>
      <td>테스트 검증 가능</td>
      <td>설정은 간단, 하지만 일일이 caplog 사용 필요</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-일반적인-권장-흐름">✅ 일반적인 권장 흐름</h2>

<ol>
  <li>
    <p><strong>기본은 로그를 안 보이게 한다</strong><br />
→ <code class="language-plaintext highlighter-rouge">pytest</code> 기본 동작 그대로 (캡처된 상태)</p>
  </li>
  <li>
    <p><strong>로컬 개발자가 보고 싶으면<code class="language-plaintext highlighter-rouge">-s</code> 또는 <code class="language-plaintext highlighter-rouge">--log-cli-level=INFO</code> 사용</strong><br />
→ 필요할 때만 출력. 깔끔함과 디버깅 둘 다 확보</p>
  </li>
  <li>
    <p><strong>CI 환경에선 로그 파일로 저장</strong><br />
→ 문제가 생기면 로그 파일을 분석 가능</p>
  </li>
  <li>
    <p><strong>모듈은 항상<code class="language-plaintext highlighter-rouge">getLogger(__name__)</code>만 쓰고, 로깅 설정은 진입점 또는 테스트 init에서 함</strong><br />
→ 설정 위치를 명확히 하고 예측 가능하게 함</p>
  </li>
</ol>

<hr />

<h2 id="-오픈소스-예시들">✅ 오픈소스 예시들</h2>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">requests</code>, <code class="language-plaintext highlighter-rouge">urllib3</code>, <code class="language-plaintext highlighter-rouge">pydantic</code> 등 대형 라이브러리들</strong>:</p>

    <ul>
      <li>
        <p>내부에서 <code class="language-plaintext highlighter-rouge">logging.getLogger(__name__)</code>만 씀</p>
      </li>
      <li>
        <p>로그 설정은 <strong>전적으로 사용자에게 맡김</strong></p>
      </li>
      <li>
        <p>테스트 중 로그 출력 없음 (<code class="language-plaintext highlighter-rouge">caplog</code> 사용하거나, 실패 시 출력)</p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">pytest</code> 자체 테스트</strong>:</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">log_cli</code>는 사용 안 하고, 필요할 경우만 명시적으로 로그 출력</li>
    </ul>
  </li>
  <li>
    <p><strong>CLI 도구 (e.g.<code class="language-plaintext highlighter-rouge">poetry</code>, <code class="language-plaintext highlighter-rouge">black</code>)</strong>:</p>

    <ul>
      <li>
        <p>CLI 실행 시 <code class="language-plaintext highlighter-rouge">setup_logging()</code> 명시 호출</p>
      </li>
      <li>
        <p>테스트에서는 로그 안 찍음 or 파일로만 기록</p>
      </li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="-실무에서-이걸-어떻게-해석해야-하나">🧠 실무에서 이걸 어떻게 해석해야 하나?</h2>

<blockquote>
  <p><strong>“로컬 디버깅 편의” vs “CI/테스트 깔끔함”</strong> 사이에서 밸런스를 잡아야 합니다.</p>
</blockquote>

<ul>
  <li>
    <p>로컬에서는 <code class="language-plaintext highlighter-rouge">-s</code>나 <code class="language-plaintext highlighter-rouge">--log-cli-level=DEBUG</code>로 출력 가능하게 두고,</p>
  </li>
  <li>
    <p>기본 동작은 출력 안 하되,</p>
  </li>
  <li>
    <p>파일 기록은 해두면 나중에 추적할 수 있고,</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setup_logging()</code>은 명시적으로 호출하는 구조로 하면 <strong>예측 가능하고 제어 가능</strong> 합니다.</p>
  </li>
</ul>

<hr />

<h2 id="️-결론-1">✍️ 결론</h2>

<blockquote>
  <p><strong>보통은<code class="language-plaintext highlighter-rouge">pytest.ini</code>에 <code class="language-plaintext highlighter-rouge">log_cli = true</code>를 넣고 항상 출력하게 하거나, 아예 안 하고 -s 옵션에 맡깁니다.</strong><br />
 당신처럼 <strong>“-s일 때만 출력”</strong>을 엄격히 원하는 경우는 <strong>커스텀 조건을 넣는 팀/개인들이 일부</strong> 존재합니다. 하지만
<strong>기본/일반은 아닙니다.</strong></p>
</blockquote>

<p>—</p>

<p>필요하시면 "가장 보편적이고 실용적인 구성" 예제를 전체 프로젝트 구조로 정리해드릴 수 있습니다.</p>

<p class="chat--user">

caplog은 어떻게 쓰는거야?

</p>

<p>좋습니다. <code class="language-plaintext highlighter-rouge">caplog</code>은 <code class="language-plaintext highlighter-rouge">pytest</code>가 제공하는 <strong>로그 캡처 전용 fixture</strong> 입니다.<br />
테스트 중 발생한 <code class="language-plaintext highlighter-rouge">logging</code> 메시지를 <strong>수집하고 검증</strong> 할 수 있게 해줍니다.</p>

<hr />

<h2 id="-caplog을-언제-쓰나">✅ caplog을 언제 쓰나?</h2>

<ul>
  <li>
    <p>특정 로그 메시지가 발생했는지 검증하고 싶을 때</p>
  </li>
  <li>
    <p>stdout이나 파일 로그가 아닌, <strong>메모리 내 로그 버퍼를 확인</strong> 하고 싶을 때</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setup_logging()</code> 같은 설정 없이도 동작함</p>
  </li>
</ul>

<hr />

<h2 id="-caplog-기본-사용법">✅ caplog 기본 사용법</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># test_module.py
</span><span class="kn">import</span> <span class="n">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="sh">"</span><span class="s">my_module</span><span class="sh">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">some_function</span><span class="p">():</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Running some_function</span><span class="sh">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test_logging_output</span><span class="p">(</span><span class="n">caplog</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">caplog</span><span class="p">.</span><span class="nf">at_level</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">):</span>
        <span class="nf">some_function</span><span class="p">()</span>

    <span class="k">assert</span> <span class="sh">"</span><span class="s">Running some_function</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">caplog</span><span class="p">.</span><span class="n">text</span>
</code></pre></div></div>

<h3 id="설명">설명:</h3>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">caplog</code>을 fixture로 인자로 받음</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">caplog.at_level(...)</code>로 캡처할 로그 레벨 설정</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">caplog.text</code>: 전체 캡처된 로그 문자열</p>
  </li>
  <li>
    <p>개별 로그 레코드는 <code class="language-plaintext highlighter-rouge">caplog.records</code>에서 리스트로 접근 가능</p>
  </li>
</ul>

<hr />

<h2 id="-caplogtext-vs-caplogrecords">✅ caplog.text vs caplog.records</h2>

<h3 id="caplogtext-문자열로-모든-로그-모아보기"><code class="language-plaintext highlighter-rouge">caplog.text</code>: 문자열로 모든 로그 모아보기</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="n">caplog</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
<span class="c1"># 예: [2025-07-21 00:00:00] INFO - my_module - Running some_function
</span></code></pre></div></div>

<h3 id="caplogrecords-logginglogrecord-객체-리스트"><code class="language-plaintext highlighter-rouge">caplog.records</code>: <code class="language-plaintext highlighter-rouge">logging.LogRecord</code> 객체 리스트</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">caplog</span><span class="p">.</span><span class="n">records</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">record</span><span class="p">.</span><span class="n">levelname</span> <span class="o">==</span> <span class="sh">"</span><span class="s">INFO</span><span class="sh">"</span>
    <span class="k">assert</span> <span class="n">record</span><span class="p">.</span><span class="n">message</span><span class="p">.</span><span class="nf">startswith</span><span class="p">(</span><span class="sh">"</span><span class="s">Running</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="-여러-로거에서-발생한-로그도-다-캡처됨">✅ 여러 로거에서 발생한 로그도 다 캡처됨</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_multi_logger</span><span class="p">(</span><span class="n">caplog</span><span class="p">):</span>
    <span class="kn">import</span> <span class="n">logging</span>
    <span class="n">logger1</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="sh">"</span><span class="s">a</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">logger2</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="sh">"</span><span class="s">b</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">caplog</span><span class="p">.</span><span class="nf">at_level</span><span class="p">(</span><span class="sh">"</span><span class="s">WARNING</span><span class="sh">"</span><span class="p">):</span>
        <span class="n">logger1</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sh">"</span><span class="s">Warn from a</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">logger2</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sh">"</span><span class="s">Error from b</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">assert</span> <span class="sh">"</span><span class="s">Warn from a</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">caplog</span><span class="p">.</span><span class="n">text</span>
    <span class="k">assert</span> <span class="sh">"</span><span class="s">Error from b</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">caplog</span><span class="p">.</span><span class="n">text</span>
</code></pre></div></div>

<hr />

<h2 id="-사용-시-주의점">✅ 사용 시 주의점</h2>

<table>
  <thead>
    <tr>
      <th>항목</th>
      <th>내용</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>로그 레벨 안 맞으면 안 잡힘</td>
      <td><code class="language-plaintext highlighter-rouge">with caplog.at_level(...)</code> 안 쓰면 기본 <code class="language-plaintext highlighter-rouge">WARNING</code> 이상만 잡힘</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">setup_logging()</code>이 caplog와 충돌 가능</td>
      <td><code class="language-plaintext highlighter-rouge">root_logger.setLevel(...)</code>이 pytest의 캡처를 방해할 수 있음</td>
    </tr>
    <tr>
      <td>로그 포맷, 색상 등은 <code class="language-plaintext highlighter-rouge">caplog</code>와 무관</td>
      <td>오직 메시지, 수준, 로거 이름 등 <strong>내용 중심</strong> 검증용</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-실제-테스트-검증-예시-정리된-형태">✅ 실제 테스트 검증 예시 (정리된 형태)</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_error_logged</span><span class="p">(</span><span class="n">caplog</span><span class="p">):</span>
    <span class="kn">import</span> <span class="n">logging</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="sh">"</span><span class="s">my_module</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">caplog</span><span class="p">.</span><span class="nf">at_level</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">ERROR</span><span class="p">):</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sh">"</span><span class="s">Something failed!</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">assert</span> <span class="nf">any</span><span class="p">(</span><span class="sh">"</span><span class="s">Something failed!</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">msg</span> <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">caplog</span><span class="p">.</span><span class="n">messages</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">caplog.messages</code>: <code class="language-plaintext highlighter-rouge">record.getMessage()</code> 결과 리스트 (색상, 포맷 없음)</p>
  </li>
  <li>
    <p>이 방식이 가장 단순하고 안전함</p>
  </li>
</ul>

<hr />

<h2 id="-요약-3">🔁 요약</h2>

<table>
  <thead>
    <tr>
      <th>기능</th>
      <th>caplog 방법</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>로그 수집</td>
      <td><code class="language-plaintext highlighter-rouge">caplog.text</code>, <code class="language-plaintext highlighter-rouge">caplog.records</code>, <code class="language-plaintext highlighter-rouge">caplog.messages</code></td>
    </tr>
    <tr>
      <td>레벨 지정</td>
      <td><code class="language-plaintext highlighter-rouge">with caplog.at_level(logging.INFO):</code></td>
    </tr>
    <tr>
      <td>포맷 없이 메시지만 보기</td>
      <td><code class="language-plaintext highlighter-rouge">caplog.messages</code></td>
    </tr>
    <tr>
      <td>복수 로거 확인</td>
      <td>자동으로 다 캡처됨</td>
    </tr>
  </tbody>
</table>

<hr />

<p>필요하시면 <code class="language-plaintext highlighter-rouge">caplog</code>을 활용한 고급 테스트 예제 (예: 로그가 안 나와야 한다든가, 특정 로거만 필터링한다든가) 도 만들어 드릴 수
있습니다.</p>

<p class="chat--user">

유저한테 알려주기 위한 info도 logging써서 전달해도되나?

</p>

<p>좋은 질문입니다.<br />
<strong>"사용자에게 알려줄 메시지도<code class="language-plaintext highlighter-rouge">logging.info()</code>로 출력해도 되는가?"</strong><br />
→ <strong>정답은: 상황에 따라 다르지만, 일반적으로는</strong>"되긴 하지만 조심해야 한다"** 입니다.**</p>

<hr />

<h2 id="-언제-logginginfo로-사용자-메시지를-출력해도-괜찮나">✅ 언제 <code class="language-plaintext highlighter-rouge">logging.info()</code>로 사용자 메시지를 출력해도 괜찮나?</h2>

<ul>
  <li>
    <p><strong>CLI 도구</strong> 에서, stdout으로 메시지를 간단히 보여줄 때</p>
  </li>
  <li>
    <p><strong>디버그/진행상황 정도</strong> 를 보여줄 때 ("Processing…", "Done!" 등)</p>
  </li>
  <li>
    <p><strong>스크립트 실행 로그와 사용자 메시지가 구분되지 않아도 괜찮을 때</strong></p>
  </li>
</ul>

<p>예:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">All files processed successfully.</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p>→ 콘솔에 찍히긴 하지만, 로그 포맷이 <code class="language-plaintext highlighter-rouge">[2025-07-21 10:00:00] INFO - ...</code> 식이면 사용자가 "이게 뭐지?" 할 수
있음</p>

<hr />

<h2 id="-언제는-logging이-부적절한가">❌ 언제는 <code class="language-plaintext highlighter-rouge">logging</code>이 부적절한가?</h2>

<ul>
  <li>
    <p><strong>명확한 사용자 커뮤니케이션</strong> 이 필요한 경우:</p>

    <ul>
      <li>
        <p>에러 메시지, 경고, 주의사항</p>
      </li>
      <li>
        <p>UX 메시지 ("입력이 잘못되었습니다", "업데이트가 완료되었습니다")</p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>로그 포맷이 사용자를 혼란시킬 수 있는 경우</strong></p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">[시간] LEVEL - logger - 메시지</code> 형태로 나오면 사용자는 그게 "로그"인지, "출력"인지 헷갈립니다</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="-그럼-어떻게-구분하면-좋은가">✅ 그럼 어떻게 구분하면 좋은가?</h2>

<h3 id="-구조-분리-방식-추천">✔ 구조 분리 방식 (추천)</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">notify_user</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>  <span class="c1"># 사용자에게 보여줄 메시지
</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Starting processing</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">notify_user</span><span class="p">(</span><span class="sh">"</span><span class="s">🔄 작업을 시작합니다...</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p>이렇게 <code class="language-plaintext highlighter-rouge">print()</code>나 사용자 출력 전용 함수(<code class="language-plaintext highlighter-rouge">click.echo()</code> 등)를 따로 두는 것이 일반적입니다.</p>

<hr />

<h2 id="-실제-예-click-cli의-경우">✅ 실제 예: <code class="language-plaintext highlighter-rouge">click</code> CLI의 경우</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">click</span>
<span class="kn">import</span> <span class="n">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@click.command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sh">"</span><span class="s">Command started</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">click</span><span class="p">.</span><span class="nf">echo</span><span class="p">(</span><span class="sh">"</span><span class="s">✅ 사용 준비 완료!</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">logger.debug()</code> → 로그 파일 또는 디버깅용</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">click.echo()</code> → 사용자에게 직접 전달할 메시지 (포맷 없음)</p>
  </li>
</ul>

<hr />

<h2 id="-혼합-사용도-가능-주의해서">✅ 혼합 사용도 가능 (주의해서)</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Fetching user info</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># 로그 기록용
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">📦 사용자 정보 가져오는 중...</span><span class="sh">"</span><span class="p">)</span>   <span class="c1"># 사용자 전달용
</span></code></pre></div></div>

<p>이렇게 <strong>로그와 사용자 메시지를 구분해서 이중 출력</strong> 하는 것도 하나의 패턴입니다.<br />
다만 메시지가 중복되거나 복잡해지면 함수로 추상화하는 게 좋습니다.</p>

<hr />

<h2 id="-정리-2">🔁 정리</h2>

<table>
  <thead>
    <tr>
      <th>상황</th>
      <th><code class="language-plaintext highlighter-rouge">logging.info()</code> 사용 적합성</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>내부 상태 기록</td>
      <td>✅ 적합</td>
    </tr>
    <tr>
      <td>사용자 피드백</td>
      <td>⚠️ 조건부 (간단한 안내 정도는 OK)</td>
    </tr>
    <tr>
      <td>에러/경고/UX 메시지</td>
      <td>❌ 부적합 — print 또는 별도 함수 권장</td>
    </tr>
    <tr>
      <td>CLI UX 친화성 중요</td>
      <td>❌ 로그 포맷은 혼란을 줄 수 있음</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-결론-3">✅ 결론</h2>

<blockquote>
  <p><strong>"사용자에게 직접 전달할 메시지"는<code class="language-plaintext highlighter-rouge">print()</code>나 <code class="language-plaintext highlighter-rouge">click.echo()</code>로 하고,</strong><br />
 <strong><code class="language-plaintext highlighter-rouge">logging</code>은 시스템/개발자/디버깅을 위한 메시지 기록용으로 사용하는 것이 일반적이고 명확합니다.</strong></p>
</blockquote>

<p>필요하시면 CLI용 출력 유틸 (<code class="language-plaintext highlighter-rouge">echo_success</code>, <code class="language-plaintext highlighter-rouge">echo_error</code>, <code class="language-plaintext highlighter-rouge">echo_info</code>) 같은 것도 만들어 드릴 수
있습니다.</p>

<p class="chat--user">

click.echo랑 print의 차이는?

</p>

<p>좋은 질문입니다.<br />
<code class="language-plaintext highlighter-rouge">click.echo()</code>와 <code class="language-plaintext highlighter-rouge">print()</code>는 겉보기에는 비슷하지만, <strong>CLI 환경에서 신뢰성과 이식성 면에서 중요한 차이점</strong> 들이
있습니다.</p>

<hr />

<h2 id="-기본-차이-요약">✅ 기본 차이 요약</h2>

<table>
  <thead>
    <tr>
      <th>항목</th>
      <th><code class="language-plaintext highlighter-rouge">print()</code></th>
      <th><code class="language-plaintext highlighter-rouge">click.echo()</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>출력 대상</td>
      <td><code class="language-plaintext highlighter-rouge">sys.stdout</code> 고정</td>
      <td><code class="language-plaintext highlighter-rouge">sys.stdout</code> 또는 <code class="language-plaintext highlighter-rouge">sys.stderr</code> (선택 가능)</td>
    </tr>
    <tr>
      <td>유니코드 처리</td>
      <td>환경 따라 깨질 수 있음</td>
      <td>깨짐 방지, 자동 인코딩 처리</td>
    </tr>
    <tr>
      <td>CLI 환경 대응</td>
      <td>제한적 (TTY 확인 X)</td>
      <td>shell 환경, 리디렉션 등 대응 더 좋음</td>
    </tr>
    <tr>
      <td>사용 목적</td>
      <td>범용 Python 출력</td>
      <td>CLI 툴용 사용자 메시지 출력에 최적화</td>
    </tr>
    <tr>
      <td>테스트/리디렉션 대응</td>
      <td>수동 처리 필요</td>
      <td><code class="language-plaintext highlighter-rouge">click.testing.CliRunner</code>와 통합됨</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-유니코드인코딩-처리">✅ 유니코드/인코딩 처리</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">✅ 작업 완료</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># 일부 윈도우/리눅스 환경에서 깨짐 가능
</span>
<span class="n">click</span><span class="p">.</span><span class="nf">echo</span><span class="p">(</span><span class="sh">"</span><span class="s">✅ 작업 완료</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># click이 내부적으로 안전한 인코딩 사용
</span></code></pre></div></div>

<blockquote>
  <p>특히 Windows + cmd 환경에서는 <code class="language-plaintext highlighter-rouge">print()</code>가 깨질 가능성이 있음<br />
 <code class="language-plaintext highlighter-rouge">click.echo()</code>는 <code class="language-plaintext highlighter-rouge">locale.getpreferredencoding()</code>을 기반으로 처리해서 훨씬 안전함</p>
</blockquote>

<hr />

<h2 id="-stderr-지원">✅ <code class="language-plaintext highlighter-rouge">stderr</code> 지원</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">click</span><span class="p">.</span><span class="nf">echo</span><span class="p">(</span><span class="sh">"</span><span class="s">오류 발생</span><span class="sh">"</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>→ 이 메시지는 <code class="language-plaintext highlighter-rouge">sys.stderr</code>로 나가므로, 표준 출력과 분리되어 리디렉션 시 구분 가능</p>

<hr />

<h2 id="-테스트-통합-중요">✅ 테스트 통합 (중요)</h2>

<p><code class="language-plaintext highlighter-rouge">click.echo()</code>는 <code class="language-plaintext highlighter-rouge">click.testing.CliRunner</code>와 완벽하게 호환됩니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">click.testing</span> <span class="kn">import</span> <span class="n">CliRunner</span>

<span class="k">def</span> <span class="nf">test_cli_output</span><span class="p">():</span>
    <span class="n">runner</span> <span class="o">=</span> <span class="nc">CliRunner</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">runner</span><span class="p">.</span><span class="nf">invoke</span><span class="p">(</span><span class="n">main_command</span><span class="p">)</span>
    <span class="k">assert</span> <span class="sh">"</span><span class="s">작업 완료</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">result</span><span class="p">.</span><span class="n">output</span>
</code></pre></div></div>

<blockquote>
  <p>반면 <code class="language-plaintext highlighter-rouge">print()</code>는 stdout 직접 캡처해야 하고 테스트가 복잡해짐</p>
</blockquote>

<hr />

<h2 id="-결론-4">✅ 결론</h2>

<table>
  <thead>
    <tr>
      <th>용도</th>
      <th>추천 방식</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>간단한 스크립트 출력</td>
      <td><code class="language-plaintext highlighter-rouge">print()</code>도 OK</td>
    </tr>
    <tr>
      <td>CLI 툴 사용자 메시지</td>
      <td>✅ <strong><code class="language-plaintext highlighter-rouge">click.echo()</code>가 더 안전하고 강력</strong></td>
    </tr>
    <tr>
      <td>유니코드/에러 메시지 분리/테스트 연동 등 필요</td>
      <td>무조건 <code class="language-plaintext highlighter-rouge">click.echo()</code></td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-요약-문장">🔁 요약 문장</h2>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">print()</code>는 그냥 찍는 함수고, <code class="language-plaintext highlighter-rouge">click.echo()</code>는 CLI 도구용으로 <strong>더 견고하게 만든 출력 함수</strong> 입니다.<br />
 CLI를 만들고 있다면, 사용자에게 보여줄 메시지는 <code class="language-plaintext highlighter-rouge">click.echo()</code>가 정석입니다.</p>
</blockquote>

<p>필요하시면 <code class="language-plaintext highlighter-rouge">echo_info()</code>, <code class="language-plaintext highlighter-rouge">echo_error()</code> 같은 헬퍼 함수도 드릴 수 있습니다.</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#python" class="page__taxonomy-item p-category" rel="tag">python</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2025-07-21T23:06:43+09:00">2025-07-21</time></p>

      </footer>

      

      
  <nav class="pagination">
    
      <a href="/python/python-exception-debug/" class="pagination--pager" title="예외 처리 디버깅 방법">Previous</a>
    
    
      <a href="/linux/tmux-basic/" class="pagination--pager" title="tmux 기본 조작법">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You may also enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025-08-19-python-repr-vs-str/" rel="permalink">
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <!-- hvppyarchive: remove date icon
        <i class="far fa-calendar-alt" aria-hidden="true"></i> 
        -->
        
        <time datetime="2025-08-20T13:16:10+09:00">2025-08-20</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/misc/text-split-copy/" rel="permalink">텍스트 분할 복사
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <!-- hvppyarchive: remove date icon
        <i class="far fa-calendar-alt" aria-hidden="true"></i> 
        -->
        
        <time datetime="2025-08-20T13:16:06+09:00">2025-08-20</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/python/python-class-tree/" rel="permalink">Python 클래스 트리 출력
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <!-- hvppyarchive: remove date icon
        <i class="far fa-calendar-alt" aria-hidden="true"></i> 
        -->
        
        <time datetime="2025-08-20T12:33:01+09:00">2025-08-20</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/verilog/pyverilog-ir/" rel="permalink">PyVerilog AST 변환
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <!-- hvppyarchive: remove date icon
        <i class="far fa-calendar-alt" aria-hidden="true"></i> 
        -->
        
        <time datetime="2025-08-19T18:31:08+09:00">2025-08-19</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
  </ul>
</div>


<div class="page__footer-copyright">&copy; 2013 - 2025 <a href="https://hvppyarchive.github.io">ARCHIVE</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
