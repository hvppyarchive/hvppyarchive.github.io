<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.1 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>QFileDialog 설명 - ARCHIVE</title>
<meta name="description" content="">


  <meta name="author" content="hvppyarchive">
  
  <meta property="article:author" content="hvppyarchive">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="ARCHIVE">
<meta property="og:title" content="QFileDialog 설명">
<meta property="og:url" content="https://hvppyarchive.github.io/qt/qfiledialog-study/">


  <meta property="og:description" content="">







  <meta property="article:published_time" content="2025-11-13T12:24:00+09:00">





  

  


<link rel="canonical" href="https://hvppyarchive.github.io/qt/qfiledialog-study/">












<!-- end _includes/seo.html -->


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->
<!-- hvppyarchive: add fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@200..900&display=swap" rel="stylesheet">

<!-- insert favicons. use https://realfavicongenerator.net/ -->
 <!-- hvppyarchive: add favicons -->
<link rel="icon" type="image/png" href="/assets/favicon/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/assets/favicon/favicon.svg" />
<link rel="shortcut icon" href="/assets/favicon/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png" />
<link rel="manifest" href="/assets/favicon/site.webmanifest" />

<!-- end custom head snippets -->

  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          ARCHIVE
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/year-archive/"
                
                
              >Posts</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="QFileDialog 설명">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="2025-11-13T12:24:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://hvppyarchive.github.io/qt/qfiledialog-study/" itemprop="url">QFileDialog 설명
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <!-- hvppyarchive: remove date icon
        <i class="far fa-calendar-alt" aria-hidden="true"></i> 
        -->
        
        <time datetime="2025-11-13T12:24:00+09:00">2025-11-13</time>
      </span>
    

    

    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="chat--user">

QFileDialog 알아?

</p>

<p>응, 알아! Qt에서 파일 열기/저장할 때 나오는 그 “파일 선택 창” 만드는 클래스야.</p>

<p>조금 정리해보면:</p>

<ol>
  <li>
    <p>어디에 속해 있냐</p>

    <ul>
      <li>
        <p>Qt Widgets 쪽 클래스고 이름은 <code class="language-plaintext highlighter-rouge">QFileDialog</code>.</p>
      </li>
      <li>
        <p>C++에선 <code class="language-plaintext highlighter-rouge">#include &lt;QFileDialog&gt;</code></p>
      </li>
      <li>
        <p>PyQt/PySide에선 <code class="language-plaintext highlighter-rouge">from PyQt5.QtWidgets import QFileDialog</code> 같은 식으로 가져와.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>주 역할</p>

    <ul>
      <li>
        <p>파일 열기: 사용자에게 파일 하나/여러 개 선택하게 해서 경로를 돌려줌</p>
      </li>
      <li>
        <p>파일 저장: 저장할 파일 이름/경로 선택</p>
      </li>
      <li>
        <p>폴더 선택: 디렉터리만 고르도록 할 수도 있음</p>
      </li>
    </ul>
  </li>
  <li>
    <p>자주 쓰는 정적 메서드들 (PyQt 스타일로 예시 줄게)</p>
  </li>
</ol>

<p>파일 하나 열기:
     ```python
     fname, _ = QFileDialog.getOpenFileName(
         parent,
         "파일 열기",
         "",
         "이미지 파일 (<em>.png *.jpg *.bmp);;모든 파일 (</em>.*)"
     )</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> if fname:
     print("선택된 파일:", fname)
 ```
</code></pre></div></div>

<p>파일 여러 개 열기:
     ```python
     fnames, _ = QFileDialog.getOpenFileNames(
         parent,
         "여러 파일 열기",
         "",
         "텍스트 파일 (<em>.txt);;모든 파일 (</em>.*)"
     )</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> for f in fnames:
     print(f)
 ```
</code></pre></div></div>

<p>파일 저장:
     ```python
     save_name, _ = QFileDialog.getSaveFileName(
         parent,
         "파일 저장",
         "untitled.txt",
         "텍스트 파일 (<em>.txt);;모든 파일 (</em>.*)"
     )</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> if save_name:
     print("저장할 경로:", save_name)
 ```
</code></pre></div></div>

<p>폴더 선택:
     ```python
     dir_path = QFileDialog.getExistingDirectory(
         parent,
         "폴더 선택",
         ""
     )</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> if dir_path:
     print("선택된 폴더:", dir_path)
 ```
</code></pre></div></div>

<ol>
  <li>
    <p>필터(파일 형식) 문법</p>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">"설명 (*.확장자1 *.확장자2);;다른 설명 (*.다른확장자)"</code></p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">;;</code> 로 여러 그룹을 나누는 구조야.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>모달/비모달</p>

    <ul>
      <li>
        <p>위에처럼 <code class="language-plaintext highlighter-rouge">getOpenFileName</code> 같은 정적 메서드는 모달 다이얼로그를 띄우고, 사용자가 닫으면 바로 결과를 돌려줘.</p>
      </li>
      <li>
        <p>직접 <code class="language-plaintext highlighter-rouge">dlg = QFileDialog(parent)</code> 해서 만들어놓고 옵션 세팅하고, <code class="language-plaintext highlighter-rouge">dlg.exec()</code>나 <code class="language-plaintext highlighter-rouge">dlg.open()</code>으로 쓸 수도 있어.</p>
      </li>
    </ul>
  </li>
</ol>

<p>원하면 C++ 버전 코드로도 예시 같이 짜 줄 수 있어.</p>

<p class="chat--user">

소스코드도 알아?

</p>

<p>“소스코드”가 QFileDialog 내부 구현 얘기면 → Qt 소스는 공개돼 있지만, 여기서 그대로 긁어다 장문으로 보여줄 수는 없어.<br />
대신 “QFileDialog를 어떻게 쓰는 예제 소스코드”라면 마음껏 보여줄 수 있다. 그게 보통 사람들이 말하는 소스코드이기도 하고.</p>

<p>아래는 사용 예제들!</p>

<hr />

<h2 id="1-c--qt-widgets-예제">1. C++ / Qt Widgets 예제</h2>

<p>버튼 하나 있는 창에서 버튼 누르면 <code class="language-plaintext highlighter-rouge">QFileDialog</code> 띄워서 파일 하나 고르고, 선택된 파일 경로를 라벨에 표시하는 예제:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;QApplication&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;QWidget&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;QPushButton&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;QLabel&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;QVBoxLayout&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;QFileDialog&gt;</span><span class="cp">
</span>
<span class="k">class</span> <span class="nc">MainWindow</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="nl">public:</span>
    <span class="n">MainWindow</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="nb">nullptr</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">auto</span> <span class="o">*</span><span class="n">layout</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

        <span class="n">button</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s">"파일 선택"</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
        <span class="n">label</span>  <span class="o">=</span> <span class="k">new</span> <span class="n">QLabel</span><span class="p">(</span><span class="s">"아직 파일을 선택하지 않았습니다."</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>

        <span class="n">layout</span><span class="o">-&gt;</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button</span><span class="p">);</span>
        <span class="n">layout</span><span class="o">-&gt;</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">);</span>

        <span class="n">connect</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">QPushButton</span><span class="o">::</span><span class="n">clicked</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">MainWindow</span><span class="o">::</span><span class="n">onSelectFile</span><span class="p">);</span>
    <span class="p">}</span>

<span class="k">private</span> <span class="n">slots</span><span class="o">:</span>
    <span class="kt">void</span> <span class="nf">onSelectFile</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">QString</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">::</span><span class="n">getOpenFileName</span><span class="p">(</span>
            <span class="k">this</span><span class="p">,</span>
            <span class="s">"파일 열기"</span><span class="p">,</span>
            <span class="s">""</span><span class="p">,</span>
            <span class="s">"이미지 파일 (*.png *.jpg *.bmp);;모든 파일 (*.*)"</span>
        <span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">fileName</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">label</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="s">"선택한 파일: "</span> <span class="o">+</span> <span class="n">fileName</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">QPushButton</span> <span class="o">*</span><span class="n">button</span><span class="p">;</span>
    <span class="n">QLabel</span> <span class="o">*</span><span class="n">label</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">QApplication</span> <span class="n">app</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>

    <span class="n">MainWindow</span> <span class="n">w</span><span class="p">;</span>
    <span class="n">w</span><span class="p">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s">"QFileDialog 예제"</span><span class="p">);</span>
    <span class="n">w</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">150</span><span class="p">);</span>
    <span class="n">w</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>

    <span class="k">return</span> <span class="n">app</span><span class="p">.</span><span class="n">exec</span><span class="p">();</span>
<span class="p">}</span>

<span class="cp">#include</span> <span class="cpf">"main.moc"</span><span class="cp">
</span></code></pre></div></div>

<p>이 정도 구조면:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileDialog::getOpenFileName</code> 정적 메서드로 간단하게 파일 선택</p>
  </li>
  <li>
    <p>필터 문자열로 확장자 제한</p>
  </li>
  <li>
    <p>반환된 <code class="language-plaintext highlighter-rouge">QString</code>이 비어있지 않으면 라벨에 표시</p>
  </li>
</ul>

<p>딱 교과서적인 사용 패턴이야.</p>

<hr />

<h2 id="2-pyqt5--pyside6-예제-python">2. PyQt5 / PySide6 예제 (Python)</h2>

<p>비슷한 동작을 파이썬으로:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="n">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">QApplication</span><span class="p">,</span> <span class="n">QWidget</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span>
    <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QFileDialog</span>
<span class="p">)</span>
<span class="c1"># PySide6 쓰면 from PySide6.QtWidgets import ... 로 바꾸면 됨
</span>
<span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">super</span><span class="p">().</span><span class="nf">__init__</span><span class="p">()</span>

        <span class="n">self</span><span class="p">.</span><span class="nf">setWindowTitle</span><span class="p">(</span><span class="sh">"</span><span class="s">QFileDialog 예제</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">resize</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>

        <span class="n">layout</span> <span class="o">=</span> <span class="nc">QVBoxLayout</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>

        <span class="n">self</span><span class="p">.</span><span class="n">button</span> <span class="o">=</span> <span class="nc">QPushButton</span><span class="p">(</span><span class="sh">"</span><span class="s">파일 선택</span><span class="sh">"</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">label</span> <span class="o">=</span> <span class="nc">QLabel</span><span class="p">(</span><span class="sh">"</span><span class="s">아직 파일을 선택하지 않았습니다.</span><span class="sh">"</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span>

        <span class="n">layout</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">button</span><span class="p">)</span>
        <span class="n">layout</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">label</span><span class="p">)</span>

        <span class="n">self</span><span class="p">.</span><span class="n">button</span><span class="p">.</span><span class="n">clicked</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">on_select_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_select_file</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">file_name</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="p">.</span><span class="nf">getOpenFileName</span><span class="p">(</span>
            <span class="n">self</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">파일 열기</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">""</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">이미지 파일 (*.png *.jpg *.bmp);;모든 파일 (*.*)</span><span class="sh">"</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="nf">setText</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">선택한 파일: </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="nc">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="nc">MainWindow</span><span class="p">()</span>
    <span class="n">w</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
    <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="nf">exec</span><span class="p">())</span>
</code></pre></div></div>

<hr />

<h2 id="3-디렉터리-선택-예제-pyqt-기준">3. 디렉터리 선택 예제 (PyQt 기준)</h2>

<p>디렉터리만 고르는 간단 코드:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dir_path</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="p">.</span><span class="nf">getExistingDirectory</span><span class="p">(</span>
    <span class="n">parent</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">폴더 선택</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">""</span><span class="p">,</span>
    <span class="n">QFileDialog</span><span class="p">.</span><span class="n">ShowDirsOnly</span> <span class="o">|</span> <span class="n">QFileDialog</span><span class="p">.</span><span class="n">DontResolveSymlinks</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">dir_path</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">선택된 폴더:</span><span class="sh">"</span><span class="p">,</span> <span class="n">dir_path</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<p>만약 네가 궁금한 “소스코드”가<br />
“QFileDialog 안에서 플랫폼별로 어떻게 네이티브 파일 다이얼로그를 불러오는지” 같은 <strong>내부 구현</strong> 이라면, 그건 Qt 소스 트리에서 <code class="language-plaintext highlighter-rouge">src/widgets/dialogs/qfiledialog*</code> 쪽 C++ 파일들을 보는 식으로 파보는 영역이야.<br />
사용자 입장에선 위처럼 쓰는 예제 코드 정도면 대부분의 실전 상황은 커버된다.</p>

<p>다음 단계로는 <code class="language-plaintext highlighter-rouge">setFileMode</code>, <code class="language-plaintext highlighter-rouge">setNameFilters</code>, <code class="language-plaintext highlighter-rouge">setAcceptMode</code> 같은 옵션을 객체 방식으로 세팅하는 커스텀 다이얼로그 예제를 볼 만하지.</p>

<p class="chat--user">

난 내부 구현이 궁금해

</p>

<p>좋은 포인트에 꽂혔네. 내부 구현은 겉모습보다 훨씬 재밌다.</p>

<p>QFileDialog 내부 동작을 “대략 어떻게 생겼는지” 구조 위주로 풀어볼게. 실제 소스는 수천 줄이라 여기서 그대로 다 줄 수는 없고, 핵심 메커니즘을 해부하는 느낌으로.</p>

<hr />

<h2 id="1-큰-그림-껍데기-api--두-종류의-엔진">1. 큰 그림: “껍데기 API + 두 종류의 엔진”</h2>

<p>QFileDialog는 겉으로는 하나의 클래스지만, 안에서는 대략 두 가지 구현으로 갈라져 있어:</p>

<ol>
  <li>
    <p>플랫폼 네이티브 파일 다이얼로그</p>

    <ul>
      <li>
        <p>Windows: Win32 / COM 기반의 공용 파일 대화상자</p>
      </li>
      <li>
        <p>macOS: NSOpenPanel / NSSavePanel 계열</p>
      </li>
      <li>
        <p>일부 플랫폼의 네이티브 picker들</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Qt 위젯으로 만든 커스텀 파일 다이얼로그</p>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">QFileDialog</code> 위젯 자체 + <code class="language-plaintext highlighter-rouge">QFileSystemModel</code> + <code class="language-plaintext highlighter-rouge">QTreeView/QListView</code> 등</p>
      </li>
      <li>
        <p>옵션 또는 환경(플래그) 따라 이쪽을 사용</p>
      </li>
    </ul>
  </li>
</ol>

<p>기본값은 “가능하면 네이티브 다이얼로그를 사용”이고,<br />
<code class="language-plaintext highlighter-rouge">DontUseNativeDialog</code> 옵션이나 글로벌 앱 속성으로 강제로 Qt 위젯 기반 구현을 쓰게 할 수 있어. <a href="https://codebrowser.dev/qt6/qtbase/src/widgets/dialogs/qfiledialog.cpp.html?utm_source=chatgpt.com">Code Browser+1</a></p>

<p>그러니까, <code class="language-plaintext highlighter-rouge">getOpenFileName()</code> 같은 static 함수 한 번 부르면 내부에선:</p>

<ol>
  <li>
    <p>어떤 플랫폼인지, 옵션이 뭔지 보고</p>
  </li>
  <li>
    <p>“네이티브로 갈까? Qt 위젯으로 만들까?” 결정</p>
  </li>
  <li>
    <p>적절한 백엔드 구현을 생성해서 <code class="language-plaintext highlighter-rouge">exec()</code> 돌리고</p>
  </li>
  <li>
    <p>선택된 파일 리스트를 <code class="language-plaintext highlighter-rouge">QStringList</code>로 받아서 사용자한테 전달</p>
  </li>
</ol>

<p>이런 흐름이야.</p>

<hr />

<h2 id="2-클래스-구조-public--private-분리">2. 클래스 구조: public / private 분리</h2>

<p>Qt 소스 보면 <code class="language-plaintext highlighter-rouge">QFileDialog</code> 옆에 <code class="language-plaintext highlighter-rouge">QFileDialogPrivate</code>가 있어. 이게 진짜 뇌다. <a href="https://codebrowser.dev/qt6/qtbase/src/widgets/dialogs/qfiledialog.cpp.html?utm_source=chatgpt.com">Code Browser+1</a></p>

<p>대략 구조는:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">QFileDialog</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QDialog</span> <span class="p">{</span>
    <span class="n">Q_OBJECT</span>
<span class="nl">public:</span>
    <span class="c1">// public API들: setDirectory, setNameFilters, selectedFiles, ...</span>
<span class="nl">protected:</span>
    <span class="n">QFileDialog</span><span class="p">(</span><span class="n">QFileDialogPrivate</span> <span class="o">&amp;</span><span class="n">dd</span><span class="p">,</span> <span class="p">...);</span> <span class="c1">// d-pointer 패턴</span>
<span class="nl">private:</span>
    <span class="n">Q_DECLARE_PRIVATE</span><span class="p">(</span><span class="n">QFileDialog</span><span class="p">)</span>
    <span class="n">Q_PRIVATE_SLOT</span><span class="p">(</span><span class="n">d_func</span><span class="p">(),</span> <span class="kt">void</span> <span class="n">_q_currentChanged</span><span class="p">(</span><span class="k">const</span> <span class="n">QModelIndex</span> <span class="o">&amp;</span><span class="p">))</span>
    <span class="c1">// ... 등등</span>
<span class="p">};</span>
</code></pre></div></div>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">QFileDialogPrivate</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QDialogPrivate</span> <span class="p">{</span>
    <span class="n">Q_DECLARE_PUBLIC</span><span class="p">(</span><span class="n">QFileDialog</span><span class="p">)</span>
<span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="k">const</span> <span class="n">QString</span> <span class="o">&amp;</span><span class="n">dir</span><span class="p">,</span> <span class="k">const</span> <span class="n">QString</span> <span class="o">&amp;</span><span class="n">filter</span><span class="p">,</span> <span class="k">const</span> <span class="n">QString</span> <span class="o">&amp;</span><span class="n">caption</span><span class="p">);</span>
    <span class="kt">void</span> <span class="n">createWidgets</span><span class="p">();</span>
    <span class="kt">void</span> <span class="n">createMenuActions</span><span class="p">();</span>
    <span class="kt">void</span> <span class="n">createToolButtons</span><span class="p">();</span>
    <span class="c1">// 시그널/슬롯 핸들러</span>
    <span class="kt">void</span> <span class="n">_q_currentChanged</span><span class="p">(</span><span class="k">const</span> <span class="n">QModelIndex</span> <span class="o">&amp;</span><span class="n">index</span><span class="p">);</span>
    <span class="kt">void</span> <span class="n">_q_selectionChanged</span><span class="p">();</span>
    <span class="kt">void</span> <span class="n">_q_enterDirectory</span><span class="p">(</span><span class="k">const</span> <span class="n">QModelIndex</span> <span class="o">&amp;</span><span class="n">index</span><span class="p">);</span>
    <span class="kt">void</span> <span class="n">_q_goToDirectory</span><span class="p">(</span><span class="k">const</span> <span class="n">QString</span> <span class="o">&amp;</span><span class="n">path</span><span class="p">);</span>
    <span class="kt">void</span> <span class="n">_q_updateOkButton</span><span class="p">();</span>
    <span class="c1">// ...</span>
    <span class="n">QFileSystemModel</span> <span class="o">*</span><span class="n">model</span><span class="p">;</span>
    <span class="n">QAbstractProxyModel</span> <span class="o">*</span><span class="n">proxyModel</span><span class="p">;</span>
    <span class="n">QList</span><span class="o">&lt;</span><span class="n">QUrl</span><span class="o">&gt;</span> <span class="n">history</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">currentHistoryLocation</span><span class="p">;</span>
    <span class="c1">// UI 포인터들: listView, treeView, comboBox, buttonBox ...</span>
<span class="p">};</span>
</code></pre></div></div>

<p>요런 식으로:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileDialog</code>는 “외부에 보이는 껍데기 + 신호/슬롯 선언”</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileDialogPrivate</code>는 “실제 동작, 상태, UI 구성, 모델 관리”</p>
  </li>
</ul>

<p>Qt의 d-pointer 패턴(Q_D, Q_Q 매크로)로 둘이 얽혀 있어.</p>

<hr />

<h2 id="3-qt-위젯-기반-구현-쪽-로직">3. Qt 위젯 기반 구현 쪽 로직</h2>

<p>네이티브 다이얼로그가 아닌 경우, <code class="language-plaintext highlighter-rouge">QFileDialogPrivate::createWidgets()</code>에서 직접 위젯들을 만든다. <a href="https://dreamswork.github.io/qt4/classQFileDialogPrivate.html?utm_source=chatgpt.com">DreamSworK</a></p>

<p>대략적인 구성:</p>

<ol>
  <li>
    <p>모델</p>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">QFileSystemModel</code> 사용</p>
      </li>
      <li>
        <p>루트 디렉터리, 필터, 정렬 방식 등을 설정</p>
      </li>
      <li>
        <p>디렉터리/파일 리스트 관리</p>
      </li>
    </ul>
  </li>
  <li>
    <p>뷰</p>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">QTreeView</code> (디렉터리 트리)</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">QListView</code> (파일 리스트)</p>
      </li>
      <li>
        <p>둘 다 모델을 공유하거나 적절히 proxy를 씌움</p>
      </li>
    </ul>
  </li>
  <li>
    <p>상단 UI</p>

    <ul>
      <li>
        <p>주소 입력용 <code class="language-plaintext highlighter-rouge">QLineEdit</code> 또는 <code class="language-plaintext highlighter-rouge">QComboBox</code> (경로 표시/입력)</p>
      </li>
      <li>
        <p>뒤로/앞으로/위로 가기 버튼들 (history 관리)</p>
      </li>
    </ul>
  </li>
  <li>
    <p>하단 UI</p>

    <ul>
      <li>
        <p>파일 이름 입력 <code class="language-plaintext highlighter-rouge">QLineEdit</code></p>
      </li>
      <li>
        <p>파일 타입 필터 <code class="language-plaintext highlighter-rouge">QComboBox</code> (name filters)</p>
      </li>
      <li>
        <p>OK/Cancel 버튼 (QDialogButtonBox)</p>
      </li>
    </ul>
  </li>
</ol>

<p>그리고 각종 비공개 슬롯들(<code class="language-plaintext highlighter-rouge">_q_...</code>)이 시그널에 연결되어 있다: <a href="https://dreamswork.github.io/qt4/classQFileDialogPrivate.html?utm_source=chatgpt.com">DreamSworK</a></p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_q_currentChanged(const QModelIndex &amp;index)</code></p>

    <ul>
      <li>
        <p>리스트에서 현재 항목 바뀔 때 호출</p>
      </li>
      <li>
        <p>OK 버튼 활성/비활성 상태 갱신, <code class="language-plaintext highlighter-rouge">currentChanged()</code> 신호 발행</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_q_selectionChanged()</code></p>

    <ul>
      <li>
        <p>선택이 바뀔 때 호출</p>
      </li>
      <li>
        <p>선택된 파일 이름들을 하단 라인에 반영, OK 버튼 업데이트</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_q_enterDirectory(const QModelIndex &amp;index)</code></p>

    <ul>
      <li>
        <p>더블클릭/엔터 누를 때 호출</p>
      </li>
      <li>
        <p>디렉터리면 그 디렉터리로 들어가고</p>
      </li>
      <li>
        <p>파일이면 “선택 후 OK 처리” 같은 동작 준비</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_q_goToDirectory(const QString &amp;path)</code></p>

    <ul>
      <li>
        <p>경로 바뀌었을 때 실제 모델 루트 디렉터리 변경</p>
      </li>
      <li>
        <p>존재 여부 체크하고, 에러 시 메시지박스 띄우기도</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_q_pathChanged(const QString &amp;newPath)</code></p>

    <ul>
      <li>history 스택 관리, “뒤로 / 앞으로” 버튼 활성 상태 업데이트</li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_q_showContextMenu(const QPoint &amp;pos)</code></p>

    <ul>
      <li>우클릭 메뉴 생성 (삭제, 이름 변경, 숨김 파일 보기 등)</li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_q_deleteCurrent()</code>, <code class="language-plaintext highlighter-rouge">_q_renameCurrent()</code></p>

    <ul>
      <li>파일 삭제/이름 변경 로직. 모델이 readOnly면 막고, 아니면 <code class="language-plaintext highlighter-rouge">QFileSystemModel</code> 통해 변경</li>
    </ul>
  </li>
</ul>

<p>요런 내부 슬롯들 위에 public API가 앉아 있는 구조야:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setDirectory()</code> → d-&gt;model-&gt;setRootPath(…), 경로 UI 업데이트</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setNameFilters()</code> → d-&gt;model-&gt;setNameFilters(…), 필터 콤보 갱신</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">selectedFiles()</code> → 현재 선택된 <code class="language-plaintext highlighter-rouge">QModelIndex</code>들을 걸러서 파일 path 리스트 반환</p>
  </li>
</ul>

<hr />

<h2 id="4-네이티브-다이얼로그-경로">4. 네이티브 다이얼로그 경로</h2>

<p>네이티브 활용 시에는 위젯들을 거의 안 만든다. 그래서 문서에 이런 말이 있다: “네이티브 다이얼로그를 사용하는 경우에는 레이아웃/위젯 관련 접근자들이 null을 반환할 수 있다.” <a href="https://codebrowser.dev/qt6/qtbase/src/widgets/dialogs/qfiledialog.cpp.html?utm_source=chatgpt.com">Code Browser</a></p>

<p>흐름은 대략 이렇다:</p>

<ol>
  <li>static 함수 호출
    <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QString</span> <span class="n">QFileDialog</span><span class="o">::</span><span class="n">getOpenFileName</span><span class="p">(</span>
    <span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QString</span> <span class="o">&amp;</span><span class="n">caption</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QString</span> <span class="o">&amp;</span><span class="n">dir</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QString</span> <span class="o">&amp;</span><span class="n">filter</span><span class="p">,</span>
    <span class="n">QString</span> <span class="o">*</span><span class="n">selectedFilter</span><span class="p">,</span>
    <span class="n">Options</span> <span class="n">options</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 내부에서 helper 호출</span>
    <span class="c1">// 플랫폼별 native dialog helper에게 위임</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>플랫폼별 구현으로 위임</p>

    <ul>
      <li>
        <p>Windows: <code class="language-plaintext highlighter-rouge">IFileOpenDialog</code> / <code class="language-plaintext highlighter-rouge">GetOpenFileNameW</code> 계열 사용</p>
      </li>
      <li>
        <p>macOS: NSOpenPanel</p>
      </li>
      <li>
        <p>일부 Unix/플랫폼: Qt 위젯 기반 쓰거나, 적당한 native wrapper</p>
      </li>
    </ul>
  </li>
  <li>
    <p>옵션 변환</p>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">QFileDialog::ExistingFile</code>, <code class="language-plaintext highlighter-rouge">Directory</code>, <code class="language-plaintext highlighter-rouge">AcceptSave</code> 등 enum을<br />
각 플랫폼 호출에 맞게 flag 변환</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">DontResolveSymlinks</code>, <code class="language-plaintext highlighter-rouge">DontUseCustomDirectoryIcons</code> 같은 것도 여기서 처리</p>
      </li>
    </ul>
  </li>
  <li>네이티브 다이얼로그에서 얻은 경로 목록을 <code class="language-plaintext highlighter-rouge">QStringList</code>로 변환해 반환</li>
</ol>

<p>이 경우 내부의 <code class="language-plaintext highlighter-rouge">QFileDialogPrivate::createWidgets()</code>는 아예 호출되지 않거나 최소화된다.</p>

<hr />

<h2 id="5-파일-시스템-연동-모델뷰-관점에서-정리">5. 파일 시스템 연동: 모델/뷰 관점에서 정리</h2>

<p>Qt 위젯 구현일 때를 모델/뷰 관점에서 한 번 요약해보면:</p>

<ul>
  <li>
    <p>모델: <code class="language-plaintext highlighter-rouge">QFileSystemModel</code></p>

    <ul>
      <li>
        <p>실제 디스크의 디렉터리 구조를 비동기적으로 탐색</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">QDir::Filters</code>로 숨김 파일, 디렉터리만, 파일만 등의 필터 적용</p>
      </li>
      <li>
        <p>컬럼: 파일명, 크기, 타입, 수정일 등</p>
      </li>
    </ul>
  </li>
  <li>
    <p>proxy (선택적):</p>

    <ul>
      <li>정렬, 필터링, 사용자 정의 로직 넣을 수 있음</li>
    </ul>
  </li>
  <li>
    <p>뷰: <code class="language-plaintext highlighter-rouge">QTreeView</code> / <code class="language-plaintext highlighter-rouge">QListView</code></p>

    <ul>
      <li>
        <p>같은 모델을 서로 다른 방식으로 보여줌</p>
      </li>
      <li>
        <p>선택 모델 공유해서, 트리에서 선택하면 리스트도 바뀌는 식</p>
      </li>
    </ul>
  </li>
</ul>

<p>슬롯 <code class="language-plaintext highlighter-rouge">_q_rowsInserted(const QModelIndex &amp;parent)</code>를 보면, “루트에 처음 자식이 생기면 첫 항목을 선택한다” 같은 초기화 로직도 들어 있다. <a href="https://dreamswork.github.io/qt4/classQFileDialogPrivate.html?utm_source=chatgpt.com">DreamSworK</a></p>

<hr />

<h2 id="6-히스토리-뒤로가기앞으로가기">6. 히스토리, 뒤로가기/앞으로가기</h2>

<p>내부에 <code class="language-plaintext highlighter-rouge">currentHistory</code>, <code class="language-plaintext highlighter-rouge">currentHistoryLocation</code> 같은 멤버가 있고: <a href="https://dreamswork.github.io/qt4/classQFileDialogPrivate.html?utm_source=chatgpt.com">DreamSworK</a></p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_q_pathChanged()</code>에서:</p>

    <ul>
      <li>
        <p>새 path를 history 벡터에 push</p>
      </li>
      <li>
        <p>현재 인덱스 이동</p>
      </li>
      <li>
        <p>뒤/앞 버튼 enable / disable 처리</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_q_navigateBackward()</code>, <code class="language-plaintext highlighter-rouge">_q_navigateForward()</code>에서:</p>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">currentHistoryLocation</code> 조정</p>
      </li>
      <li>
        <p>해당 위치의 path로 <code class="language-plaintext highlighter-rouge">_q_goToDirectory()</code> 호출</p>
      </li>
    </ul>
  </li>
</ul>

<p>사실 브라우저 히스토리랑 거의 비슷한 구조야.</p>

<hr />

<h2 id="7-버튼ok-처리">7. 버튼/OK 처리</h2>

<p>OK 버튼은 “선택한 파일이 유효한가?”에 따라 활성/비활성 상태가 계속 업데이트된다:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_q_updateOkButton()</code>에서:</p>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">fileMode</code>가 <code class="language-plaintext highlighter-rouge">ExistingFile</code>이면 실제 존재 여부, 읽기 가능 여부 체크</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">AnyFile</code>이면 그냥 허용</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">Directory</code> 모드면 디렉터리인지 확인</p>
      </li>
      <li>
        <p>선택이 없으면 비활성화</p>
      </li>
    </ul>
  </li>
</ul>

<p>사용자가 OK를 누르면:</p>

<ol>
  <li>
    <p>현재 선택된 <code class="language-plaintext highlighter-rouge">QModelIndex</code> 리스트를 가져오고</p>
  </li>
  <li>
    <p>모드에 맞게 필터링해서 <code class="language-plaintext highlighter-rouge">QStringList</code>로 저장</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">accept()</code> 호출해서 다이얼로그 닫음</p>
  </li>
  <li>
    <p>호출한 쪽에서 <code class="language-plaintext highlighter-rouge">selectedFiles()</code>로 최종 결과를 가져감</p>
  </li>
</ol>

<hr />

<h2 id="8-실제-소스가-궁금하다면-보는-위치">8. 실제 소스가 궁금하다면 보는 위치</h2>

<p>Qt 6 기준: <code class="language-plaintext highlighter-rouge">qtbase/src/widgets/dialogs/qfiledialog.cpp</code>에 구현이 대부분 들어 있다. <a href="https://codebrowser.dev/qt6/qtbase/src/widgets/dialogs/qfiledialog.cpp.html?utm_source=chatgpt.com">Code Browser+1</a></p>

<p>그 안에서:</p>

<ul>
  <li>
    <p>public API 구현</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileDialogPrivate</code> 정의</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_q_...</code> 슬롯들 정의</p>
  </li>
  <li>
    <p>네이티브/위젯 구현 분기</p>
  </li>
  <li>
    <p>각종 enum, 옵션 처리</p>
  </li>
</ul>

<p>를 전부 볼 수 있다.</p>

<hr />

<p>요약하자면:</p>

<ul>
  <li>
    <p>QFileDialog는 “플랫폼 네이티브 다이얼로그를 감싸는 래퍼” + “Qt 위젯으로 만든 파일 탐색기” 두 개의 얼굴을 가진다.</p>
  </li>
  <li>
    <p>d-pointer 패턴으로 public/내부 구현이 분리돼 있고, 내부는 <code class="language-plaintext highlighter-rouge">QFileDialogPrivate</code>가 <code class="language-plaintext highlighter-rouge">QFileSystemModel</code> 기반의 모델/뷰 구조를 돌리고 있다.</p>
  </li>
  <li>
    <p>각종 <code class="language-plaintext highlighter-rouge">_q_...</code> 슬롯들이 파일 선택, 디렉터리 이동, 히스토리, 숨김 파일 표시 등 UI 행동을 구체적으로 처리한다.</p>
  </li>
</ul>

<p>이 정도면 내부 구조의 뼈대는 꽤 잡혔을 거야.<br />
이제부터는 “소스 열고 한 줄씩 뜯어보는 고행 모드”로 들어가면, 자신만의 커스텀 파일 다이얼로그 위젯을 만드는 데에도 꽤 도움 된다.</p>

<p class="chat--user">

QFileSystemModel 은 어떻게 되어있어?

</p>

<p>QFileSystemModel은 한마디로 “비동기 파일 시스템 트리 모델”이야.<br />
QFileDialog에서 썼던 그 친구 맞고, 내부는 꽤 묵직하게 구성돼 있다.</p>

<p>큰 흐름부터 → 점점 디테일로 파고들어볼게.</p>

<hr />

<h2 id="1-역할-정리부터">1. 역할 정리부터</h2>

<p>QFileSystemModel은 <code class="language-plaintext highlighter-rouge">QAbstractItemModel</code>을 상속한 트리형 모델이고, 로컬 파일 시스템(디렉터리/파일)을 보여주기 위한 표준 구현이야.<br />
파일/폴더 이름, 아이콘, 크기, 타입, 수정 시간 같은 데이터를 제공하고, 필요하면 rename/mkdir/remove 같은 조작도 해 준다. <a href="https://doc.qt.io/qt-6/qfilesystemmodel.html?utm_source=chatgpt.com">Qt 문서+1</a></p>

<p>QDirModel의 “느리고 동기적인” 방식 대신, 이쪽은 비동기 스캔 + 캐시 구조라 큰 트리에도 버티도록 만들어져 있음.</p>

<hr />

<h2 id="2-클래스-구조-모델--프라이빗--노드-트리">2. 클래스 구조: 모델 + 프라이빗 + 노드 트리</h2>

<p>겉으로는:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">QFileSystemModel</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QAbstractItemModel</span> <span class="p">{</span>
    <span class="n">Q_OBJECT</span>
<span class="nl">public:</span>
    <span class="c1">// setRootPath, filePath, isDir, data, index, parent, ...</span>
<span class="p">};</span>
</code></pre></div></div>

<p>하지만 실제 뇌는 <code class="language-plaintext highlighter-rouge">QFileSystemModelPrivate</code>와 그 안의 <code class="language-plaintext highlighter-rouge">QFileSystemNode</code> 트리다. <a href="https://dreamswork.github.io/qt4/classQFileSystemModel.html?utm_source=chatgpt.com">DreamSworK</a></p>

<p>대략 구조는 이런 느낌:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">QFileSystemModelPrivate</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QAbstractItemModelPrivate</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="k">struct</span> <span class="nc">QFileSystemNode</span> <span class="p">{</span>
        <span class="n">QFileInfo</span> <span class="n">info</span><span class="p">;</span>                      <span class="c1">// 경로, 이름, 사이즈, 시간, 퍼미션 등</span>
        <span class="n">QHash</span><span class="o">&lt;</span><span class="n">QString</span><span class="p">,</span> <span class="n">QFileSystemNode</span><span class="o">*&gt;</span> <span class="n">children</span><span class="p">;</span> <span class="c1">// 이름 -&gt; 자식 노드</span>
        <span class="n">QList</span><span class="o">&lt;</span><span class="n">QFileSystemNode</span><span class="o">*&gt;</span> <span class="n">visibleChildren</span><span class="p">;</span>   <span class="c1">// 필터 통과한 애들</span>
        <span class="n">QFileSystemNode</span> <span class="o">*</span><span class="n">parent</span><span class="p">;</span>
        <span class="kt">bool</span> <span class="n">populatedChildren</span><span class="p">;</span>
        <span class="c1">// isDir(), permissions() 등 헬퍼들</span>
    <span class="p">};</span>

    <span class="n">QFileSystemNode</span> <span class="o">*</span><span class="n">root</span><span class="p">;</span>          <span class="c1">// 루트 노드</span>
    <span class="n">QFileInfoGatherer</span> <span class="n">fileInfoGatherer</span><span class="p">;</span>
    <span class="n">QList</span><span class="o">&lt;</span><span class="n">QRegExp</span><span class="o">&gt;</span> <span class="n">nameFilters</span><span class="p">;</span>
    <span class="n">QDir</span><span class="o">::</span><span class="n">Filters</span> <span class="n">filters</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">readOnly</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">forceSort</span><span class="p">;</span>
    <span class="c1">// 정렬, 캐시, persistent index 관리 등등...</span>
<span class="p">};</span>
</code></pre></div></div>

<p>즉:</p>

<ul>
  <li>
    <p>파일 시스템 = <code class="language-plaintext highlighter-rouge">QFileSystemNode</code> 트리</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QModelIndex</code> ↔ <code class="language-plaintext highlighter-rouge">QFileSystemNode*</code> 를 서로 매핑</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">row</code>, <code class="language-plaintext highlighter-rouge">column</code>, <code class="language-plaintext highlighter-rouge">parent/child</code> 계산은 전부 이 노드 트리를 기반으로 돌림 <a href="https://dreamswork.github.io/qt4/classQFileSystemModel.html?utm_source=chatgpt.com">DreamSworK</a></p>
  </li>
</ul>

<hr />

<h2 id="3-비동기-스캔-qfileinfogatherer">3. 비동기 스캔: QFileInfoGatherer</h2>

<p>핵심 포인트는 “디렉터리 목록과 파일 정보 수집을 별도 스레드에서 돌린다”는 거야. <a href="https://dreamswork.github.io/qt4/qfilesystemmodel_8cpp_source.html?utm_source=chatgpt.com">DreamSworK+1</a></p>

<p>대략 흐름:</p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setRootPath("/some/path")</code> 호출</p>

    <ul>
      <li>private 쪽에서 루트 노드를 만들고, 그 경로를 <code class="language-plaintext highlighter-rouge">fileInfoGatherer</code>에게 넘김.</li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileInfoGatherer</code>는 별도 스레드에서 <code class="language-plaintext highlighter-rouge">QDir</code>를 돌리면서</p>

    <ul>
      <li>하위 파일 목록, 파일 정보(QFileInfo)를 쭉 읽어옴.</li>
    </ul>
  </li>
  <li>
    <p>읽어온 결과를 신호로 <code class="language-plaintext highlighter-rouge">QFileSystemModel</code>에 보냄</p>

    <ul>
      <li>“이 디렉터리 밑에 이런 애들 있음” 같은 리스트.</li>
    </ul>
  </li>
  <li>
    <p>모델 쪽에서:</p>

    <ul>
      <li>
        <p>해당 디렉터리 노드의 <code class="language-plaintext highlighter-rouge">children</code>/<code class="language-plaintext highlighter-rouge">visibleChildren</code> 갱신</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">beginInsertRows</code> / <code class="language-plaintext highlighter-rouge">endInsertRows</code> 호출</p>
      </li>
      <li>
        <p>필요하면 <code class="language-plaintext highlighter-rouge">dataChanged</code>/<code class="language-plaintext highlighter-rouge">layoutChanged</code>도 발행</p>
      </li>
    </ul>
  </li>
</ol>

<p>그래서:</p>

<ul>
  <li>
    <p>UI 스레드는 “일단 비어 있는 트리/리스트”를 먼저 그리고</p>
  </li>
  <li>
    <p>백그라운드에서 디렉터리 스캔이 진행되면서 항목이 차츰차츰 나타나는 구조.</p>
  </li>
</ul>

<p>큰 디렉터리 열어도 UI가 버벅이지 않는 이유가 이거다.</p>

<hr />

<h2 id="4-재정의하는-핵심-가상-함수들">4. 재정의하는 핵심 가상 함수들</h2>

<p>QFileSystemModel은 <code class="language-plaintext highlighter-rouge">QAbstractItemModel</code>의 필수 함수들을 전부 구현해. <a href="https://dreamswork.github.io/qt4/classQFileSystemModel.html?utm_source=chatgpt.com">DreamSworK+1</a></p>

<p>대표적으로:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">QFileSystemModel</span><span class="o">::</span><span class="n">rowCount</span><span class="p">(</span><span class="k">const</span> <span class="n">QModelIndex</span> <span class="o">&amp;</span><span class="n">parent</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
    <span class="n">Q_D</span><span class="p">(</span><span class="k">const</span> <span class="n">QFileSystemModel</span><span class="p">);</span>
    <span class="k">auto</span> <span class="o">*</span><span class="n">node</span> <span class="o">=</span> <span class="n">d</span><span class="o">-&gt;</span><span class="n">node</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">node</span><span class="o">-&gt;</span><span class="n">visibleChildren</span><span class="p">.</span><span class="n">count</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">QFileSystemModel</span><span class="o">::</span><span class="n">columnCount</span><span class="p">(</span><span class="k">const</span> <span class="n">QModelIndex</span> <span class="o">&amp;</span><span class="n">parent</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
    <span class="n">Q_UNUSED</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">4</span><span class="p">;</span> <span class="c1">// Name, Size, Type, Date Modified</span>
<span class="p">}</span>

<span class="n">QModelIndex</span> <span class="n">QFileSystemModel</span><span class="o">::</span><span class="n">index</span><span class="p">(</span><span class="kt">int</span> <span class="n">row</span><span class="p">,</span> <span class="kt">int</span> <span class="n">column</span><span class="p">,</span> <span class="k">const</span> <span class="n">QModelIndex</span> <span class="o">&amp;</span><span class="n">parent</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
    <span class="n">Q_D</span><span class="p">(</span><span class="k">const</span> <span class="n">QFileSystemModel</span><span class="p">);</span>
    <span class="k">auto</span> <span class="o">*</span><span class="n">parentNode</span> <span class="o">=</span> <span class="n">d</span><span class="o">-&gt;</span><span class="n">node</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
    <span class="k">auto</span> <span class="o">*</span><span class="n">child</span> <span class="o">=</span> <span class="n">parentNode</span><span class="o">-&gt;</span><span class="n">visibleChildren</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="n">row</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">createIndex</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">child</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">QModelIndex</span> <span class="n">QFileSystemModel</span><span class="o">::</span><span class="n">parent</span><span class="p">(</span><span class="k">const</span> <span class="n">QModelIndex</span> <span class="o">&amp;</span><span class="n">child</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
    <span class="n">Q_D</span><span class="p">(</span><span class="k">const</span> <span class="n">QFileSystemModel</span><span class="p">);</span>
    <span class="k">auto</span> <span class="o">*</span><span class="n">node</span> <span class="o">=</span> <span class="n">d</span><span class="o">-&gt;</span><span class="n">node</span><span class="p">(</span><span class="n">child</span><span class="p">);</span>
    <span class="k">auto</span> <span class="o">*</span><span class="n">parentNode</span> <span class="o">=</span> <span class="n">node</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">parentNode</span> <span class="o">||</span> <span class="n">parentNode</span> <span class="o">==</span> <span class="n">d</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">QModelIndex</span><span class="p">();</span>
    <span class="kt">int</span> <span class="n">row</span> <span class="o">=</span> <span class="n">parentNode</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">visibleChildren</span><span class="p">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">parentNode</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">createIndex</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>실제 구현은 더 방어적이지만, 구조는 이런 느낌이지.</p>

<hr />

<h2 id="5-data--역할--컬럼">5. data() / 역할 / 컬럼</h2>

<p>컬럼 4개는 대략 이렇게 쓰인다: <a href="https://doc.qt.io/qt-6/qfilesystemmodel.html?utm_source=chatgpt.com">Qt 문서+1</a></p>

<ol>
  <li>
    <p>0: 파일 이름</p>
  </li>
  <li>
    <p>1: 파일 크기</p>
  </li>
  <li>
    <p>2: 타입(폴더/텍스트 파일/그 외)</p>
  </li>
  <li>
    <p>3: 수정 시간</p>
  </li>
</ol>

<p><code class="language-plaintext highlighter-rouge">data(const QModelIndex &amp;index, int role)</code>에서:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Qt::DisplayRole</code></p>

    <ul>
      <li>
        <p>column 0 → <code class="language-plaintext highlighter-rouge">fileName</code></p>
      </li>
      <li>
        <p>column 1 → 사람이 읽기 좋은 사이즈(“1.2 KB” 이런 식)</p>
      </li>
      <li>
        <p>column 2 → 타입 문자열</p>
      </li>
      <li>
        <p>column 3 → 날짜/시간 포맷팅</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Qt::DecorationRole</code></p>

    <ul>
      <li>column 0 → <code class="language-plaintext highlighter-rouge">QFileIconProvider</code>로부터 가져온 아이콘 (폴더, 드라이브, 파일 등)</li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Qt::CheckStateRole</code>, <code class="language-plaintext highlighter-rouge">Qt::ToolTipRole</code> 등은 상황에 따라 제공</p>
  </li>
</ul>

<p>아이콘은 <code class="language-plaintext highlighter-rouge">QFileIconProvider</code>를 통해 OS 스타일에 맞춰 가져온다. <a href="https://doc.qt.io/qt-6/qfilesystemmodel.html?utm_source=chatgpt.com">Qt 문서+1</a></p>

<hr />

<h2 id="6-필터링-qdirfilters--namefilters">6. 필터링: QDir::Filters + nameFilters</h2>

<p>두 가지 레벨의 필터가 있어: <a href="https://dreamswork.github.io/qt4/classQFileSystemModel.html?utm_source=chatgpt.com">DreamSworK</a></p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setFilter(QDir::Filters filters)</code></p>

    <ul>
      <li>
        <p>파일/디렉터리/숨김파일 등 포함 여부</p>
      </li>
      <li>
        <p>예: <code class="language-plaintext highlighter-rouge">QDir::AllDirs | QDir::NoDotAndDotDot | QDir::Files</code></p>
      </li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setNameFilters(QStringList patterns)</code></p>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">"*.cpp"</code>, <code class="language-plaintext highlighter-rouge">"*.h"</code> 같은 패턴들</p>
      </li>
      <li>
        <p>내부에서는 <code class="language-plaintext highlighter-rouge">QRegExp</code> 리스트로 바꿔서 저장해두고, 노드 추가 시 <code class="language-plaintext highlighter-rouge">passNameFilters()</code>로 체크</p>
      </li>
    </ul>
  </li>
</ul>

<p>필터가 바뀌면:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">forceSort = true</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">delayedSort()</code> 호출해서</p>

    <ul>
      <li>
        <p>visibleChildren 재구성</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">layoutChanged()</code> 같은 신호로 뷰 갱신</p>
      </li>
    </ul>
  </li>
</ul>

<p>그래서 필터를 막 바꿔도 모델/뷰 구조는 유지되면서 “보이는 애들만” 갈아끼우는 방식.</p>

<hr />

<h2 id="7-읽기-전용--쓰기-가능-모드">7. 읽기 전용 / 쓰기 가능 모드</h2>

<p>기본은 read-only 모델이지만, <code class="language-plaintext highlighter-rouge">setReadOnly(false)</code>를 주면 직접 파일 시스템을 수정할 수도 있다. <a href="https://doc.qt.io/qt-6/qfilesystemmodel.html?utm_source=chatgpt.com">Qt 문서+1</a></p>

<p>예:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setData()</code>에서 이름 변경 (DisplayRole, column 0 변경)</p>

    <ul>
      <li>
        <p>내부적으로 <code class="language-plaintext highlighter-rouge">QFile::rename</code> 사용</p>
      </li>
      <li>
        <p>성공하면 노드의 QFileInfo 갱신 + persistent index 재맵핑</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">mkdir(const QModelIndex &amp;parent, const QString &amp;name)</code></p>

    <ul>
      <li>QDir로 디렉터리 생성 → 새 노드 추가</li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">remove(const QModelIndex &amp;index)</code></p>

    <ul>
      <li>파일/디렉터리 삭제 시도 → 성공 시 노드를 children에서 제거</li>
    </ul>
  </li>
</ul>

<p>이 때 readOnly 플래그는 이렇게 쓰여:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">bool</span> <span class="n">QFileSystemModel</span><span class="o">::</span><span class="n">isReadOnly</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
    <span class="n">Q_D</span><span class="p">(</span><span class="k">const</span> <span class="n">QFileSystemModel</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">d</span><span class="o">-&gt;</span><span class="n">readOnly</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">flags()</code>에서도, 쓰기 가능 + 디렉터리일 때 <code class="language-plaintext highlighter-rouge">Qt::ItemIsDropEnabled</code>를 켜서 드래그앤드롭으로 이동 같은 걸 허용한다. <a href="https://dreamswork.github.io/qt4/classQFileSystemModel.html?utm_source=chatgpt.com">DreamSworK+1</a></p>

<hr />

<h2 id="8-파일-변화-감시-watcher">8. 파일 변화 감시 (watcher)</h2>

<p>QFileSystemModel은 파일이 추가/삭제/이동될 때 자동으로 뷰가 따라가도록 만들어져 있어.</p>

<p>그걸 담당하는 게 아까 봤던 <code class="language-plaintext highlighter-rouge">QFileInfoGatherer</code> 쪽인데, 내부적으로 <code class="language-plaintext highlighter-rouge">QFileSystemWatcher</code>를 써서 디렉터리 변화를 감시하고, 바뀌면 다시 디렉터리 내용을 읽어와서 노드 트리를 업데이트한다. <a href="https://doc.qt.io/qt-6/qfilesystemmodel.html?utm_source=chatgpt.com">Qt 문서+1</a></p>

<p>그래서 외부에서 파일을 하나 생성해도, 트리/리스트 뷰가 “툭” 하고 새 줄이 생기는 것처럼 보이는 거지.</p>

<hr />

<h2 id="9-뷰와의-연결-방식">9. 뷰와의 연결 방식</h2>

<p>모델/뷰 세계에서 QFileSystemModel은 그냥 트리 모델일 뿐이라, QTreeView / QListView / QColumnView 등에 그대로 물린다. <a href="https://doc.qt.io/qt-6/model-view-programming.html?utm_source=chatgpt.com">Qt 문서+1</a></p>

<p>주로 쓰는 API는:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QFileSystemModel</span> <span class="o">*</span><span class="n">model</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QFileSystemModel</span><span class="p">;</span>
<span class="n">model</span><span class="o">-&gt;</span><span class="n">setRootPath</span><span class="p">(</span><span class="s">"C:/"</span><span class="p">);</span>  <span class="c1">// 여기서부터 스캔 시작</span>

<span class="n">treeView</span><span class="o">-&gt;</span><span class="n">setModel</span><span class="p">(</span><span class="n">model</span><span class="p">);</span>
<span class="n">treeView</span><span class="o">-&gt;</span><span class="n">setRootIndex</span><span class="p">(</span><span class="n">model</span><span class="o">-&gt;</span><span class="n">index</span><span class="p">(</span><span class="s">"C:/Users"</span><span class="p">));</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">index(const QString &amp;path)</code>는 내부적으로 <code class="language-plaintext highlighter-rouge">d-&gt;node(path)</code>를 찾고, 그걸로 <code class="language-plaintext highlighter-rouge">createIndex</code>를 만들어 주는 유틸리티. <a href="https://dreamswork.github.io/qt4/classQFileSystemModel.html?utm_source=chatgpt.com">DreamSworK</a></p>

<hr />

<p>정리하자면:</p>

<ul>
  <li>
    <p>QFileSystemModel은 <code class="language-plaintext highlighter-rouge">QFileSystemNode</code> 트리 + 비동기 <code class="language-plaintext highlighter-rouge">QFileInfoGatherer</code> + <code class="language-plaintext highlighter-rouge">QFileSystemModelPrivate</code>가 합쳐진 꽤 복잡한 모델이고,</p>
  </li>
  <li>
    <p>파일 시스템을 “트리 모델”로 래핑해서 뷰(QTreeView, QListView 등)에 꽂으면 바로 파일 탐색기가 되는 구조야.</p>
  </li>
  <li>
    <p>필터링, 정렬, rename/mkdir/remove, 파일 변경 감시까지 다 들어 있어서, 기본 파일 브라우저는 이걸로 거의 다 구현 가능하다.</p>
  </li>
</ul>

<p>여기까지 이해하면, 직접 <code class="language-plaintext highlighter-rouge">QAbstractItemModel</code>을 상속해서 “나만의 가짜 파일 시스템”을 만드는 쪽으로도 사고를 확장해볼 수 있어. 실제 디스크 대신 DB나 네트워크 리소스를 물려도 되고. 모델/뷰의 맛있는 활용 영역이지.</p>

<p class="chat--user">

os.path.isfile 이랑 유사한 함수를 호출하는데가 어디야? /user/j 를 다이얼로그에 입력하면 컴퓨터가 멈춰버려 네트워크 드라이브라 그런가

</p>

<p>좋은 지점 찝었네. “os.path.isfile 같은 거를 어디서 부르냐 + 왜 /user/j 치면 멈추냐”를 정확히 짚어보자.</p>

<p>요약 먼저:</p>

<ul>
  <li>
    <p>Qt 쪽에서 <code class="language-plaintext highlighter-rouge">os.path.isfile</code>에 가장 가까운 건 <code class="language-plaintext highlighter-rouge">QFileInfo::isFile()</code>, <code class="language-plaintext highlighter-rouge">QFileInfo::isDir()</code>, <code class="language-plaintext highlighter-rouge">QFileInfo::exists()</code> 같은 애들이고,</p>
  </li>
  <li>
    <p>그 위에 <code class="language-plaintext highlighter-rouge">QDir::exists()</code>, <code class="language-plaintext highlighter-rouge">QFileSystemModel::isDir()</code> 같은 래퍼들이 올라가 있고,</p>
  </li>
  <li>
    <p>이게 내부적으로는 결국 OS의 <code class="language-plaintext highlighter-rouge">stat()</code>/<code class="language-plaintext highlighter-rouge">lstat()</code> 같은 시스템 콜이라, 느린 네트워크 경로에서 그냥 뻗어버릴 수 있어. <a href="https://doc.qt.io/qt-6/qfileinfo.html?utm_source=chatgpt.com">Qt 문서+1</a></p>
  </li>
</ul>

<p>그리고 <code class="language-plaintext highlighter-rouge">/user/j</code> 입력했을 때 멈추는 건 “Qt가 이상해서”라기보다, “그 경로에 접근하는 OS 호출이 네트워크 드라이브 때문에 오래 걸려서”일 가능성이 매우 높다.</p>

<hr />

<h2 id="1-실제로-어디서-isfile-같은-걸-부르냐">1. 실제로 어디서 <code class="language-plaintext highlighter-rouge">isfile</code> 같은 걸 부르냐</h2>

<p>QFileDialog + QFileSystemModel 조합일 때 중요한 포인트들만 찍어볼게.</p>

<h3 id="1-디렉터리-이동할-때-_q_gotodirectory">1) 디렉터리 이동할 때: <code class="language-plaintext highlighter-rouge">_q_goToDirectory</code></h3>

<p>파일 다이얼로그 상단의 콤보박스/경로 입력으로 디렉터리 이동할 때 호출되는 내부 슬롯이 있어:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">QFileDialogPrivate::_q_goToDirectory(const QString &amp;path)</code> <a href="https://codebrowser.dev/qt5/qtbase/src/widgets/dialogs/qfiledialog.cpp.html">Code Browser+1</a></li>
</ul>

<p>이 함수 안에서:</p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QDir dir(path2);</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">dir.exists()</code>로 “이 디렉터리가 실제로 존재하는가?” 확인</p>
  </li>
</ol>

<p>여기서 <code class="language-plaintext highlighter-rouge">QDir::exists()</code>는 내부적으로 그 경로에 대해 <code class="language-plaintext highlighter-rouge">QFileInfo</code>를 만들고, OS의 파일 시스템 통계를 가져오는 호출(유닉스면 <code class="language-plaintext highlighter-rouge">stat()</code>, 윈도면 <code class="language-plaintext highlighter-rouge">GetFileAttributesW</code> 같은 것)을 한다고 보면 된다. <a href="https://doc.qt.io/qt-6/qfileinfo.html?utm_source=chatgpt.com">Qt 문서+1</a></p>

<p>즉, 네가 <code class="language-plaintext highlighter-rouge">/user/j</code> 치고 엔터를 치면:</p>

<ul>
  <li>
    <p>QFileDialog → <code class="language-plaintext highlighter-rouge">_q_goToDirectory("/user/j")</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_q_goToDirectory</code> → <code class="language-plaintext highlighter-rouge">QDir("/user/j").exists()</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QDir::exists()</code> → OS에게 “/user/j 정보 좀 줘”</p>
  </li>
  <li>
    <p>이때 /user가 느린 NFS/SMB/자동 마운트 포인트면, 여기서 뻗어버리는 것.</p>
  </li>
</ul>

<h3 id="2-항목-더블클릭엔터-_q_enterdirectory">2) 항목 더블클릭/엔터: <code class="language-plaintext highlighter-rouge">_q_enterDirectory</code></h3>

<p>리스트/트리에서 디렉터리 더블클릭할 때:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileDialogPrivate::_q_enterDirectory(const QModelIndex &amp;index)</code>가 호출되고,</p>
  </li>
  <li>
    <p>이 안에서 <code class="language-plaintext highlighter-rouge">QFileSystemModel::isDir(index)</code> 호출해서 “이게 폴더냐 파일이냐”를 구분한다. <a href="https://codebrowser.dev/qt5/qtbase/src/widgets/dialogs/qfiledialog.cpp.html">Code Browser+1</a></p>
  </li>
</ul>

<p><code class="language-plaintext highlighter-rouge">QFileSystemModel::isDir()</code>은:</p>

<ul>
  <li>
    <p>내부 노드에 캐시된 <code class="language-plaintext highlighter-rouge">QFileInfo</code>가 있으면 그걸 쓰고,</p>
  </li>
  <li>
    <p>없으면 새로 <code class="language-plaintext highlighter-rouge">QFileInfo</code>를 만들면서 OS 파일 정보를 가져온다.</p>
  </li>
</ul>

<p>이것도 결국 <code class="language-plaintext highlighter-rouge">stat()</code> 계열.</p>

<h3 id="3-ok-버튼-활성화-체크-_q_updateokbutton">3) OK 버튼 활성화 체크: <code class="language-plaintext highlighter-rouge">_q_updateOkButton</code></h3>

<p>사용자가 파일 이름을 텍스트로 입력할 때, OK 버튼 활성/비활성 상태를 계속 업데이트하는 <code class="language-plaintext highlighter-rouge">_q_updateOkButton</code>도 중요하다. 이 함수 안에서:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileSystemModel::index(path)</code>로 인덱스 찾고,</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">isDir()</code>인지, 파일인지, 존재하는지 등을 확인해서 “지금 상태에서 OK를 눌러도 되는지” 계산한다. <a href="https://codebrowser.dev/qt5/qtbase/src/widgets/dialogs/qfiledialog.cpp.html">Code Browser</a></p>
  </li>
</ul>

<p>여기서도 결국 <code class="language-plaintext highlighter-rouge">QFileInfo</code>/<code class="language-plaintext highlighter-rouge">QDir</code> 기반의 존재 여부 체크 호출이 들어간다.</p>

<h3 id="4-자동완성컴플리터-qfscompleter">4) 자동완성/컴플리터: QFSCompleter</h3>

<p>QFileDialog는 파일 이름 입력란에 파일 시스템 자동완성(<code class="language-plaintext highlighter-rouge">QFSCompleter</code>)을 붙인다. 위에서 봤듯이: <a href="https://codebrowser.dev/qt5/qtbase/src/widgets/dialogs/qfiledialog.cpp.html">Code Browser+1</a></p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFSCompleter</code>는 내부에 <code class="language-plaintext highlighter-rouge">QFileSystemModel</code>을 쓰고,</p>
  </li>
  <li>
    <p>사용자가 <code class="language-plaintext highlighter-rouge">/user/j</code> 같은 걸 타이핑하면,</p>
  </li>
  <li>
    <p>해당 경로에 대해 모델이 인덱스를 만들고, 디렉터리 내용을 읽어서 후보를 찾으려고 한다.</p>
  </li>
</ul>

<p>결론: 타이핑만 해도 백그라운드에서 “이 경로가 존재하냐, 디렉터리냐, 안에 뭐 있냐”를 쉴 새 없이 때린다.</p>

<hr />

<h2 id="2-왜-userj-에서-컴퓨터가-멈추는가-네트워크-드라이브-의심">2. 왜 /user/j 에서 컴퓨터가 멈추는가 (네트워크 드라이브 의심)</h2>

<p>정황상 이런 시나리오가 매우 그럴듯하다:</p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">/user</code>가 로컬이 아니라, 자동 마운트되는 네트워크 경로 (NFS, SMB, autofs 등)다.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">/user/j</code>에 접근하려고 OS가 마운트/네트워크 연결을 시도한다.</p>
  </li>
  <li>
    <p>네트워크가 죽어있거나 응답이 느려서 <code class="language-plaintext highlighter-rouge">stat("/user/j")</code> 같은 호출이 수 초~수십 초 동안 블록된다.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileDialog::_q_goToDirectory</code>는 이 <code class="language-plaintext highlighter-rouge">QDir::exists()</code> 호출을 UI 스레드에서 그냥 호출한다.</p>
  </li>
  <li>
    <p>그 순간 UI 스레드가 OS 콜에 붙잡혀서 “앱이 멈춘 것처럼” 보인다.</p>
  </li>
</ol>

<p>QFileSystemModel 자체는 파일 스캔을 별도 스레드에서 돌리지만,<br />
“디렉터리가 존재하는지 한번 체크” 같은 부분은 종종 UI 스레드에서 동기적으로 호출된다. 네트워크가 느리면 그냥 같이 끌려들어감. <a href="https://stackoverflow.com/questions/15661696/qfilesystemmodel-freezes-ui?utm_source=chatgpt.com">Stack Overflow+1</a></p>

<p>파이썬으로 치면:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">isdir</span><span class="p">(</span><span class="sh">"</span><span class="s">/user/j</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># 이 한 줄이 NFS 때문에 10초 동안 리턴이 안 됨
</span></code></pre></div></div>

<p>이걸 메인 스레드에서 GUI 돌리는 와중에 직접 호출하는 느낌이다.</p>

<hr />

<h2 id="3-어떻게-피할-수-있나-현실적인-우회책">3. 어떻게 피할 수 있나 (현실적인 우회책)</h2>

<p>Qt 소스 자체를 바꾸지 않는 선에서 쓸 수 있는 카드들 몇 개만 정리해볼게.</p>

<ol>
  <li>다이얼로그 시작 위치를 안전한 곳으로 고정</li>
</ol>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileDialog</code> 생성할 때 <code class="language-plaintext highlighter-rouge">QDir::homePath()</code> 같은 로컬 경로를 initial directory로 주고,</p>
  </li>
  <li>
    <p>문제의 <code class="language-plaintext highlighter-rouge">/user/j</code> 같은 경로는 아예 안 건드리게 UX를 설계하는 방법.</p>
  </li>
  <li>
    <p>예:</p>
    <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QFileDialog</span> <span class="nf">dlg</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s">"Open"</span><span class="p">,</span> <span class="n">QDir</span><span class="o">::</span><span class="n">homePath</span><span class="p">());</span>
</code></pre></div>    </div>
  </li>
</ul>

<ol>
  <li>네이티브/비네이티브 다이얼로그 바꿔보기</li>
</ol>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">DontUseNativeDialog</code> 옵션을 켜거나 끄면,</p>

    <ul>
      <li>OS 네이티브 다이얼로그 vs Qt 위젯 기반 다이얼로그를 바꿀 수 있다. <a href="https://codebrowser.dev/qt5/qtbase/src/widgets/dialogs/qfiledialog.cpp.html">Code Browser</a></li>
    </ul>
  </li>
  <li>
    <p>둘 다 결국 <code class="language-plaintext highlighter-rouge">stat()</code>는 부르지만, 네이티브 쪽이 네트워크 드라이브 처리에 좀 더 관대한 경우도 있고, 반대로 더 느릴 수도 있다. 두 쪽 다 테스트해볼 가치 있음.</p>
  </li>
</ul>

<ol>
  <li>커스텀 파일 다이얼로그 만들기</li>
</ol>

<ul>
  <li>
    <p>아주 빡세게 튜닝하려면 <code class="language-plaintext highlighter-rouge">QFileDialog</code> 안 쓰고:</p>

    <ul>
      <li>
        <p>직접 <code class="language-plaintext highlighter-rouge">QFileSystemModel</code> 붙인 <code class="language-plaintext highlighter-rouge">QTreeView/QListView</code> 기반 위젯을 만들고,</p>
      </li>
      <li>
        <p>“경로 존재 여부 체크”를 직접 제어할 수 있다.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>예를 들면:</p>

    <ul>
      <li>
        <p>텍스트 입력 시 실시간으로 <code class="language-plaintext highlighter-rouge">QDir::exists()</code> 안 부르고,</p>
      </li>
      <li>
        <p>유저가 엔터를 눌렀을 때만 별도 스레드에서 경로 체크 후, 성공하면 UI에 반영.</p>
      </li>
    </ul>
  </li>
</ul>

<ol>
  <li>네트워크 쪽 문제라면 OS 레벨에서 해결</li>
</ol>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">/user</code>가 죽은 NFS 마운트라면, 애플리케이션 레벨에서 할 수 있는 건 사실 거의 없다.</p>
  </li>
  <li>
    <p>마운트 옵션에 <code class="language-plaintext highlighter-rouge">soft</code>/타임아웃 조정, 또는 해당 네트워크 드라이브를 빼버리는 식으로 해결하는 게 근본적.</p>
  </li>
</ul>

<hr />

<h2 id="4-ospathisfile-비슷한-함수를-정리하면">4. “os.path.isfile 비슷한 함수”를 정리하면</h2>

<p>Qt 쪽에서 파일/디렉터리 존재 여부를 확인하는 주요 포인트는 이런 애들:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileInfo::exists()</code> / <code class="language-plaintext highlighter-rouge">QFileInfo::isFile()</code> / <code class="language-plaintext highlighter-rouge">QFileInfo::isDir()</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QDir::exists()</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileSystemModel::isDir()</code> / <code class="language-plaintext highlighter-rouge">fileInfo()</code></p>
  </li>
  <li>
    <p>QFileDialog 내부에서 이들을 쓰는 <code class="language-plaintext highlighter-rouge">_q_goToDirectory</code>, <code class="language-plaintext highlighter-rouge">_q_enterDirectory</code>, <code class="language-plaintext highlighter-rouge">_q_updateOkButton</code> 등 슬롯들 <a href="https://codebrowser.dev/qt5/qtbase/src/widgets/dialogs/qfiledialog.cpp.html">Code Browser+1</a></p>
  </li>
</ul>

<p>이 애들이 전부 “os.path.isfile 같은 일을 한다”고 보면 된다.<br />
그리고 <code class="language-plaintext highlighter-rouge">/user/j</code>에서 멈추는 건 이 함수들이 네트워크/자동 마운트 때문에 블록되는 구조라고 생각하면 이해가 딱 맞게 떨어진다.</p>

<p>파일 다이얼로그가 “느린 경로에 잘못된 stat 한 번 던졌다가 UI가 같이 죽는 상황”은, OS + 네트워크 + GUI가 합작해서 만든 고전적인 함정이라, 디버깅할 땐 <code class="language-plaintext highlighter-rouge">strace</code>/<code class="language-plaintext highlighter-rouge">Process Monitor</code> 같은 걸로 실제 어떤 system call에서 붙잡히는지 보는 것도 꽤 도움 된다.</p>

<p class="chat--user">

그런데 소스를 보니 QFileSystemModel이랑 QCompleter랑 같이 쓸 수 있던데 원리가 뭐야? 둘이 어떤 방식으로 소통하는지 전혀 이해가 안돼

</p>

<p>좋은 데 꽂혔다. 여기 이해하면 “Qt 모델/뷰/컴플리터 삼각관계”를 거의 깨우친 셈이야.</p>

<p>질문 요약하면:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileSystemModel</code>이랑 <code class="language-plaintext highlighter-rouge">QCompleter</code>를 같이 쓸 수 있다는데</p>
  </li>
  <li>
    <p>둘이 도대체 어떻게 붙어 있는지 / 누가 누구한테 뭘 물어보는지 감이 안 온다</p>
  </li>
</ul>

<p>그래서 구조를 단계별로 풀어볼게.</p>

<hr />

<h2 id="1-기본-그림-qcompleter는-모델-소비자">1. 기본 그림: QCompleter는 “모델 소비자”</h2>

<p>핵심 아이디어 하나만 먼저 박아두자:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QCompleter</code>는 <strong>직접 데이터를 들고 있지 않고</strong> ,</p>
  </li>
  <li>
    <p>“아무 <code class="language-plaintext highlighter-rouge">QAbstractItemModel</code>이나 받아서 거기서 자동완성 후보를 뽑아 쓰는 객체”야.</p>
  </li>
</ul>

<p>즉:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QFileSystemModel</span> <span class="o">*</span><span class="n">model</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QFileSystemModel</span><span class="p">;</span>
<span class="n">model</span><span class="o">-&gt;</span><span class="n">setRootPath</span><span class="p">(</span><span class="s">"/"</span><span class="p">);</span>

<span class="n">QCompleter</span> <span class="o">*</span><span class="n">completer</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">QCompleter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">parent</span><span class="p">);</span>
<span class="n">lineEdit</span><span class="o">-&gt;</span><span class="n">setCompleter</span><span class="p">(</span><span class="n">completer</span><span class="p">);</span>
</code></pre></div></div>

<p>이렇게 하면:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileSystemModel</code>은 평소처럼 “파일 트리”를 제공하고</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QCompleter</code>는 “모델을 탐색하면서 ‘지금 텍스트에 맞는 아이템’을 골라주는 역할”만 한다.</p>
  </li>
</ul>

<p>그래서 소통 방향은 아주 단순하게 말하면:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QCompleter</code> → <code class="language-plaintext highlighter-rouge">QFileSystemModel</code>에게 계속 <code class="language-plaintext highlighter-rouge">data()</code>, <code class="language-plaintext highlighter-rouge">index()</code>, <code class="language-plaintext highlighter-rouge">rowCount()</code>, <code class="language-plaintext highlighter-rouge">parent()</code> 등을 호출해가며 후보를 찾는다.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileSystemModel</code>은 그냥 “평소처럼 모델을 구현했을 뿐”. “나 지금 컴플리터랑 대화 중이야”라는 특별한 인식은 없다.</p>
  </li>
</ul>

<p>QCompleter 입장에서 보면 “QFileSystemModel이냐 QStandardItemModel이냐”는 관심 없고, 그저 <code class="language-plaintext highlighter-rouge">QAbstractItemModel</code>일 뿐이다.</p>

<hr />

<h2 id="2-qcompleter-내부에서-벌어지는-일-간단-버전">2. QCompleter 내부에서 벌어지는 일 간단 버전</h2>

<p>텍스트 입력 흐름을 머릿속에서 재생해보자.</p>

<ol>
  <li>
    <p>사용자가 <code class="language-plaintext highlighter-rouge">lineEdit</code>에 뭔가를 타이핑한다.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QLineEdit</code>는 <code class="language-plaintext highlighter-rouge">textEdited(QString)</code> 같은 시그널을 낸다.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QCompleter</code>가 이 신호에 연결돼 있어서 <code class="language-plaintext highlighter-rouge">setCompletionPrefix(prefix)</code> 비슷한 처리를 한다고 생각하면 된다.</p>
  </li>
  <li>
    <p>QCompleter는 “지금 prefix로 시작하는 모델 아이템”을 찾기 위해,</p>

    <ul>
      <li>
        <p>내부적으로 <code class="language-plaintext highlighter-rouge">QModelIndex</code>들을 쭉 훑거나,</p>
      </li>
      <li>
        <p>특정 column만 보고 <code class="language-plaintext highlighter-rouge">data(index, Qt::DisplayRole)</code>를 읽는다.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>걸러진 애들로 팝업 리스트(작은 리스트뷰)를 만들어 보여준다.</p>
  </li>
</ol>

<p>즉, QCompleter는:</p>

<ul>
  <li>
    <p>“prefix를 기준으로 모델 아이템 필터링 + 결과를 팝업으로 보여주기” 역할</p>
  </li>
  <li>
    <p>모델은 그냥 “데이터 창고”</p>
  </li>
</ul>

<p>이 구조 덕에, <code class="language-plaintext highlighter-rouge">QFileSystemModel</code>처럼 복잡한 모델도, <code class="language-plaintext highlighter-rouge">QCompleter</code> 한 방에 “파일 경로 자동완성기”로 바뀐다.</p>

<hr />

<h2 id="3-그럼-qfilesystemmodel이랑-붙으면-어떤-식으로-보일까">3. 그럼 QFileSystemModel이랑 붙으면 어떤 식으로 보일까?</h2>

<p>보통 파일 경로 자동완성은 이렇게 쓰게 돼:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">auto</span> <span class="o">*</span><span class="n">model</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QFileSystemModel</span><span class="p">;</span>
<span class="n">model</span><span class="o">-&gt;</span><span class="n">setRootPath</span><span class="p">(</span><span class="n">QDir</span><span class="o">::</span><span class="n">rootPath</span><span class="p">());</span>  <span class="c1">// "/" 혹은 "C:/"</span>

<span class="k">auto</span> <span class="o">*</span><span class="n">completer</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">QCompleter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="c1">// 경로처럼 보이게 설정 ("/usr", "/usr/local" 같은 느낌)</span>
<span class="n">completer</span><span class="o">-&gt;</span><span class="n">setCompletionMode</span><span class="p">(</span><span class="n">QCompleter</span><span class="o">::</span><span class="n">PopupCompletion</span><span class="p">);</span>
<span class="n">completer</span><span class="o">-&gt;</span><span class="n">setCaseSensitivity</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">CaseInsensitive</span><span class="p">);</span>
<span class="n">completer</span><span class="o">-&gt;</span><span class="n">setFilterMode</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">MatchContains</span><span class="p">);</span> <span class="c1">// 또는 StartsWith</span>

<span class="n">lineEdit</span><span class="o">-&gt;</span><span class="n">setCompleter</span><span class="p">(</span><span class="n">completer</span><span class="p">);</span>
</code></pre></div></div>

<p>그러면:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileSystemModel</code>이 디스크의 디렉터리/파일 목록을 비동기로 채워 넣고</p>
  </li>
  <li>
    <p>QCompleter는 사용자가 <code class="language-plaintext highlighter-rouge">"/usr"</code> 치기 시작할 때마다:</p>

    <ul>
      <li>
        <p>모델에서 <code class="language-plaintext highlighter-rouge">"/"</code> 밑 자식들 <code class="language-plaintext highlighter-rouge">/usr</code>, <code class="language-plaintext highlighter-rouge">/opt</code>, <code class="language-plaintext highlighter-rouge">/home</code> … 같은 애들을 보고</p>
      </li>
      <li>
        <p>prefix(예: <code class="language-plaintext highlighter-rouge">/u</code>)에 맞는 것만 골라서 팝업에 올린다.</p>
      </li>
    </ul>
  </li>
</ul>

<p>사실 이게 QFileDialog 안에서 쓰이는 <code class="language-plaintext highlighter-rouge">QFSCompleter</code>의 정체랑도 비슷해.<br />
<code class="language-plaintext highlighter-rouge">QFSCompleter</code>는 “QFileSystemModel을 내장해서 경로 완성을 해주는 QCompleter 서브클래스” 정도로 상상하면 된다.</p>

<hr />

<h2 id="4-구체적으로-누가-어떤-함수를-호출하냐">4. 구체적으로 누가 어떤 함수를 호출하냐</h2>

<p>조금 더 “호출 관계” 느낌으로 써보면:</p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QCompleter::setModel(QAbstractItemModel *model)</code></p>

    <ul>
      <li>내부에 모델 포인터를 저장하고, 필요하면 시그널(<code class="language-plaintext highlighter-rouge">modelReset</code>, <code class="language-plaintext highlighter-rouge">rowsInserted</code> 등)에 연결한다.</li>
    </ul>
  </li>
  <li>
    <p>사용자가 글자를 입력할 때마다</p>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">QCompleter::setCompletionPrefix(const QString &amp;prefix)</code>가 불리고,</p>
      </li>
      <li>
        <p>이 함수가 <code class="language-plaintext highlighter-rouge">updateCompletionModel()</code> 같은 내부 함수로 넘어간다고 치자.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">updateCompletionModel()</code>에서는:</p>

    <ul>
      <li>
        <p>모델 전체 또는 특정 서브트리에 대해</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">rowCount</code>, <code class="language-plaintext highlighter-rouge">index</code>, <code class="language-plaintext highlighter-rouge">data(index, completionRole)</code> 등을 호출한다.</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">data(..., role)</code>에서 QFileSystemModel은 파일 이름을 돌려준다.</p>
      </li>
      <li>
        <p>이 문자열이 prefix와 매칭되는지를 <code class="language-plaintext highlighter-rouge">Qt::MatchFlags</code> 규칙에 따라 검사.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>매칭된 인덱스들을 QCompleter 안의 “보이는 목록”으로 채운다.</p>

    <ul>
      <li>
        <p>팝업이 필요하면, 내부적으로 작은 <code class="language-plaintext highlighter-rouge">QAbstractItemView</code> (보통 QListView)를 써서 <code class="language-plaintext highlighter-rouge">setModel()</code> 해준다.</p>
      </li>
      <li>
        <p>이때 QCompleter는 “원본 모델에서 이 인덱스, 팝업 모델에서는 이 줄” 이런 매핑을 관리한다.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>사용자가 팝업에서 하나 선택하면:</p>

    <ul>
      <li>
        <p>QCompleter는 그 인덱스에 해당하는 문자열(<code class="language-plaintext highlighter-rouge">data(index, completionRole)</code>)을 가져와서</p>
      </li>
      <li>
        <p>원래 <code class="language-plaintext highlighter-rouge">QLineEdit</code>의 text를 그걸로 바꾼다.</p>
      </li>
    </ul>
  </li>
</ol>

<p>여기 어디에도 “QFileSystemModel 전용 API”는 없다.<br />
전부 “QAbstractItemModel 표준 메서드”만 호출한다는 게 포인트다.</p>

<hr />

<h2 id="5-파일-경로처럼-완성되게-만드는-트릭들">5. 파일 경로처럼 완성되게 만드는 트릭들</h2>

<p>“파일 이름만” 자동완성하면 재미없고, 보통은 <code class="language-plaintext highlighter-rouge">"C:/Users/Jo"</code> 같은 전체 경로를 자동완성하고 싶잖아?</p>

<p>이때 보통은:</p>

<ol>
  <li>
    <p>QCompleter의 <strong>completionColumn</strong> 을 파일 이름 컬럼에 맞춰 놓고</p>
  </li>
  <li>
    <p>텍스트를 조작해서 “디렉터리 부분 + 마지막 토큰”으로 쪼갠다.</p>
  </li>
</ol>

<p>예를 들면:</p>

<ul>
  <li>
    <p>사용자가 <code class="language-plaintext highlighter-rouge">"C:/Users/Jo"</code>를 입력한다.</p>
  </li>
  <li>
    <p>코드에서 이걸 <code class="language-plaintext highlighter-rouge">"dir = C:/Users"</code>, <code class="language-plaintext highlighter-rouge">"last = Jo"</code>로 나눈다.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileSystemModel::index(dir)</code>로 그 디렉터리의 인덱스를 찾는다.</p>
  </li>
  <li>
    <p>QCompleter에게 “이 디렉터리 인덱스를 root로 삼아라”라고 알려준다.</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">completer-&gt;setRootIndex(model-&gt;index(dir));</code></li>
    </ul>
  </li>
  <li>
    <p>그 상태에서 prefix를 <code class="language-plaintext highlighter-rouge">"Jo"</code>로 주면,</p>

    <ul>
      <li>
        <p>QCompleter는 <code class="language-plaintext highlighter-rouge">C:/Users</code> 밑의 자식(John, Josh, etc)을 찾는다.</p>
      </li>
      <li>
        <p>선택하면 <code class="language-plaintext highlighter-rouge">"C:/Users/John"</code> 같은 완성된 문자열을 다시 합쳐서 lineEdit에 넣어준다.</p>
      </li>
    </ul>
  </li>
</ul>

<p>이런 식으로 “경로 처리 로직”은 대부분 QCompleter보다 <strong>외부에서</strong> 짜고, QCompleter는 그냥 “지금 디렉터리의 아이템 중에 prefix로 시작하는 거 찾아줘” 역할만 맡긴다.</p>

<p>QFileDialog 안의 <code class="language-plaintext highlighter-rouge">QFSCompleter</code>도 이런 패턴을 더 복잡하게 확장해서:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">/user</code>를 입력하면 <code class="language-plaintext highlighter-rouge">/user/</code>로 맞추고</p>
  </li>
  <li>
    <p>디렉터리와 파일을 상황에 따라 다르게 보여주고</p>
  </li>
  <li>
    <p>이름 필터/숨김 파일 처리 등을 곁들여서 동작한다.</p>
  </li>
</ul>

<hr />

<h2 id="6-요약-둘이-무슨-사적인-프로토콜-쓰는-거-아님">6. 요약: 둘이 무슨 사적인 프로토콜 쓰는 거 아님</h2>

<p>정리하면:</p>

<ul>
  <li>
    <p>QCompleter는 그냥 “모델을 탐색하는 소비자 역할”을 하는 객체</p>
  </li>
  <li>
    <p>QFileSystemModel은 “파일 시스템 트리를 제공하는 모델”</p>
  </li>
  <li>
    <p>둘의 소통은 <code class="language-plaintext highlighter-rouge">QAbstractItemModel</code>이 정해준 메서드들</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">rowCount</code>, <code class="language-plaintext highlighter-rouge">index</code>, <code class="language-plaintext highlighter-rouge">parent</code>, <code class="language-plaintext highlighter-rouge">data</code> 등등</li>
    </ul>
  </li>
  <li>
    <p>특별한 “QFileSystemModel 전용 훅” 같은 건 없고,</p>

    <ul>
      <li>
        <p>파일 시스템에 특화된 건 전부 QFileSystemModel 내부에서 <code class="language-plaintext highlighter-rouge">QFileInfo</code>, <code class="language-plaintext highlighter-rouge">QDir</code>로 처리</p>
      </li>
      <li>
        <p>QCompleter는 그냥 “문자열”만 본다.</p>
      </li>
    </ul>
  </li>
</ul>

<p>그래서 원리를 한 줄로 말하면:</p>

<p>경로 자동완성 = “QFileSystemModel이 제공하는 트리를 QCompleter가 필터링해서 보여주는 것”</p>

<p>이 패턴을 이해하면, 나중에 “DB기반 자동완성”, “네트워크 리소스 자동완성” 같은 것도 똑같이 구현할 수 있다. 모델만 갈아끼우고, QCompleter는 그대로 재활용하는 식으로.</p>

<p class="chat--user">

구체적으로 QModelIndex들을 쭉 훑는다는게 무슨 말이야

</p>

<p>QCompleter가 “QModelIndex들을 훑는다”는 말을 들으면, 마치 트리 전체를 완전히 DFS로 도는 느낌처럼 상상할 수도 있는데, 실제로는 <strong>그보다 단순하면서도 상황에 따라 꽤 잦은 호출이 일어나는 구조</strong> 다.<br />
구조 자체는 어렵지 않은데, Qt가 이걸 꽤 은근하게 자동으로 돌리기 때문에 감이 잘 안 오는 것뿐이야.</p>

<p>차근차근, 실제 내부에서 어떤 일이 벌어지는지를 <strong>눈에 보이게</strong> 만들어볼게.</p>

<hr />

<h1 id="1-qcompleter는-모델을-탐색할-능력만-가진-객체다">1. QCompleter는 모델을 “탐색할 능력만 가진 객체”다</h1>

<p>QCompleter는 <strong>모델의 데이터를 직접 저장하지 않는다.</strong><br />
대신, 자동완성 후보를 찾을 때마다 <strong>모델한테 직접 물어본다.</strong></p>

<p>모델이 어떤 종류든 상관없다.<br />
QCompleter는 딱 세 가지 정도만 알고 싶어 한다:</p>

<ul>
  <li>
    <p>rowCount(여기 몇 줄 있어?)</p>
  </li>
  <li>
    <p>index(i번째 줄의 모델 인덱스 좀 줄래?)</p>
  </li>
  <li>
    <p>data(index) (그 모델 인덱스의 문자열 뭐야?)</p>
  </li>
</ul>

<p>그리고 필요하면 parent(), columnCount() 등을 부른다.</p>

<p>즉, QCompleter는 자신이 가진 prefix(사용자가 입력한 문자열)를 가지고:</p>

<p>이 아이템이 prefix와 맞나?<br />
그럼 후보 목록에 넣자.</p>

<p>이걸 반복하는 구조.</p>

<hr />

<h1 id="2-훑는다는-것을-구체화해보자">2. “훑는다는 것”을 구체화해보자</h1>

<p>예를 들어, 모델이 이런 구조라고 하자:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>폴더<span class="o">)</span>  /home
  <span class="o">(</span>파일<span class="o">)</span> a.txt
  <span class="o">(</span>파일<span class="o">)</span> apple.png
  <span class="o">(</span>파일<span class="o">)</span> notes.docx
</code></pre></div></div>

<p>그리고 사용자가 lineEdit에 <code class="language-plaintext highlighter-rouge">"a"</code>라고 입력했다.</p>

<p>QCompleter는 사용자가 입력할 때마다 이렇게 움직인다:</p>

<h3 id="1-일단-현재-rootindex-밑에-있는-row들을-알아낸다">1) 일단 “현재 rootIndex” 밑에 있는 row들을 알아낸다</h3>

<p>보통 경로 자동완성에서는 rootIndex가 “현재 보고 있는 디렉터리”를 뜻한다.</p>

<p>QCompleter 내부 과정(개념적 의사 코드):</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">auto</span> <span class="n">root</span> <span class="o">=</span> <span class="n">completer</span><span class="o">-&gt;</span><span class="n">rootIndex</span><span class="p">();</span>  <span class="c1">// 예: /home 디렉터리 인덱스</span>

<span class="kt">int</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">model</span><span class="o">-&gt;</span><span class="n">rowCount</span><span class="p">(</span><span class="n">root</span><span class="p">);</span>    <span class="c1">// 예: 3개 (a.txt, apple.png, notes.docx)</span>
</code></pre></div></div>

<h3 id="2-0부터-rows-1까지-반복하면서-index를-만든다">2) 0부터 rows-1까지 반복하면서 index를 만든다</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">rows</span><span class="p">;</span> <span class="o">++</span><span class="n">r</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">QModelIndex</span> <span class="n">child</span> <span class="o">=</span> <span class="n">model</span><span class="o">-&gt;</span><span class="n">index</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">completionColumn</span><span class="p">,</span> <span class="n">root</span><span class="p">);</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>completionColumn은 보통 “이름이 들어 있는 column 0”.</p>

<h3 id="3-각-인덱스의-data를-읽는다">3) 각 인덱스의 data()를 읽는다</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QString</span> <span class="n">text</span> <span class="o">=</span> <span class="n">model</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">DisplayRole</span><span class="p">).</span><span class="n">toString</span><span class="p">();</span>
</code></pre></div></div>

<p>QFileSystemModel이면 여기서 파일 이름이 온다.</p>

<h3 id="4-prefix와-비교한다">4) prefix와 비교한다</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="n">text</span><span class="p">.</span><span class="n">startsWith</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">caseSensitivity</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">addToCompletionList</span><span class="p">(</span><span class="n">text</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>이 전체 과정이 바로 “QModelIndex들 훑기”다.</p>

<p><strong>그냥 rowCount()로 개수를 알아내고, row마다 index() 부르고, data()를 읽고, prefix와 비교하는 반복문.</strong></p>

<p>딱 이거다.</p>

<hr />

<h1 id="3-트리-전체를-훑는-것이-아니다">3. “트리 전체를 훑는 것”이 아니다</h1>

<p>많은 사람이 오해하는 부분.</p>

<p>QCompleter는 <strong>트리 전체를 자동으로 DFS/BFS 같은 걸 돌지 않는다.</strong></p>

<ul>
  <li>기본 QCompleter는 “한 레벨”만 훑는다.<br />
즉, rootIndex의 자식들만 본다.</li>
</ul>

<p>파일 경로 완성처럼 디렉터리가 중요한 경우:</p>

<ul>
  <li>프로그래머가 입력 문자열에서 디렉터리 부분을 분해해서<br />
rootIndex를 원하는 디렉터리에 직접 세팅한다.</li>
</ul>

<p>예:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">completer</span><span class="o">-&gt;</span><span class="n">setRootIndex</span><span class="p">(</span><span class="n">model</span><span class="o">-&gt;</span><span class="n">index</span><span class="p">(</span><span class="s">"/home"</span><span class="p">));</span>
<span class="n">completer</span><span class="o">-&gt;</span><span class="n">setCompletionPrefix</span><span class="p">(</span><span class="s">"a"</span><span class="p">);</span>
</code></pre></div></div>

<p>이렇게 해주면 QCompleter는 <strong>/home 밑의 자식들만</strong> 훑는 것.</p>

<p>트리를 재귀적으로 전부 뒤지는 일은 없다.</p>

<hr />

<h1 id="4-qcompleter가-정말-호출하는-함수들-정확하게">4. QCompleter가 정말 호출하는 함수들 (정확하게)</h1>

<p>QCompleter는 자동완성 탐색 중 이런 모델 함수를 실제로 부른다:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">rowCount(parentIndex)</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">index(row, column, parentIndex)</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">data(index, completionRole)</code></p>
  </li>
  <li>
    <p>(필요하면) <code class="language-plaintext highlighter-rouge">parent(index)</code></p>
  </li>
  <li>
    <p>(필요하면) <code class="language-plaintext highlighter-rouge">model-&gt;match(...)</code><br />
이건 일부 구현에서 문자열 찾는 데 쓰인다.</p>
  </li>
</ul>

<p>두 객체 사이의 소통은 <strong>전부 이 표준 함수들로만</strong> 이루어진다.<br />
QFileSystemModel은 아무 특별한 콜백도 제공하지 않는다.</p>

<hr />

<h1 id="5-qfilesystemmodel이-자동완성에서-잘-돌아가는-이유">5. QFileSystemModel이 자동완성에서 잘 돌아가는 이유</h1>

<p>QFileSystemModel은 모델/뷰 규약을 아주 충실히 구현한 모델이다.</p>

<ul>
  <li>
    <p>index(row, column, parent) → 디스크의 파일/디렉터리 정보</p>
  </li>
  <li>
    <p>data(index) → 파일 이름, 아이콘, 타입 등</p>
  </li>
  <li>
    <p>rowCount(parent) → 그 디렉터리 안의 파일 개수</p>
  </li>
  <li>
    <p>parent(index) → 상위 디렉터리 인덱스</p>
  </li>
</ul>

<p>즉, <strong>QCompleter가 모델에게 요구하는 모든 정보가 이미 제공되고 있다.</strong></p>

<p>그래서 QCompleter 입장에서는:</p>

<p>“얘가 파일 시스템인지 텍스트 목록인지 전혀 상관없다.<br />
난 그냥 모델을 탐색할 뿐.”</p>

<p>이 상태가 된다.</p>

<hr />

<h1 id="6-실제-슬롯시그널-기반의-연동은-거의-없다">6. 실제 슬롯/시그널 기반의 연동은 거의 없다</h1>

<p>중요한 사실:</p>

<ul>
  <li>
    <p>QCompleter와 QFileSystemModel 사이에는 “특별한 연결”이 없다.</p>
  </li>
  <li>
    <p>시그널/슬롯로 직접 통신하지 않는다.</p>
  </li>
  <li>
    <p>QCompleter는 모델의 변화를 감지하기 위해 새로운 row가 생기면<br />
modelReset(), rowsInserted(), rowsRemoved() 같은 것만 받는다.</p>
  </li>
  <li>
    <p>이것도 모든 모델이 따라야 하는 기본 규약이다.</p>
  </li>
</ul>

<p>즉, 특별한 협력 개발이 아니라 <strong>Qt 모델/뷰 패턴이 가진 보편적 구조</strong> 안에서 서로 협력할 뿐이다.</p>

<hr />

<h1 id="7-직관적-비유">7. 직관적 비유</h1>

<p>QFileSystemModel을 “커다란 책”이라고 생각하고,<br />
QCompleter를 “사서”라고 생각해보자.</p>

<ul>
  <li>
    <p>사서는 책 안의 글자를 직접 가지지 않는다.</p>
  </li>
  <li>
    <p>책이 어떤 구조인지 몰라도 된다.</p>
  </li>
  <li>
    <p>단지 “이 챕터의 페이지들을 하나씩 보여줘”라고 요청하고,</p>
  </li>
  <li>
    <p>그 페이지에 prefix가 들어 있으면 목록에 추가한다.</p>
  </li>
</ul>

<p>이게 “QModelIndex를 훑는다”는 말의 실제 의미다.</p>

<hr />

<h1 id="다음-단계로-생각할-만한-지점">다음 단계로 생각할 만한 지점</h1>

<p>지금 이해한 구조를 바탕으로,<br />
왜 네트워크 드라이브(NFS/SMB/AutoFS)에서 컴플리터가 멈출 때가 있는지,<br />
왜 model-&gt;data() 한 번이 stat()을 부를 수 있는지가<br />
이제 자연스럽게 연결될 거다.</p>

<p>원하면 “경로 자동완성에서 QFileSystemModel이 네트워크 드라이브 때문에 얼어붙을 때 우회하는 방법”도 자세히 파헤쳐 줄게.</p>

<p class="chat--user">

QCompleter를 안 쓰고 QFileSystemModel을 직접 사용하며 파일 뒤지는 예시 만들어 줄래? PySide6로

</p>

<p>좋지, 이번엔 <code class="language-plaintext highlighter-rouge">QCompleter</code> 싹 빼고 <code class="language-plaintext highlighter-rouge">QFileSystemModel</code>만 써서<br />
“디렉터리 하나를 통째로 뒤져서 파일 이름으로 검색”하는 예제를 만들어볼게.<br />
(PySide6 기준)</p>

<p>구조는 이런 식이다:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileSystemModel</code>에 루트 디렉터리 하나 세팅</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">검색어</code> 입력하고 버튼 누르면</p>
  </li>
  <li>
    <p>모델을 직접 재귀적으로 돌면서(=QModelIndex들을 훑으면서)</p>
  </li>
  <li>
    <p>파일 이름에 검색어가 들어가는 애들을 찾아 리스트에 표시</p>
  </li>
</ul>

<hr />

<h2 id="전체-예제-코드-pyside6">전체 예제 코드 (PySide6)</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="n">PySide6.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">QApplication</span><span class="p">,</span> <span class="n">QWidget</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span>
    <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QListWidget</span><span class="p">,</span> <span class="n">QFileDialog</span><span class="p">,</span> <span class="n">QLabel</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="n">PySide6.QtCore</span> <span class="kn">import</span> <span class="n">QModelIndex</span>
<span class="kn">from</span> <span class="n">PySide6.QtWidgets</span> <span class="kn">import</span> <span class="n">QFileSystemModel</span>

<span class="k">class</span> <span class="nc">FileSearchWindow</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">super</span><span class="p">().</span><span class="nf">__init__</span><span class="p">()</span>

        <span class="n">self</span><span class="p">.</span><span class="nf">setWindowTitle</span><span class="p">(</span><span class="sh">"</span><span class="s">QFileSystemModel 직접 검색 예제 (PySide6)</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">resize</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

        <span class="n">self</span><span class="p">.</span><span class="n">model</span> <span class="o">=</span> <span class="nc">QFileSystemModel</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
        <span class="c1"># 읽기 전용으로 둘게 (실제 파일 삭제/이름 변경 같은 거 안 할 거라서)
</span>        <span class="n">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="nf">setReadOnly</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">self</span><span class="p">.</span><span class="n">current_root_path</span> <span class="o">=</span> <span class="sh">""</span>

        <span class="n">main_layout</span> <span class="o">=</span> <span class="nc">QVBoxLayout</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>

        <span class="c1"># 1) 검색 대상 디렉터리 선택 영역
</span>        <span class="n">dir_layout</span> <span class="o">=</span> <span class="nc">QHBoxLayout</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">dir_edit</span> <span class="o">=</span> <span class="nc">QLineEdit</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">dir_edit</span><span class="p">.</span><span class="nf">setPlaceholderText</span><span class="p">(</span><span class="sh">"</span><span class="s">검색할 루트 디렉터리를 선택하세요</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">browse_btn</span> <span class="o">=</span> <span class="nc">QPushButton</span><span class="p">(</span><span class="sh">"</span><span class="s">폴더 선택</span><span class="sh">"</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span>
        <span class="n">browse_btn</span><span class="p">.</span><span class="n">clicked</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">choose_directory</span><span class="p">)</span>

        <span class="n">dir_layout</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span><span class="nc">QLabel</span><span class="p">(</span><span class="sh">"</span><span class="s">루트 폴더:</span><span class="sh">"</span><span class="p">,</span> <span class="n">self</span><span class="p">))</span>
        <span class="n">dir_layout</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">dir_edit</span><span class="p">)</span>
        <span class="n">dir_layout</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span><span class="n">browse_btn</span><span class="p">)</span>

        <span class="c1"># 2) 검색어 입력 영역
</span>        <span class="n">search_layout</span> <span class="o">=</span> <span class="nc">QHBoxLayout</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">keyword_edit</span> <span class="o">=</span> <span class="nc">QLineEdit</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">keyword_edit</span><span class="p">.</span><span class="nf">setPlaceholderText</span><span class="p">(</span><span class="sh">"</span><span class="s">파일명에 포함될 문자열</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">search_btn</span> <span class="o">=</span> <span class="nc">QPushButton</span><span class="p">(</span><span class="sh">"</span><span class="s">검색</span><span class="sh">"</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span>
        <span class="n">search_btn</span><span class="p">.</span><span class="n">clicked</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">search_files</span><span class="p">)</span>

        <span class="n">search_layout</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span><span class="nc">QLabel</span><span class="p">(</span><span class="sh">"</span><span class="s">검색어:</span><span class="sh">"</span><span class="p">,</span> <span class="n">self</span><span class="p">))</span>
        <span class="n">search_layout</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">keyword_edit</span><span class="p">)</span>
        <span class="n">search_layout</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span><span class="n">search_btn</span><span class="p">)</span>

        <span class="c1"># 3) 결과 리스트
</span>        <span class="n">self</span><span class="p">.</span><span class="n">result_list</span> <span class="o">=</span> <span class="nc">QListWidget</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>

        <span class="n">main_layout</span><span class="p">.</span><span class="nf">addLayout</span><span class="p">(</span><span class="n">dir_layout</span><span class="p">)</span>
        <span class="n">main_layout</span><span class="p">.</span><span class="nf">addLayout</span><span class="p">(</span><span class="n">search_layout</span><span class="p">)</span>
        <span class="n">main_layout</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span><span class="nc">QLabel</span><span class="p">(</span><span class="sh">"</span><span class="s">검색 결과:</span><span class="sh">"</span><span class="p">,</span> <span class="n">self</span><span class="p">))</span>
        <span class="n">main_layout</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">result_list</span><span class="p">)</span>

    <span class="c1"># 루트 디렉터리 선택
</span>    <span class="k">def</span> <span class="nf">choose_directory</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="p">.</span><span class="nf">getExistingDirectory</span><span class="p">(</span>
            <span class="n">self</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">검색할 루트 디렉터리 선택</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">""</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">self</span><span class="p">.</span><span class="n">current_root_path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="n">self</span><span class="p">.</span><span class="n">dir_edit</span><span class="p">.</span><span class="nf">setText</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># QFileSystemModel에 루트 설정
</span>        <span class="c1"># setRootPath는 내부적으로 스캔을 시작하고, 해당 경로에 대한 인덱스를 반환한다.
</span>        <span class="n">root_index</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="nf">setRootPath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">root_index</span> <span class="o">=</span> <span class="n">root_index</span>  <span class="c1"># 나중에 검색 시작점으로 사용
</span>
    <span class="c1"># QFileSystemModel을 직접 돌면서 파일 찾기
</span>    <span class="k">def</span> <span class="nf">search_files</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">result_list</span><span class="p">.</span><span class="nf">clear</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">self</span><span class="p">.</span><span class="n">current_root_path</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">result_list</span><span class="p">.</span><span class="nf">addItem</span><span class="p">(</span><span class="sh">"</span><span class="s">먼저 루트 디렉터리를 선택하세요.</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">keyword</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">keyword_edit</span><span class="p">.</span><span class="nf">text</span><span class="p">().</span><span class="nf">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">keyword</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">result_list</span><span class="p">.</span><span class="nf">addItem</span><span class="p">(</span><span class="sh">"</span><span class="s">검색어를 입력하세요.</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">keyword_lower</span> <span class="o">=</span> <span class="n">keyword</span><span class="p">.</span><span class="nf">lower</span><span class="p">()</span>

        <span class="c1"># 재귀적으로 모델을 순회하는 헬퍼 호출
</span>        <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">walk_model</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">root_index</span><span class="p">,</span> <span class="n">keyword_lower</span><span class="p">,</span> <span class="n">matches</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">matches</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">result_list</span><span class="p">.</span><span class="nf">addItem</span><span class="p">(</span><span class="sh">"</span><span class="s">결과 없음.</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
                <span class="n">self</span><span class="p">.</span><span class="n">result_list</span><span class="p">.</span><span class="nf">addItem</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">walk_model</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">parent_index</span><span class="p">:</span> <span class="n">QModelIndex</span><span class="p">,</span> <span class="n">keyword_lower</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">matches</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        QFileSystemModel을 직접 순회하면서
        파일 이름에 keyword가 들어가는 항목을 찾는다.
        </span><span class="sh">"""</span>
        <span class="n">row_count</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="nf">rowCount</span><span class="p">(</span><span class="n">parent_index</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">row_count</span><span class="p">):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="nf">index</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">parent_index</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="p">.</span><span class="nf">isValid</span><span class="p">():</span>
                <span class="k">continue</span>

            <span class="n">file_name</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="nf">fileName</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="nf">filePath</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">keyword_lower</span> <span class="ow">in</span> <span class="n">file_name</span><span class="p">.</span><span class="nf">lower</span><span class="p">():</span>
                <span class="n">matches</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

            <span class="c1"># 디렉터리라면 재귀적으로 들어가기
</span>            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="nf">isDir</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
                <span class="n">self</span><span class="p">.</span><span class="nf">walk_model</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">keyword_lower</span><span class="p">,</span> <span class="n">matches</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="nc">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span>

    <span class="n">w</span> <span class="o">=</span> <span class="nc">FileSearchWindow</span><span class="p">()</span>
    <span class="n">w</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

    <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="nf">exec</span><span class="p">())</span>
</code></pre></div></div>

<hr />

<h2 id="이-코드에서-중요한-포인트만-콕-집어서-설명">이 코드에서 중요한 포인트만 콕 집어서 설명</h2>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileSystemModel</code>은 여전히 “파일 시스템 트리”를 들고 있는 모델일 뿐이고<br />
우리는 <code class="language-plaintext highlighter-rouge">rowCount</code>, <code class="language-plaintext highlighter-rouge">index</code>, <code class="language-plaintext highlighter-rouge">isDir</code>, <code class="language-plaintext highlighter-rouge">fileName</code>, <code class="language-plaintext highlighter-rouge">filePath</code>만 써서 직접 순회하고 있다.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">walk_model</code> 함수가 바로<br />
“QModelIndex들을 쭉 훑는다”를 수동으로 구현한 부분이다.</p>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">rowCount(parent_index)</code>로 자식 개수 얻고</p>
      </li>
      <li>
        <p>각 row에 대해 <code class="language-plaintext highlighter-rouge">index(row, 0, parent_index)</code>로 자식 인덱스 만들고</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">fileName(index)</code> / <code class="language-plaintext highlighter-rouge">isDir(index)</code> 등을 사용</p>
      </li>
      <li>
        <p>디렉터리면 재귀 호출</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QCompleter</code>는 전혀 안 쓰이고,<br />
“검색어에 맞는 파일을 쭉 찾아서 리스트에 뿌리는” 일을 전부 우리가 직접 하고 있다.</p>
  </li>
  <li>
    <p>이 예제는 단순화를 위해 메인 스레드에서 전부 돌리는 구조라<br />
매우 큰 디렉터리를 루트로 잡으면 GUI가 버벅거릴 수 있다.</p>
  </li>
</ol>

<p>실제 앱에서 쓸 땐:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> * 검색을 `QThread`나 `QtConcurrent`로 빼서 백그라운드에서 돌리거나

 * 깊이 제한, 파일 개수 제한 등을 두는 식으로 최적화하는 게 좋다.
</code></pre></div></div>

<p>그래도 이 정도면 “QFileSystemModel만 들고 QModelIndex를 직접 굴려서 파일을 찾는 구조”는 감 잡을 수 있을 거야.<br />
여기서 살짝만 변형하면 확장자 필터, 날짜 필터, 사이즈 필터 같은 것도 전부 커스텀으로 붙일 수 있다.</p>

<p class="chat--user">

GUI 말고 간단히 input으로만 받도록 해줘.

</p>

<p>좋지, 이번엔 진짜 콘솔 앱 스타일로 가보자.<br />
QCompleter, 위젯 다 빼고 <code class="language-plaintext highlighter-rouge">QFileSystemModel</code> + <code class="language-plaintext highlighter-rouge">input()</code>만 사용하는 예제야.</p>

<p>완전 순수 CLI는 아니고, <code class="language-plaintext highlighter-rouge">QFileSystemModel</code>이 Qt 객체라서 최소한 <code class="language-plaintext highlighter-rouge">QCoreApplication</code>은 필요해.<br />
그래도 화면에는 어떤 GUI도 안 뜨고, 터미널에서만 입출력한다.</p>

<p>아래는:</p>

<ul>
  <li>
    <p>루트 디렉터리 입력</p>
  </li>
  <li>
    <p>검색어 입력</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileSystemModel</code>을 재귀적으로 돌면서 파일명에 검색어가 포함된 경로를 전부 출력</p>
  </li>
</ul>

<p>하는 예제다.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="n">PySide6.QtCore</span> <span class="kn">import</span> <span class="n">QCoreApplication</span><span class="p">,</span> <span class="n">QModelIndex</span>
<span class="kn">from</span> <span class="n">PySide6.QtWidgets</span> <span class="kn">import</span> <span class="n">QFileSystemModel</span>

<span class="k">def</span> <span class="nf">walk_model</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">QFileSystemModel</span><span class="p">,</span> <span class="n">parent_index</span><span class="p">:</span> <span class="n">QModelIndex</span><span class="p">,</span>
               <span class="n">keyword_lower</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">matches</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    QFileSystemModel을 직접 순회하면서
    파일 이름에 keyword가 포함된 항목을 찾는다.
    </span><span class="sh">"""</span>
    <span class="n">row_count</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">rowCount</span><span class="p">(</span><span class="n">parent_index</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">row_count</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">index</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">parent_index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="p">.</span><span class="nf">isValid</span><span class="p">():</span>
            <span class="k">continue</span>

        <span class="n">file_name</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">fileName</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">filePath</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">keyword_lower</span> <span class="ow">in</span> <span class="n">file_name</span><span class="p">.</span><span class="nf">lower</span><span class="p">():</span>
            <span class="n">matches</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

        <span class="c1"># 디렉터리라면 재귀적으로 들어가기
</span>        <span class="k">if</span> <span class="n">model</span><span class="p">.</span><span class="nf">isDir</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
            <span class="nf">walk_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">keyword_lower</span><span class="p">,</span> <span class="n">matches</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">app</span> <span class="o">=</span> <span class="nc">QCoreApplication</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span>

    <span class="n">root_path</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">검색할 루트 디렉터리를 입력하세요: </span><span class="sh">"</span><span class="p">).</span><span class="nf">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root_path</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">루트 디렉터리를 입력하지 않았습니다.</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">keyword</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">파일명에 포함될 검색어를 입력하세요: </span><span class="sh">"</span><span class="p">).</span><span class="nf">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">keyword</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">검색어를 입력하지 않았습니다.</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">keyword_lower</span> <span class="o">=</span> <span class="n">keyword</span><span class="p">.</span><span class="nf">lower</span><span class="p">()</span>

    <span class="n">model</span> <span class="o">=</span> <span class="nc">QFileSystemModel</span><span class="p">()</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">setReadOnly</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

    <span class="c1"># setRootPath는 내부적으로 스캔을 시작하고,
</span>    <span class="c1"># 그 경로에 대한 인덱스를 반환한다.
</span>    <span class="n">root_index</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">setRootPath</span><span class="p">(</span><span class="n">root_path</span><span class="p">)</span>

    <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="nf">walk_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">root_index</span><span class="p">,</span> <span class="n">keyword_lower</span><span class="p">,</span> <span class="n">matches</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">matches</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">검색 결과가 없습니다.</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">총 </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span><span class="si">}</span><span class="s">개 발견:</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="c1"># Qt 이벤트 루프 안 돌리고 바로 종료
</span>    <span class="c1"># (여기선 비동기 업데이트를 적극적으로 쓰지 않으니 이 정도로 충분)
</span>    <span class="n">app</span><span class="p">.</span><span class="nf">quit</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</code></pre></div></div>

<p>핵심 포인트만 다시 정리하면:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">QFileSystemModel</code>은 여전히 “파일 시스템 트리 모델”이고<br />
우리는 <code class="language-plaintext highlighter-rouge">rowCount</code>, <code class="language-plaintext highlighter-rouge">index</code>, <code class="language-plaintext highlighter-rouge">fileName</code>, <code class="language-plaintext highlighter-rouge">filePath</code>, <code class="language-plaintext highlighter-rouge">isDir</code>만 써서 수동으로 순회한다.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">walk_model</code>이 바로 “QModelIndex들을 직접 훑는” 부분이다.</p>
  </li>
  <li>
    <p>GUI 위젯은 전혀 안 만들고, <code class="language-plaintext highlighter-rouge">QCoreApplication</code>만 써서 Qt 내부 스레드/이벤트 준비만 해준다.</p>
  </li>
</ul>

<p>여기서 응용해서, 확장자 필터, 크기/날짜 필터, 최대 깊이 제한, 스레드 분리 같은 것들을 추가하면 꽤 그럴듯한 파일 검색 도구로 키울 수 있다.</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#qt" class="page__taxonomy-item p-category" rel="tag">qt</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2025-11-13T12:24:00+09:00">2025-11-13</time></p>

      </footer>

      

      
  <nav class="pagination">
    
      <a href="/python/custom-pyside-filedialog/" class="pagination--pager" title="CFileDialog 구현 방법">Previous</a>
    
    
      <a href="/misc/korean-tool-bug-fix/" class="pagination--pager" title="영문 키보드 한글 변환 버그 수정">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You may also enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025-08-19-python-repr-vs-str/" rel="permalink">
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <!-- hvppyarchive: remove date icon
        <i class="far fa-calendar-alt" aria-hidden="true"></i> 
        -->
        
        <time datetime="2025-11-13T14:00:15+09:00">2025-11-13</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/misc/korean-tool-bug-fix/" rel="permalink">영문 키보드 한글 변환 버그 수정
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <!-- hvppyarchive: remove date icon
        <i class="far fa-calendar-alt" aria-hidden="true"></i> 
        -->
        
        <time datetime="2025-11-13T14:00:09+09:00">2025-11-13</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/python/custom-pyside-filedialog/" rel="permalink">CFileDialog 구현 방법
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <!-- hvppyarchive: remove date icon
        <i class="far fa-calendar-alt" aria-hidden="true"></i> 
        -->
        
        <time datetime="2025-11-12T19:33:35+09:00">2025-11-12</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/misc/web-korean-keyboard/" rel="permalink">웹 한글 키보드 추가
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <!-- hvppyarchive: remove date icon
        <i class="far fa-calendar-alt" aria-hidden="true"></i> 
        -->
        
        <time datetime="2025-11-07T20:48:31+09:00">2025-11-07</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
  </ul>
</div>


<div class="page__footer-copyright">&copy; 2013 - 2025 <a href="https://hvppyarchive.github.io">ARCHIVE</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
